AI STUDIO â€“ ARCHITECTURE & API
==============================

FRONTEND
--------
- Framework: Next.js (App Router) + React + TypeScript
- Styling: TailwindCSS + design system tokens
- State:
  - Zustand (or similar) for global project state
  - React Query for async data (script/audio/image/video generation)
- Icons: lucide-react (or similar)

Suggested folder structure:
- /app
  - /script, /audio, /image, /video, /settings
  - layout.tsx (sidebar + library)
- /components
  - /layout (Sidebar, LibraryPanel, PageHeader)
  - /ui (Button, Input, Textarea, Select, Modal, Card, Tabs, etc.)
  - /script (ScriptForm, SceneList, ScriptDetailModal)
  - /audio (AudioSceneTable, AudioDetailModal)
  - /image (ImageSceneGrid, ImageGenerationModal)
  - /video (VideoOptionsForm, VideoResultCard, VideoDetailModal)
- /store (project, ui)
- /lib (apiClient, prompts, helpers)
- /services (optional thin client wrappers)

BACKEND
-------
- Runtime: Node.js (part of Next.js project or separate service)
- Language: TypeScript
- Database: SQLite or PostgreSQL
- ORM: Prisma
- Validation: Zod

Core responsibilities:
- Persist Projects, Scenes, AudioClips, ImageAssets, VideoClips, Settings
- Call external AI APIs:
  - LLM (for script)
  - TTS (for audio)
  - Image generator
  - Video generator (image-to-video)
- Provide REST or tRPC API consumed by frontend.

EXAMPLE API ENDPOINTS (REST STYLE)
----------------------------------
Script
- POST /api/script/generate
  - body: { prompt, options }
  - returns: { projectId, scenes: Scene[] }
- GET  /api/projects
- GET  /api/projects/:id
- PATCH /api/scenes/:id  (update text)

Audio
- POST /api/audio/generate
  - body: { sceneId, voiceId, speed }
- POST /api/audio/generate-batch
  - body: { projectId, voiceId, speed }
- GET  /api/audio/by-project/:projectId

Image
- POST /api/image/generate
  - body: { sceneId, stylePrompt, modelOptions }
- GET  /api/image/by-project/:projectId

Video
- POST /api/video/generate
  - body: { projectId or imageIds[], options }
- GET  /api/video/:id
- GET  /api/video/by-project/:projectId

Settings
- GET  /api/settings
- PATCH /api/settings

SERVICES LAYER
--------------
Create internal service modules:
- llmService: builds prompts & calls Gemini for script generation.
- ttsService: wraps TTS provider.
- imageService: wraps image generation.
- videoService: wraps video generator.
- settingsService: reads/writes settings and secrets.

ERROR HANDLING
--------------
- Use consistent error shape: { code, message, details? }.
- Handle provider timeouts and retries.
- Record failures on records (AudioClip/ImageAsset/VideoClip.error).

SECURITY
--------
- Secrets (API keys) are stored only server-side.
- Validate all incoming requests.
- Never expose provider API keys to frontend.
