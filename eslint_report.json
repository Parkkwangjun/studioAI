[{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\eslint.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\next.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\parse_eslint.js","messages":[{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":1,"column":12,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":1,"endColumn":25}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"const fs = require('fs');\r\ntry {\r\n    const content = fs.readFileSync('eslint_report.json', 'utf8');\r\n    const results = JSON.parse(content);\r\n\r\n    let output = '';\r\n    let errorCount = 0;\r\n\r\n    results.forEach(result => {\r\n        if (result.errorCount > 0) {\r\n            output += `\\nFile: ${result.filePath}\\n`;\r\n            result.messages.forEach(msg => {\r\n                if (msg.severity === 2) { // 2 is error\r\n                    output += `  ${msg.line}:${msg.column} - ${msg.message} (${msg.ruleId})\\n`;\r\n                    errorCount++;\r\n                }\r\n            });\r\n        }\r\n    });\r\n\r\n    output += `\\nTotal Errors: ${errorCount}\\n`;\r\n    console.log(output);\r\n} catch (e) {\r\n    console.error('Failed to parse report:', e);\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\postcss.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\app\\api\\assets\\save\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\app\\api\\audio\\generate\\route.ts","messages":[{"ruleId":"prefer-const","severity":2,"message":"'audioUrl' is never reassigned. Use 'const' instead.","line":170,"column":13,"nodeType":"Identifier","messageId":"useConst","endLine":170,"endColumn":21,"fix":{"range":[6243,6297],"text":"const audioUrl = `data:audio/mp3;base64,${base64Audio}`;"}}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server';\r\nimport { TextToSpeechClient } from '@google-cloud/text-to-speech';\r\nimport { getVoiceById } from '@/lib/tts-voices';\r\n\r\nlet cachedClient: TextToSpeechClient | null = null;\r\nlet cachedCreds: string | null = null;\r\n\r\n/**\r\n * Create or retrieve a cached TextToSpeech client.\r\n * Recreates the client only if credentials change.\r\n */\r\nfunction getClient(googleCredsJson: string) {\r\n    if (cachedClient && cachedCreds === googleCredsJson) {\r\n        return cachedClient;\r\n    }\r\n\r\n    try {\r\n        const credentials = JSON.parse(googleCredsJson);\r\n        cachedClient = new TextToSpeechClient({ credentials });\r\n        cachedCreds = googleCredsJson;\r\n        return cachedClient;\r\n    } catch (error) {\r\n        console.error('Failed to parse Google credentials:', error);\r\n        throw new Error('Invalid Google credentials format');\r\n    }\r\n}\r\n\r\n/**\r\n * POST /api/audio/generate\r\n * Expects JSON body: { text, voiceId?, speed?, pitch?, googleCredentials }\r\n */\r\nexport async function POST(request: Request) {\r\n    try {\r\n        const { text, voiceId, speed, pitch, googleCredentials } = await request.json();\r\n        const userKieKey = request.headers.get('x-kie-key');\r\n\r\n        // Check voice provider\r\n        const selectedVoice = voiceId ? getVoiceById(voiceId) : null;\r\n        const provider = selectedVoice?.provider || 'google'; // Default to google if not found (fallback)\r\n\r\n        let audioBuffer: Buffer;\r\n\r\n        if (provider === 'elevenlabs') {\r\n            // ----- ElevenLabs Logic via Kie.ai -----\r\n            if (!userKieKey) {\r\n                return NextResponse.json({ error: '설정에서 KIE API 키를 먼저 입력해주세요.' }, { status: 401 });\r\n            }\r\n\r\n            const modelId = selectedVoice?.model || 'eleven_turbo_v2_5';\r\n\r\n            const payload = {\r\n                model: \"elevenlabs/text-to-speech-turbo-2-5\",\r\n                input: {\r\n                    text,\r\n                    voice_id: voiceId,\r\n                    model_id: modelId,\r\n                    voice_settings: {\r\n                        stability: 0.5,\r\n                        similarity_boost: 0.75\r\n                    }\r\n                }\r\n            };\r\n\r\n            const response = await fetch('https://api.kie.ai/api/v1/jobs/createTask', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                    'Authorization': `Bearer ${userKieKey}`\r\n                },\r\n                body: JSON.stringify(payload)\r\n            });\r\n\r\n            if (!response.ok) {\r\n                const errorText = await response.text();\r\n                throw new Error(`Kie.ai API failed: ${errorText}`);\r\n            }\r\n\r\n            const apiResponse = await response.json();\r\n\r\n            if (apiResponse.code !== 200) {\r\n                throw new Error(`Kie.ai error: ${apiResponse.msg}`);\r\n            }\r\n\r\n            // Polling for completion\r\n            const taskId = apiResponse.data.taskId;\r\n            let audioUrl = null;\r\n\r\n            // Simple polling (max 30 seconds)\r\n            // Adaptive polling\r\n            let attempts = 0;\r\n            const maxAttempts = 30; // 30 attempts\r\n\r\n            while (attempts < maxAttempts) {\r\n                attempts++;\r\n\r\n                // Adaptive delay: fast at first, then slower\r\n                const delay = attempts <= 5 ? 1000 : attempts <= 10 ? 2000 : 4000;\r\n                await new Promise(resolve => setTimeout(resolve, delay));\r\n\r\n                const statusRes = await fetch(`https://api.kie.ai/api/v1/jobs/getTask?taskId=${taskId}`, {\r\n                    headers: { 'Authorization': `Bearer ${userKieKey}` }\r\n                });\r\n\r\n                if (!statusRes.ok) continue;\r\n\r\n                const statusData = await statusRes.json();\r\n\r\n                if (statusData.data?.status === 'SUCCESS') {\r\n                    audioUrl = statusData.data.result.audio_url || statusData.data.result.url;\r\n                    break;\r\n                } else if (statusData.data?.status === 'FAILED') {\r\n                    throw new Error(`Task failed: ${statusData.data.failMsg || 'Unknown error'}`);\r\n                }\r\n            }\r\n\r\n            if (!audioUrl) throw new Error('Timeout waiting for audio generation');\r\n\r\n            // Fetch the audio content from the URL\r\n            const audioRes = await fetch(audioUrl);\r\n            const arrayBuffer = await audioRes.arrayBuffer();\r\n            audioBuffer = Buffer.from(arrayBuffer);\r\n\r\n        } else {\r\n            // ----- Google Cloud TTS Logic -----\r\n\r\n            // Validate credentials\r\n            let googleCredsJson: string | null = null;\r\n            if (googleCredentials) {\r\n                googleCredsJson = googleCredentials;\r\n            }\r\n\r\n            if (!googleCredsJson) {\r\n                return NextResponse.json({ error: '설정에서 Google Cloud 인증 정보를 먼저 입력해주세요.' }, { status: 401 });\r\n            }\r\n\r\n            try {\r\n                JSON.parse(googleCredsJson);\r\n            } catch (jsonError) {\r\n                console.error('Invalid JSON structure in credentials:', jsonError);\r\n                return NextResponse.json({\r\n                    error: 'Google Credentials 형식이 올바르지 않습니다. 파일 경로가 아닌 JSON 내용 전체를 입력했는지 확인해주세요.'\r\n                }, { status: 400 });\r\n            }\r\n\r\n            const client = getClient(googleCredsJson);\r\n\r\n            const [response] = await client.synthesizeSpeech({\r\n                input: { text },\r\n                voice: {\r\n                    languageCode: 'ko-KR',\r\n                    name: voiceId || 'ko-KR-Neural2-A',\r\n                },\r\n                audioConfig: {\r\n                    audioEncoding: 'MP3',\r\n                    speakingRate: speed || 1.0,\r\n                    pitch: pitch || 0,\r\n                },\r\n            });\r\n\r\n            const audioContent = response.audioContent;\r\n            if (!audioContent) {\r\n                throw new Error('No audio content returned');\r\n            }\r\n\r\n            audioBuffer = Buffer.from(audioContent as Uint8Array);\r\n        }\r\n\r\n        // ----- Convert to base64 data URL -----\r\n        const base64Audio = audioBuffer.toString('base64');\r\n        let audioUrl = `data:audio/mp3;base64,${base64Audio}`;\r\n\r\n        // ----- Return Base64 immediately for fast playback -----\r\n        // The client will handle saving to Supabase in the background via /api/assets/save\r\n\r\n\r\n        return NextResponse.json({\r\n            audioUrl,\r\n            message: 'Audio generated successfully',\r\n        });\r\n\r\n    } catch (error) {\r\n        console.error('Audio generation error:', error);\r\n        return NextResponse.json(\r\n            {\r\n                error: 'Failed to generate audio',\r\n                details: error instanceof Error ? error.message : 'Unknown error',\r\n            },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\app\\api\\audio\\merge\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'projectTitle' is assigned a value but never used.","line":10,"column":28,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":40}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server';\r\n\r\n/**\r\n * POST /api/audio/merge\r\n * 여러 오디오 파일을 하나로 병합\r\n * Expects JSON body: { audioUrls: string[], projectTitle: string }\r\n */\r\nexport async function POST(request: Request) {\r\n    try {\r\n        const { audioUrls, projectTitle } = await request.json();\r\n\r\n        if (!audioUrls || !Array.isArray(audioUrls) || audioUrls.length === 0) {\r\n            return NextResponse.json({ error: '병합할 오디오 URL이 필요합니다.' }, { status: 400 });\r\n        }\r\n\r\n        // 모든 오디오 파일 다운로드\r\n        const audioBuffers: Buffer[] = [];\r\n\r\n        for (const url of audioUrls) {\r\n            try {\r\n                // data URL인 경우 직접 디코딩\r\n                if (url.startsWith('data:audio')) {\r\n                    const base64Data = url.split(',')[1];\r\n                    const buffer = Buffer.from(base64Data, 'base64');\r\n                    audioBuffers.push(buffer);\r\n                } else {\r\n                    // 외부 URL인 경우 fetch\r\n                    const response = await fetch(url);\r\n                    if (!response.ok) {\r\n                        throw new Error(`Failed to fetch audio from ${url}`);\r\n                    }\r\n                    const arrayBuffer = await response.arrayBuffer();\r\n                    audioBuffers.push(Buffer.from(arrayBuffer));\r\n                }\r\n            } catch (error) {\r\n                console.error('Error fetching audio:', error);\r\n                throw new Error('오디오 파일을 가져오는데 실패했습니다.');\r\n            }\r\n        }\r\n\r\n        // 오디오 파일들을 순차적으로 연결 (간단한 병합)\r\n        // 실제 프로덕션에서는 ffmpeg 같은 도구를 사용해야 합니다\r\n        const mergedBuffer = Buffer.concat(audioBuffers);\r\n\r\n        // Supabase Storage에 업로드\r\n        try {\r\n            const { createClient } = await import('@/lib/supabase/server');\r\n            const { cookies } = await import('next/headers');\r\n            const { v4: uuidv4 } = await import('uuid');\r\n\r\n            const cookieStore = await cookies();\r\n            const supabase = createClient(cookieStore);\r\n            const { data: { user } } = await supabase.auth.getUser();\r\n\r\n            if (!user) {\r\n                // 사용자가 로그인하지 않은 경우 base64로 반환\r\n                const base64Audio = mergedBuffer.toString('base64');\r\n                return NextResponse.json({\r\n                    audioUrl: `data:audio/mp3;base64,${base64Audio}`,\r\n                    message: '오디오가 병합되었습니다 (임시 저장)'\r\n                });\r\n            }\r\n\r\n            // Supabase Storage에 업로드\r\n            const filename = `${uuidv4()}.mp3`;\r\n            const path = `${user.id}/merged-audio/${filename}`;\r\n\r\n            const { error: uploadError } = await supabase.storage\r\n                .from('assets')\r\n                .upload(path, mergedBuffer, {\r\n                    contentType: 'audio/mpeg',\r\n                    upsert: false,\r\n                });\r\n\r\n            if (uploadError) {\r\n                throw uploadError;\r\n            }\r\n\r\n            const { data: { publicUrl } } = supabase.storage\r\n                .from('assets')\r\n                .getPublicUrl(path);\r\n\r\n            return NextResponse.json({\r\n                audioUrl: publicUrl,\r\n                message: '오디오가 병합되어 저장되었습니다.'\r\n            });\r\n\r\n        } catch (uploadError) {\r\n            console.error('Storage upload failed:', uploadError);\r\n            // 업로드 실패 시 base64로 폴백\r\n            const base64Audio = mergedBuffer.toString('base64');\r\n            return NextResponse.json({\r\n                audioUrl: `data:audio/mp3;base64,${base64Audio}`,\r\n                message: '오디오가 병합되었습니다 (임시 저장)'\r\n            });\r\n        }\r\n\r\n    } catch (error) {\r\n        console.error('Audio merge error:', error);\r\n        return NextResponse.json(\r\n            {\r\n                error: '오디오 병합 실패',\r\n                details: error instanceof Error ? error.message : '알 수 없는 오류',\r\n            },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\app\\api\\bgm-generation\\[taskId]\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\app\\api\\bgm-generation\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\app\\api\\image-generation\\[taskId]\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'API_KEY' is assigned a value but never used.","line":3,"column":7,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":14}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server';\r\n\r\nconst API_KEY = process.env.NANOBANANA_API_KEY;\r\nconst API_BASE_URL = 'https://api.kie.ai/api/v1/jobs/recordInfo';\r\n\r\nexport async function GET(request: Request, { params }: { params: Promise<{ taskId: string }> }) {\r\n    const apiKey = request.headers.get('x-kie-key');\r\n    // Allow fallback to env var if header is missing, or enforce header? \r\n    // Given BYOK, we should prefer header.\r\n    const finalKey = apiKey || process.env.NANOBANANA_API_KEY;\r\n\r\n    if (!finalKey) {\r\n        return NextResponse.json({ error: 'API Key not configured' }, { status: 401 });\r\n    }\r\n\r\n    try {\r\n        const { taskId } = await params;\r\n        if (!taskId) {\r\n            return NextResponse.json({ error: 'Task ID is required' }, { status: 400 });\r\n        }\r\n\r\n        const response = await fetch(`${API_BASE_URL}?taskId=${taskId}`, {\r\n            method: 'GET',\r\n            headers: {\r\n                'Authorization': `Bearer ${finalKey}`\r\n            }\r\n        });\r\n\r\n        const data = await response.json();\r\n\r\n        if (!response.ok) {\r\n            return NextResponse.json({ error: data.msg || 'Failed to fetch task status' }, { status: response.status });\r\n        }\r\n\r\n        return NextResponse.json(data);\r\n\r\n    } catch (error) {\r\n        console.error('Error fetching task status:', error);\r\n        return NextResponse.json({ error: 'Internal Server Error' }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\app\\api\\image-generation\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\app\\api\\image\\generate\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'update' is defined but never used.","line":155,"column":33,"nodeType":null,"messageId":"unusedVar","endLine":155,"endColumn":39}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server';\r\nimport * as fal from '@fal-ai/serverless-client';\r\nimport OpenAI from 'openai';\r\nimport { uploadAssetFromUrl } from '@/lib/supabase/storage';\r\n\r\nasync function optimizePromptForFlux(koreanPrompt: string, openaiKey: string): Promise<string> {\r\n    const openai = new OpenAI({ apiKey: openaiKey });\r\n\r\n    try {\r\n\r\n\r\n\r\n        const systemPrompt = `You are an expert AI image generation prompt engineer using JSON Style Guides for FLUX models.\r\n\r\nYour task: Transform Korean prompts into structured JSON format, then convert to optimized English prompts.\r\n\r\nCRITICAL: JSON STYLE GUIDE STRUCTURE (15 Parameters)\r\n1. **scene**: Overall setting/environment\r\n2. **subjects**: Array of key subjects with detailed attributes\r\n3. **style**: Artistic rendering\r\n4. **color_palette**: Array of dominant colors\r\n5. **lighting**: Light source and quality\r\n6. **mood**: Emotional atmosphere\r\n7. **background**: Scenery/backdrop details\r\n8. **composition**: Layout rules\r\n9. **camera**: Virtual photography settings\r\n10. **medium**: Simulated format\r\n11. **textures**: Surface qualities\r\n12. **resolution**: Output quality\r\n13. **details**: Fine-tuned attributes\r\n14. **effects**: Visual treatments\r\n15. **inspirations**: Style references\r\n\r\nVISUAL-ONLY RULES:\r\n❌ NO text overlays, captions, typography, written words, logos, watermarks\r\n✅ ONLY visual elements, composition, aesthetics\r\n\r\nCONVERSION PROCESS:\r\n1. Analyze Korean prompt\r\n2. Structure into JSON format with relevant parameters\r\n3. Convert JSON to natural English prompt\r\n4. Enhance with technical photography/art terms\r\n\r\nOUTPUT FORMAT:\r\nReturn ONLY the optimized English prompt as a single flowing paragraph. Do NOT output JSON. Do NOT add explanations.`;\r\n\r\n        const completion = await openai.chat.completions.create({\r\n            model: \"gpt-4o-mini\",\r\n            messages: [\r\n                { role: \"system\", content: systemPrompt },\r\n                { role: \"user\", content: koreanPrompt }\r\n            ],\r\n            temperature: 0.7,\r\n        });\r\n\r\n        const optimizedPrompt = completion.choices[0].message.content?.trim() || koreanPrompt;\r\n\r\n        return optimizedPrompt;\r\n    } catch (error) {\r\n        console.error('❌ Prompt optimization failed:', error);\r\n        return koreanPrompt;\r\n    }\r\n}\r\n\r\nexport async function POST(request: Request) {\r\n    try {\r\n        const { prompt, imageSize, guidanceScale, model } = await request.json();\r\n\r\n        // Get API keys from headers (BYOK)\r\n        const userFalKey = request.headers.get('x-fal-key');\r\n        const userOpenAiKey = request.headers.get('x-openai-key');\r\n        const userKieKey = request.headers.get('x-kie-key');\r\n\r\n        if (!userFalKey) {\r\n            return NextResponse.json({ error: '설정에서 FAL API 키를 먼저 입력해주세요.' }, { status: 401 });\r\n        }\r\n\r\n        if (!userOpenAiKey) {\r\n            return NextResponse.json({ error: '설정에서 OpenAI API 키를 먼저 입력해주세요.' }, { status: 401 });\r\n        }\r\n\r\n        // Configure Fal.ai client with user's key\r\n        fal.config({ credentials: userFalKey });\r\n\r\n        if (!prompt || prompt.trim() === '') {\r\n            return NextResponse.json({ error: 'Prompt is required' }, { status: 400 });\r\n        }\r\n\r\n        // Optimize using JSON Style Guide methodology\r\n        const optimizedEnglishPrompt = await optimizePromptForFlux(prompt.trim(), userOpenAiKey);\r\n\r\n        let imageUrl = null;\r\n        let seed = null;\r\n        let generationTime = null;\r\n        let requestId = null;\r\n        let modelId = model;\r\n\r\n        if (model === 'nanobanana') {\r\n            if (!userKieKey) {\r\n                return NextResponse.json({ error: '설정에서 KIE API 키를 먼저 입력해주세요.' }, { status: 401 });\r\n            }\r\n\r\n            const payload = {\r\n                model: \"nano-banana-pro\",\r\n                input: {\r\n                    prompt: optimizedEnglishPrompt,\r\n                    width: imageSize === \"square_hd\" ? 1024 : (imageSize === \"portrait_16_9\" ? 576 : 1024),\r\n                    height: imageSize === \"square_hd\" ? 1024 : (imageSize === \"portrait_16_9\" ? 1024 : 576),\r\n                    num_inference_steps: 30\r\n                }\r\n            };\r\n\r\n            const response = await fetch('https://api.kie.ai/api/v1/jobs/createTask', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                    'Authorization': `Bearer ${userKieKey}`\r\n                },\r\n                body: JSON.stringify(payload)\r\n            });\r\n\r\n            if (!response.ok) throw new Error('Kie.ai API failed');\r\n            const apiResponse = await response.json();\r\n            if (apiResponse.code !== 200) throw new Error(apiResponse.msg);\r\n\r\n            const taskId = apiResponse.data.taskId;\r\n\r\n            // Return taskId immediately for client-side polling\r\n            return NextResponse.json({\r\n                status: 'pending',\r\n                taskId,\r\n                originalPrompt: prompt,\r\n                optimizedPrompt: optimizedEnglishPrompt,\r\n                model: modelId\r\n            });\r\n\r\n        } else {\r\n            // FAL.ai Logic\r\n            modelId = model === 'schnell' ? 'fal-ai/flux/schnell' : 'fal-ai/flux/dev';\r\n            const numInferenceSteps = model === 'schnell' ? 4 : 28;\r\n\r\n            const falInput = {\r\n                prompt: optimizedEnglishPrompt,\r\n                image_size: imageSize || \"landscape_16_9\",\r\n                guidance_scale: guidanceScale || 3.5,\r\n                num_inference_steps: numInferenceSteps,\r\n                enable_safety_checker: true\r\n            };\r\n\r\n            const startTime = Date.now();\r\n\r\n            const result = await fal.subscribe(modelId, {\r\n                input: falInput,\r\n                logs: true,\r\n                onQueueUpdate: (update) => {\r\n                    // Logs removed\r\n                },\r\n            });\r\n\r\n            generationTime = ((Date.now() - startTime) / 1000).toFixed(2);\r\n\r\n            interface FalResult {\r\n                images: Array<{ url: string }>;\r\n                seed: number;\r\n                requestId: string;\r\n            }\r\n            const data = result as unknown as FalResult;\r\n\r\n            if (!data.images || data.images.length === 0) {\r\n                throw new Error('No images generated');\r\n            }\r\n\r\n            imageUrl = data.images[0].url;\r\n            seed = data.seed;\r\n            requestId = data.requestId;\r\n        }\r\n\r\n        // Upload to Supabase Storage for permanence\r\n        try {\r\n            if (imageUrl) {\r\n                const permanentUrl = await uploadAssetFromUrl(imageUrl, 'images');\r\n                imageUrl = permanentUrl;\r\n            }\r\n        } catch (uploadError) {\r\n            console.error('⚠️ Storage upload failed, using temporary URL:', uploadError);\r\n        }\r\n\r\n        return NextResponse.json({\r\n            imageUrl,\r\n            originalPrompt: prompt,\r\n            optimizedPrompt: optimizedEnglishPrompt,\r\n            seed,\r\n            generationTime,\r\n            requestId,\r\n            model: modelId\r\n        });\r\n\r\n    } catch (error) {\r\n        console.error('❌ IMAGE GENERATION ERROR:', error);\r\n        return NextResponse.json({\r\n            error: 'Failed to generate image',\r\n            details: error instanceof Error ? error.message : 'Unknown error'\r\n        }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\app\\api\\magic-prompt\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\app\\api\\script\\generate\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\app\\api\\sfx-generation\\[taskId]\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'API_KEY' is assigned a value but never used.","line":3,"column":7,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":14}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server';\r\n\r\nconst API_KEY = process.env.ELEVENLABS_API_KEY;\r\nconst API_BASE_URL = 'https://api.kie.ai/api/v1/jobs/recordInfo';\r\n\r\nexport async function GET(request: Request, { params }: { params: Promise<{ taskId: string }> }) {\r\n    const apiKey = request.headers.get('x-kie-key');\r\n    if (!apiKey) {\r\n        return NextResponse.json({ error: 'API Key not configured' }, { status: 401 });\r\n    }\r\n\r\n    try {\r\n        const { taskId } = await params;\r\n        if (!taskId) {\r\n            return NextResponse.json({ error: 'Task ID is required' }, { status: 400 });\r\n        }\r\n\r\n        const response = await fetch(`${API_BASE_URL}?taskId=${taskId}`, {\r\n            method: 'GET',\r\n            headers: {\r\n                'Authorization': `Bearer ${apiKey}`\r\n            }\r\n        });\r\n\r\n        const data = await response.json();\r\n\r\n        if (!response.ok) {\r\n            return NextResponse.json({ error: data.msg || 'Failed to fetch task status' }, { status: response.status });\r\n        }\r\n\r\n        return NextResponse.json(data);\r\n\r\n    } catch (error) {\r\n        console.error('Error fetching task status:', error);\r\n        return NextResponse.json({ error: 'Internal Server Error' }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\app\\api\\sfx-generation\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'promptInfluence' is assigned a value but never used.","line":14,"column":33,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":48}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server';\r\n\r\nconst API_URL = 'https://api.kie.ai/api/v1/jobs/createTask';\r\n\r\nexport async function POST(request: Request) {\r\n    const apiKey = request.headers.get('x-kie-key');\r\n\r\n    if (!apiKey) {\r\n        return NextResponse.json({ error: '설정에서 KIE API 키를 먼저 입력해주세요.' }, { status: 401 });\r\n    }\r\n\r\n    try {\r\n        const body = await request.json();\r\n        const { text, duration, promptInfluence } = body;\r\n\r\n        const payload = {\r\n            model: \"elevenlabs/sound-effect-v2\",\r\n            input: {\r\n                text,\r\n                duration_seconds: duration ? parseFloat(duration) : undefined,\r\n                prompt_influence: 0.3 // Default value\r\n            }\r\n        };\r\n\r\n        const response = await fetch(API_URL, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n                'Authorization': `Bearer ${apiKey}`\r\n            },\r\n            body: JSON.stringify(payload)\r\n        });\r\n\r\n        const data = await response.json();\r\n\r\n        if (!response.ok) {\r\n            return NextResponse.json({ error: data.message || 'Failed to create task' }, { status: response.status });\r\n        }\r\n\r\n        return NextResponse.json(data);\r\n\r\n    } catch (error) {\r\n        console.error('Error creating SFX generation task:', error);\r\n        return NextResponse.json({ error: 'Internal Server Error' }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\app\\api\\video\\generate\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":71,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":71,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2960,2963],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2960,2963],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server';\r\nimport OpenAI from 'openai';\r\n\r\nasync function optimizeVideoPrompt(koreanPrompt: string, openaiKey: string): Promise<string> {\r\n    const openai = new OpenAI({ apiKey: openaiKey });\r\n\r\n    try {\r\n        const systemPrompt = `You are an expert AI video generation prompt engineer.\r\nYour task: Transform Korean prompts into structured JSON format, then convert to optimized English prompts.\r\n\r\nCRITICAL: JSON STYLE GUIDE STRUCTURE (14 Parameters)\r\n1. **scene**: Overall setting/environment\r\n2. **subjects**: Array of key subjects with detailed attributes\r\n3. **style**: Artistic rendering (cinematic, documentary, etc.)\r\n4. **color_palette**: Array of dominant colors\r\n5. **lighting**: Light source and quality\r\n6. **mood**: Emotional atmosphere\r\n7. **background**: Scenery/backdrop details\r\n8. **composition**: Layout rules (rule of thirds, etc.)\r\n9. **camera_movement**: Specific camera moves (pan, tilt, zoom, push-in)\r\n10. **motion_quality**: Smoothness and realism\r\n11. **environmental_motion**: Wind, water, background movement\r\n12. **temporal_progression**: Changes over time\r\n13. **effects**: Visual treatments (bokeh, motion blur)\r\n14. **technical_specs**: Video quality (4K, 24fps)\r\n\r\nVISUAL-ONLY RULES:\r\n❌ NO text overlays, captions, typography, subtitles, logos\r\n✅ ONLY visual motion, cinematography, animation\r\n\r\nOUTPUT FORMAT:\r\nReturn ONLY the optimized English prompt as a single flowing paragraph. Do NOT output JSON.`;\r\n\r\n        const completion = await openai.chat.completions.create({\r\n            model: \"gpt-4o-mini\",\r\n            messages: [\r\n                { role: \"system\", content: systemPrompt },\r\n                { role: \"user\", content: koreanPrompt }\r\n            ],\r\n            temperature: 0.7,\r\n        });\r\n\r\n        return completion.choices[0].message.content?.trim() || koreanPrompt;\r\n    } catch (error) {\r\n        console.error('❌ Video prompt optimization failed:', error);\r\n        return koreanPrompt;\r\n    }\r\n}\r\n\r\nexport async function POST(request: Request) {\r\n    try {\r\n        const { imageUrl, prompt, model, mode, duration, resolution } = await request.json();\r\n\r\n        const userKieKey = request.headers.get('x-kie-key');\r\n        const userOpenAiKey = request.headers.get('x-openai-key');\r\n\r\n        if (!userKieKey) {\r\n            return NextResponse.json({ error: '설정에서 KIE API 키를 먼저 입력해주세요.' }, { status: 401 });\r\n        }\r\n\r\n        if (!userOpenAiKey) {\r\n            return NextResponse.json({ error: '설정에서 OpenAI API 키를 먼저 입력해주세요.' }, { status: 401 });\r\n        }\r\n\r\n        const optimizedPrompt = prompt\r\n            ? await optimizeVideoPrompt(prompt, userOpenAiKey)\r\n            : \"Animate this image with smooth, cinematic motion, natural movement, professional cinematography, 4K quality, no text or captions\";\r\n\r\n        if (model === 'veo' || model === 'veo3' || model === 'veo3_fast') {\r\n            // Veo 3.1 Logic\r\n            const payload: any = {\r\n                model: model === 'veo' ? 'veo3_fast' : model, // Default to fast if generic 'veo'\r\n                prompt: optimizedPrompt,\r\n                aspectRatio: \"16:9\", // Default\r\n                enableTranslation: true\r\n            };\r\n\r\n            if (imageUrl) {\r\n                payload.imageUrls = [imageUrl];\r\n                payload.generationType = \"FIRST_AND_LAST_FRAMES_2_VIDEO\";\r\n            } else {\r\n                payload.generationType = \"TEXT_2_VIDEO\";\r\n            }\r\n\r\n            const veoResponse = await fetch('https://api.kie.ai/api/v1/veo/generate', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                    'Authorization': `Bearer ${userKieKey}`\r\n                },\r\n                body: JSON.stringify(payload)\r\n            });\r\n\r\n            if (!veoResponse.ok) {\r\n                const errorText = await veoResponse.text();\r\n                throw new Error(`Veo API Error: ${veoResponse.status} - ${errorText}`);\r\n            }\r\n\r\n            const veoData = await veoResponse.json();\r\n            if (veoData.code !== 200) {\r\n                throw new Error(`Veo API error: ${veoData.msg}`);\r\n            }\r\n\r\n            return NextResponse.json({\r\n                taskId: veoData.data.taskId,\r\n                status: 'pending',\r\n                originalPrompt: prompt,\r\n                optimizedPrompt: optimizedPrompt,\r\n                model: model\r\n            });\r\n\r\n        } else {\r\n            // Other Models (Bytedance, Grok)\r\n            let requestBody;\r\n            if (model === 'bytedance') {\r\n                requestBody = {\r\n                    model: \"bytedance/v1-pro-fast-image-to-video\",\r\n                    input: {\r\n                        image_url: imageUrl,\r\n                        prompt: optimizedPrompt,\r\n                        resolution: resolution || \"720p\",\r\n                        duration: duration || \"5\"\r\n                    }\r\n                };\r\n            } else {\r\n                // Grok\r\n                requestBody = {\r\n                    model: \"grok-imagine/image-to-video\",\r\n                    input: {\r\n                        image_urls: [imageUrl],\r\n                        prompt: optimizedPrompt,\r\n                        mode: mode || \"normal\"\r\n                    }\r\n                };\r\n            }\r\n\r\n            const createTaskResponse = await fetch('https://api.kie.ai/api/v1/jobs/createTask', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                    'Authorization': `Bearer ${userKieKey}`\r\n                },\r\n                body: JSON.stringify(requestBody)\r\n            });\r\n\r\n            if (!createTaskResponse.ok) {\r\n                const errorText = await createTaskResponse.text();\r\n                throw new Error(`KIE API Error: ${createTaskResponse.status} - ${errorText}`);\r\n            }\r\n\r\n            const apiResponse = await createTaskResponse.json();\r\n            if (apiResponse.code !== 200) {\r\n                throw new Error(`KIE API error: ${apiResponse.msg}`);\r\n            }\r\n\r\n            return NextResponse.json({\r\n                taskId: apiResponse.data?.taskId,\r\n                status: 'pending',\r\n                originalPrompt: prompt,\r\n                optimizedPrompt: optimizedPrompt,\r\n                model: model\r\n            });\r\n        }\r\n\r\n    } catch (error) {\r\n        console.error('❌ VIDEO GENERATION ERROR:', error);\r\n        return NextResponse.json({\r\n            error: 'Failed to start video generation',\r\n            details: error instanceof Error ? error.message : 'Unknown error'\r\n        }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\app\\api\\video\\status\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\app\\audio\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setProject' is assigned a value but never used.","line":14,"column":29,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":39},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\user\\Desktop\\studioAI\\src\\app\\audio\\page.tsx:18:13\n  16 |     useEffect(() => {\n  17 |         if (currentProject && currentProject.scenes.length > 0) {\n> 18 |             setViewMode('generation');\n     |             ^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  19 |         }\n  20 |     }, [currentProject]);\n  21 |","line":18,"column":13,"nodeType":null,"endLine":18,"endColumn":24},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":91,"column":36,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[4211,4320],"text":"\r\n                                3. &apos;분석 및 분리 시작' 버튼을 눌러 AI가 장면을 자동으로 나누도록 하세요.\r\n                            "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[4211,4320],"text":"\r\n                                3. &lsquo;분석 및 분리 시작' 버튼을 눌러 AI가 장면을 자동으로 나누도록 하세요.\r\n                            "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[4211,4320],"text":"\r\n                                3. &#39;분석 및 분리 시작' 버튼을 눌러 AI가 장면을 자동으로 나누도록 하세요.\r\n                            "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[4211,4320],"text":"\r\n                                3. &rsquo;분석 및 분리 시작' 버튼을 눌러 AI가 장면을 자동으로 나누도록 하세요.\r\n                            "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":91,"column":47,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[4211,4320],"text":"\r\n                                3. '분석 및 분리 시작&apos; 버튼을 눌러 AI가 장면을 자동으로 나누도록 하세요.\r\n                            "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[4211,4320],"text":"\r\n                                3. '분석 및 분리 시작&lsquo; 버튼을 눌러 AI가 장면을 자동으로 나누도록 하세요.\r\n                            "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[4211,4320],"text":"\r\n                                3. '분석 및 분리 시작&#39; 버튼을 눌러 AI가 장면을 자동으로 나누도록 하세요.\r\n                            "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[4211,4320],"text":"\r\n                                3. '분석 및 분리 시작&rsquo; 버튼을 눌러 AI가 장면을 자동으로 나누도록 하세요.\r\n                            "},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { Volume2, FileText, Split } from 'lucide-react';\r\nimport { useState, useEffect } from 'react';\r\nimport { AudioSplitModal } from '@/components/audio/AudioSplitModal';\r\nimport { AudioGenerationView } from '@/components/audio/AudioGenerationView';\r\nimport { useProjectStore } from '@/store/useProjectStore';\r\n\r\nexport default function AudioPage() {\r\n    const [scriptText, setScriptText] = useState('');\r\n    const [isSplitModalOpen, setIsSplitModalOpen] = useState(false);\r\n    const [viewMode, setViewMode] = useState<'input' | 'generation'>('input');\r\n\r\n    const { currentProject, setProject, updateScenes, createProject } = useProjectStore();\r\n\r\n    useEffect(() => {\r\n        if (currentProject && currentProject.scenes.length > 0) {\r\n            setViewMode('generation');\r\n        }\r\n    }, [currentProject]);\r\n\r\n    const handleAnalyze = () => {\r\n        if (!scriptText.trim()) return;\r\n        setIsSplitModalOpen(true);\r\n    };\r\n\r\n    const handleConfirmSplit = async () => {\r\n        const newScenes = scriptText.split('\\n\\n').filter(Boolean).map((text, i) => ({\r\n            id: i + 1,\r\n            text: text.trim()\r\n        }));\r\n\r\n        if (currentProject) {\r\n            updateScenes(newScenes);\r\n        } else {\r\n            await createProject({\r\n                title: 'Audio Project',\r\n                description: scriptText.substring(0, 50) + '...',\r\n                type: 'audio',\r\n            });\r\n            updateScenes(newScenes);\r\n        }\r\n\r\n        setIsSplitModalOpen(false);\r\n        setViewMode('generation');\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex-1 p-[30px_40px] flex flex-col gap-5 overflow-y-auto custom-scrollbar h-full\">\r\n            <header className=\"flex items-center gap-2.5 mb-2.5 shrink-0\">\r\n                <Volume2 className=\"w-5 h-5 text-white\" />\r\n                <h2 className=\"text-[1.2rem] font-semibold\">오디오</h2>\r\n            </header>\r\n\r\n            {viewMode === 'input' ? (\r\n                <div className=\"grid grid-cols-3 gap-5 h-full\">\r\n                    {/* Left Column: Script Input */}\r\n                    <section className=\"col-span-2 bg-(--bg-card) rounded-xl p-5 border border-(--border-color) flex flex-col\">\r\n                        <div className=\"flex justify-between items-center mb-[15px]\">\r\n                            <h3 className=\"text-[0.9rem] font-semibold flex items-center gap-2\">\r\n                                <FileText className=\"w-4 h-4 text-(--primary-color)\" />\r\n                                스크립트 입력\r\n                            </h3>\r\n                            <button\r\n                                onClick={handleAnalyze}\r\n                                className=\"flex items-center gap-2 px-4 py-2 rounded-lg bg-(--primary-color) text-white text-sm font-medium hover:bg-[#4a4ddb] transition-colors\"\r\n                            >\r\n                                <Split className=\"w-4 h-4\" />\r\n                                분석 및 분리 시작\r\n                            </button>\r\n                        </div>\r\n                        <textarea\r\n                            className=\"flex-1 bg-[#16161d] border border-(--border-color) rounded-lg p-4 text-white placeholder-gray-500 outline-none focus:border-(--primary-color) resize-none transition-colors leading-relaxed\"\r\n                            placeholder=\"스크립트를 입력하세요. (엔터 두 번으로 장면을 구분합니다)\"\r\n                            value={scriptText}\r\n                            onChange={(e) => setScriptText(e.target.value)}\r\n                        />\r\n                    </section>\r\n\r\n                    {/* Right Column: Guide */}\r\n                    <section className=\"col-span-1 bg-(--bg-card) rounded-xl p-5 border border-(--border-color)\">\r\n                        <h3 className=\"text-[0.9rem] font-semibold mb-4\">가이드</h3>\r\n                        <div className=\"text-sm text-(--text-gray) space-y-4\">\r\n                            <p>\r\n                                1. 스크립트를 입력하거나 붙여넣으세요.\r\n                            </p>\r\n                            <p>\r\n                                2. 각 장면은 <strong>빈 줄(엔터 두 번)</strong>로 구분됩니다.\r\n                            </p>\r\n                            <p>\r\n                                3. '분석 및 분리 시작' 버튼을 눌러 AI가 장면을 자동으로 나누도록 하세요.\r\n                            </p>\r\n                            <div className=\"bg-[#16161d] p-3 rounded-lg border border-(--border-color) mt-4\">\r\n                                <p className=\"text-xs text-gray-400 mb-2\">예시:</p>\r\n                                <p className=\"text-xs text-gray-300\">\r\n                                    안녕하세요, 반갑습니다.<br />\r\n                                    오늘의 뉴스를 전해드립니다.<br />\r\n                                    <br />\r\n                                    첫 번째 소식입니다.<br />\r\n                                    날씨가 매우 맑습니다.\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    </section>\r\n                </div>\r\n            ) : (\r\n                <AudioGenerationView scenes={currentProject?.scenes || []} />\r\n            )}\r\n\r\n            <AudioSplitModal\r\n                isOpen={isSplitModalOpen}\r\n                onClose={() => setIsSplitModalOpen(false)}\r\n                onConfirm={handleConfirmSplit}\r\n                scriptText={scriptText}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\app\\auth\\callback\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\app\\bgm-generation\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Download' is defined but never used.","line":7,"column":30,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":38},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":262,"column":49,"nodeType":"JSXOpeningElement","endLine":262,"endColumn":130}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\n\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport { Button } from \"@/components/ui/Button\"\r\nimport { Input, Textarea } from \"@/components/ui/Input\"\r\nimport { Radio, Play, Pause, Download, Loader2, Music, Mic, Disc } from \"lucide-react\"\r\nimport { useSettingsStore } from \"@/store/useSettingsStore\"\r\nimport { useProjectStore } from \"@/store/useProjectStore\"\r\nimport { MagicPromptButton } from \"@/components/common/MagicPromptButton\"\r\n\r\ninterface GeneratedBgm {\r\n    id: string;\r\n    url: string;\r\n    title: string;\r\n    prompt: string;\r\n    duration: number;\r\n    createdAt: number;\r\n    imageUrl?: string;\r\n}\r\n\r\ninterface SunoTrack {\r\n    id: string;\r\n    audioUrl: string;\r\n    title?: string;\r\n    duration: number;\r\n    imageUrl?: string;\r\n}\r\n\r\nexport default function BgmGenerationPage() {\r\n    const [prompt, setPrompt] = React.useState(\"\")\r\n    const [title, setTitle] = React.useState(\"\")\r\n    const [style, setStyle] = React.useState(\"\")\r\n    const [isInstrumental, setIsInstrumental] = React.useState(false)\r\n    const [isGenerating, setIsGenerating] = React.useState(false)\r\n    const [generatedBgm, setGeneratedBgm] = React.useState<GeneratedBgm[]>([])\r\n    const [playingId, setPlayingId] = React.useState<string | null>(null)\r\n    const audioRefs = React.useRef<{ [key: string]: HTMLAudioElement }>({})\r\n    const { kieKey } = useSettingsStore()\r\n    const { addAsset, currentProject, saveCurrentProject } = useProjectStore()\r\n\r\n    const [selectedLyrics, setSelectedLyrics] = React.useState<{ title: string; content: string } | null>(null);\r\n\r\n    const handleGenerate = async () => {\r\n        if (!prompt.trim()) return;\r\n\r\n        setIsGenerating(true);\r\n        try {\r\n            // 1. Create Task\r\n            const createRes = await fetch('/api/bgm-generation', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                    'x-kie-key': kieKey || ''\r\n                },\r\n                body: JSON.stringify({\r\n                    prompt,\r\n                    title,\r\n                    style,\r\n                    instrumental: isInstrumental,\r\n                    model: \"V3_5\"\r\n                })\r\n            });\r\n\r\n            const createData = await createRes.json();\r\n            if (!createRes.ok) throw new Error(createData.error || 'Failed to start generation');\r\n\r\n            if (!createData.data || !createData.data.taskId) {\r\n                throw new Error(createData.msg || 'No task ID returned from API');\r\n            }\r\n\r\n            const taskId = createData.data.taskId;\r\n\r\n            // 2. Poll for Status\r\n            const pollInterval = setInterval(async () => {\r\n                try {\r\n                    const statusRes = await fetch(`/api/bgm-generation/${taskId}`, {\r\n                        headers: { 'x-kie-key': kieKey || '' }\r\n                    });\r\n                    const statusData = await statusRes.json();\r\n\r\n                    if (statusData.data.status === 'SUCCESS' || statusData.data.status === 'FIRST_SUCCESS') {\r\n                        // If SUCCESS, we might have multiple tracks, but let's just take the first one for now or handle list\r\n                        const tracks = statusData.data.response.sunoData;\r\n\r\n                        if (tracks && tracks.length > 0) {\r\n                            clearInterval(pollInterval);\r\n                            const newTracks = tracks.map((track: SunoTrack) => ({\r\n                                id: track.id,\r\n                                url: track.audioUrl,\r\n                                title: track.title || title || \"Untitled\",\r\n                                prompt: prompt, // Using the prompt used for generation as lyrics/description\r\n                                duration: track.duration,\r\n                                createdAt: Date.now(),\r\n                                imageUrl: track.imageUrl\r\n                            }));\r\n\r\n                            setGeneratedBgm(prev => [...newTracks, ...prev]);\r\n\r\n                            // Auto-save to library\r\n                            if (currentProject) {\r\n                                newTracks.forEach((track: GeneratedBgm) => {\r\n                                    addAsset({\r\n                                        type: 'audio',\r\n                                        title: track.title || `BGM - ${prompt.slice(0, 20)}...`,\r\n                                        url: track.url,\r\n                                        tag: 'bgm',\r\n                                        sceneNumber: 0 // Global asset\r\n                                    });\r\n                                });\r\n                                saveCurrentProject();\r\n                            }\r\n\r\n                            setIsGenerating(false);\r\n                        }\r\n                    } else if (statusData.data.status === 'GENERATE_AUDIO_FAILED' || statusData.data.status === 'CREATE_TASK_FAILED') {\r\n                        clearInterval(pollInterval);\r\n                        setIsGenerating(false);\r\n                        alert(`Generation failed: ${statusData.data.errorMessage}`);\r\n                    }\r\n                } catch (error) {\r\n                    console.error('Polling error:', error);\r\n                }\r\n            }, 5000); // Poll every 5 seconds for Suno as it takes longer\r\n\r\n        } catch (error) {\r\n            console.error('Generation error:', error);\r\n            setIsGenerating(false);\r\n            alert('Failed to generate BGM. Please try again.');\r\n        }\r\n    };\r\n\r\n    const togglePlay = (id: string, url: string) => {\r\n        if (playingId === id) {\r\n            audioRefs.current[id]?.pause();\r\n            setPlayingId(null);\r\n        } else {\r\n            if (playingId && audioRefs.current[playingId]) {\r\n                audioRefs.current[playingId].pause();\r\n            }\r\n            if (!audioRefs.current[id]) {\r\n                audioRefs.current[id] = new Audio(url);\r\n                audioRefs.current[id].onended = () => setPlayingId(null);\r\n            }\r\n            audioRefs.current[id].play();\r\n            setPlayingId(id);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex h-full gap-6 p-6\">\r\n            {/* Left Panel - Controls */}\r\n            <div className=\"w-[400px] shrink-0 flex flex-col gap-6 overflow-y-auto px-2\">\r\n                <div>\r\n                    <h1 className=\"text-2xl font-bold text-white mb-2\">AI 배경음악 생성</h1>\r\n                    <p className=\"text-sm text-muted\">원하는 분위기의 음악을 작곡하세요.</p>\r\n                </div>\r\n\r\n                <div className=\"space-y-6\">\r\n                    {/* Prompt Input */}\r\n                    <div className=\"space-y-2\">\r\n                        <div className=\"flex justify-between items-center\">\r\n                            <label className=\"text-sm font-medium text-gray-300\">음악 설명 (가사 내용)</label>\r\n                            <MagicPromptButton\r\n                                prompt={prompt}\r\n                                onPromptChange={setPrompt}\r\n                                type=\"bgm\"\r\n                            />\r\n                        </div>\r\n                        <Textarea\r\n                            placeholder=\"어떤 음악을 만들고 싶으신가요? (예: 희망찬 분위기의 팝송, 가사는 미래에 대한 내용)\"\r\n                            className=\"h-32 resize-none\"\r\n                            value={prompt}\r\n                            onChange={(e) => setPrompt(e.target.value)}\r\n                        />\r\n                        <div className=\"flex justify-between text-xs text-muted\">\r\n                            <span>한국어 지원</span>\r\n                            <span>{prompt.length}/500</span>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Advanced Settings */}\r\n                    <div className=\"space-y-4 p-4 bg-[#15151e] rounded-lg border border-[#2a2a35]\">\r\n                        <div className=\"flex items-center justify-between\">\r\n                            <label className=\"text-sm font-medium text-gray-300\">보컬 여부</label>\r\n                            <div className=\"flex items-center gap-2 bg-[#262633] p-1 rounded-lg\">\r\n                                <button\r\n                                    onClick={() => setIsInstrumental(false)}\r\n                                    className={`px-3 py-1.5 rounded-md text-xs font-medium transition-colors ${!isInstrumental ? 'bg-primary text-white' : 'text-gray-400 hover:text-white'}`}\r\n                                >\r\n                                    보컬 포함\r\n                                </button>\r\n                                <button\r\n                                    onClick={() => setIsInstrumental(true)}\r\n                                    className={`px-3 py-1.5 rounded-md text-xs font-medium transition-colors ${isInstrumental ? 'bg-primary text-white' : 'text-gray-400 hover:text-white'}`}\r\n                                >\r\n                                    연주곡 (Inst)\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"space-y-2\">\r\n                            <label className=\"text-sm font-medium text-gray-300\">음악 스타일</label>\r\n                            <Input\r\n                                placeholder=\"예: K-Pop, Jazz, Rock, EDM\"\r\n                                value={style}\r\n                                onChange={(e) => setStyle(e.target.value)}\r\n                            />\r\n                        </div>\r\n\r\n                        <div className=\"space-y-2\">\r\n                            <label className=\"text-sm font-medium text-gray-300\">제목 (선택)</label>\r\n                            <Input\r\n                                placeholder=\"곡 제목을 입력하세요\"\r\n                                value={title}\r\n                                onChange={(e) => setTitle(e.target.value)}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Generate Button */}\r\n                    <Button\r\n                        className=\"w-full h-12 text-lg font-semibold shadow-blue-500/20\"\r\n                        size=\"lg\"\r\n                        onClick={handleGenerate}\r\n                        disabled={isGenerating || !prompt.trim()}\r\n                    >\r\n                        {isGenerating ? (\r\n                            <>\r\n                                <Loader2 className=\"w-5 h-5 mr-2 animate-spin\" />\r\n                                작곡 중...\r\n                            </>\r\n                        ) : (\r\n                            <>\r\n                                <Radio className=\"w-5 h-5 mr-2\" />\r\n                                음악 생성하기\r\n                            </>\r\n                        )}\r\n                    </Button>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Right Panel - List */}\r\n            <div className=\"flex-1 flex flex-col min-w-0\">\r\n                <div className=\"flex items-center justify-between mb-6\">\r\n                    <h2 className=\"text-xl font-semibold text-white\">최근 생성된 음악</h2>\r\n                </div>\r\n\r\n                <div className=\"flex-1 rounded-xl border border-border bg-[#15151e] p-6 overflow-y-auto custom-scrollbar\">\r\n                    {generatedBgm.length === 0 ? (\r\n                        <div className=\"flex flex-col items-center justify-center h-full text-center text-muted opacity-50\">\r\n                            <Disc className=\"w-16 h-16 mb-4 animate-spin-slow\" />\r\n                            <p>생성된 음악이 여기에 표시됩니다</p>\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                            {generatedBgm.map((bgm) => (\r\n                                <div key={bgm.id} className=\"flex flex-col p-4 rounded-lg bg-[#262633] border border-[#2a2a35] hover:border-primary transition-colors group\">\r\n                                    <div className=\"flex items-start gap-4 mb-4\">\r\n                                        <div className=\"w-20 h-20 rounded-lg bg-black/50 overflow-hidden shrink-0 relative\">\r\n                                            {bgm.imageUrl ? (\r\n                                                <img src={bgm.imageUrl} alt={bgm.title} className=\"w-full h-full object-cover\" />\r\n                                            ) : (\r\n                                                <div className=\"w-full h-full flex items-center justify-center text-gray-600\">\r\n                                                    <Music className=\"w-8 h-8\" />\r\n                                                </div>\r\n                                            )}\r\n                                            <div className=\"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity\">\r\n                                                <Button\r\n                                                    size=\"icon\"\r\n                                                    variant=\"primary\"\r\n                                                    className=\"rounded-full w-8 h-8\"\r\n                                                    onClick={() => togglePlay(bgm.id, bgm.url)}\r\n                                                >\r\n                                                    {playingId === bgm.id ? <Pause className=\"w-4 h-4\" /> : <Play className=\"w-4 h-4 ml-0.5\" />}\r\n                                                </Button>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div className=\"flex-1 min-w-0\">\r\n                                            <h4 className=\"text-base font-bold text-white truncate mb-1\">{bgm.title}</h4>\r\n                                            <p className=\"text-xs text-gray-400 line-clamp-2 mb-2\">{bgm.prompt}</p>\r\n                                            <div className=\"flex items-center gap-2 text-[10px] text-gray-500\">\r\n                                                <span className=\"bg-white/5 px-1.5 py-0.5 rounded\">{Math.floor(bgm.duration)}s</span>\r\n                                                <span>{new Date(bgm.createdAt).toLocaleDateString()}</span>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"flex items-center gap-2 mt-auto pt-3 border-t border-white/5\">\r\n                                        <Button\r\n                                            size=\"sm\"\r\n                                            variant=\"ghost\"\r\n                                            className=\"w-full text-xs h-8\"\r\n                                            onClick={() => setSelectedLyrics({ title: bgm.title, content: bgm.prompt })}\r\n                                        >\r\n                                            <Mic className=\"w-3.5 h-3.5 mr-2\" />\r\n                                            가사 보기\r\n                                        </Button>\r\n                                    </div>\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n\r\n            {/* Lyrics Modal */}\r\n            {selectedLyrics && (\r\n                <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4\">\r\n                    <div className=\"bg-[#1e1e2d] border border-[#2a2a35] rounded-xl w-full max-w-lg max-h-[80vh] flex flex-col shadow-2xl\">\r\n                        <div className=\"flex items-center justify-between p-4 border-b border-[#2a2a35]\">\r\n                            <h3 className=\"text-lg font-bold text-white truncate pr-4\">{selectedLyrics.title}</h3>\r\n                            <Button\r\n                                variant=\"ghost\"\r\n                                size=\"sm\"\r\n                                onClick={() => setSelectedLyrics(null)}\r\n                                className=\"h-8 w-8 p-0 rounded-full hover:bg-white/10\"\r\n                            >\r\n                                ✕\r\n                            </Button>\r\n                        </div>\r\n                        <div className=\"p-6 overflow-y-auto custom-scrollbar\">\r\n                            <div className=\"text-center space-y-4\">\r\n                                {selectedLyrics.content.split('\\n').map((line, i) => (\r\n                                    <p key={i} className=\"text-gray-300 leading-relaxed\">\r\n                                        {line || <br />}\r\n                                    </p>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\app\\editor\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\app\\image-generation\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Input' is defined but never used.","line":5,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Download' is defined but never used.","line":8,"column":75,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":83},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Video' is defined but never used.","line":8,"column":85,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":90},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Save' is defined but never used.","line":8,"column":92,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":96},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":23,"column":9,"nodeType":"JSXOpeningElement","endLine":28,"endColumn":11}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport { Button } from \"@/components/ui/Button\"\r\nimport { Input, Textarea } from \"@/components/ui/Input\"\r\nimport { Card, CardContent } from \"@/components/ui/Card\"\r\nimport { Tabs, TabsList, TabsTrigger, TabsContent } from \"@/components/ui/Tabs\"\r\nimport { Image as ImageIcon, Upload, Sparkles, Wand2, Settings2, Loader2, Download, Video, Save, Check } from \"lucide-react\"\r\nimport { MagicPromptButton } from \"@/components/common/MagicPromptButton\"\r\nimport { useSettingsStore } from \"@/store/useSettingsStore\"\r\nimport { useProjectStore } from \"@/store/useProjectStore\"\r\n\r\ninterface GeneratedImage {\r\n    id: string;\r\n    url: string;\r\n    prompt: string;\r\n    createdAt: number;\r\n    saved?: boolean;\r\n}\r\n\r\nconst GeneratedImageCard = React.memo(({ img }: { img: GeneratedImage }) => (\r\n    <div className=\"group relative aspect-square rounded-lg overflow-hidden bg-gray-800 hover:ring-2 hover:ring-primary transition-all cursor-pointer\">\r\n        <img\r\n            src={img.url}\r\n            alt={img.prompt}\r\n            className=\"w-full h-full object-cover transition-transform group-hover:scale-105\"\r\n            loading=\"lazy\"\r\n        />\r\n        <div className=\"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2\">\r\n            <div className=\"bg-green-500/90 text-white px-3 py-1 rounded-full text-xs font-medium flex items-center gap-1\">\r\n                <Check className=\"w-3 h-3\" />\r\n                Saved to Library\r\n            </div>\r\n        </div>\r\n        <div className=\"absolute bottom-0 left-0 right-0 p-2 bg-gradient-to-t from-black/80 to-transparent opacity-0 group-hover:opacity-100 transition-opacity\">\r\n            <p className=\"text-[10px] text-white truncate\">{img.prompt}</p>\r\n        </div>\r\n    </div>\r\n));\r\nGeneratedImageCard.displayName = 'GeneratedImageCard';\r\n\r\nexport default function ImageGenerationPage() {\r\n    const [prompt, setPrompt] = React.useState(\"\")\r\n    const [isGenerating, setIsGenerating] = React.useState(false)\r\n    const [aspectRatio, setAspectRatio] = React.useState(\"1:1\")\r\n    const [selectedModel, setSelectedModel] = React.useState(\"nanobanana\")\r\n\r\n    const { falKey, openaiKey, kieKey } = useSettingsStore()\r\n    const { addAsset, currentProject, saveCurrentProject } = useProjectStore()\r\n\r\n    // Sync generated images from project assets using useMemo\r\n    const generatedImages = React.useMemo(() => {\r\n        if (!currentProject?.assets) return [];\r\n\r\n        return currentProject.assets\r\n            .filter(a => a.type === 'image' && a.tag) // Assuming 'tag' stores the model name or 'upload'\r\n            .map(a => ({\r\n                id: a.id,\r\n                url: a.url,\r\n                prompt: a.title.replace('AI Generated - ', '').replace('...', ''), // Reconstruct prompt roughly or store it better\r\n                createdAt: new Date(a.createdAt).getTime(),\r\n                saved: true\r\n            }))\r\n            .sort((a, b) => b.createdAt - a.createdAt);\r\n    }, [currentProject?.assets]);\r\n\r\n    const handleGenerate = async () => {\r\n        if (!prompt.trim()) return;\r\n\r\n        setIsGenerating(true);\r\n        try {\r\n            // 1. Create Task\r\n            // Reuse the main image generation API which handles all models and optimization\r\n            const createRes = await fetch('/api/image/generate', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                    'x-fal-key': falKey || '',\r\n                    'x-openai-key': openaiKey || '',\r\n                    'x-kie-key': kieKey || ''\r\n                },\r\n                body: JSON.stringify({\r\n                    prompt,\r\n                    imageSize: aspectRatio === \"16:9\" ? \"landscape_16_9\" : aspectRatio === \"9:16\" ? \"portrait_16_9\" : \"square_hd\",\r\n                    model: selectedModel\r\n                })\r\n            });\r\n\r\n            const createData = await createRes.json();\r\n            if (!createRes.ok) throw new Error(createData.error || 'Failed to start generation');\r\n\r\n            // Handle Polling for Nanobanana (status: 'pending')\r\n            if (createData.status === 'pending' && createData.taskId) {\r\n                const taskId = createData.taskId;\r\n\r\n                // 2. Poll for Status\r\n                const pollInterval = setInterval(async () => {\r\n                    try {\r\n                        const kieKey = useSettingsStore.getState().kieKey;\r\n                        const statusRes = await fetch(`/api/image-generation/${taskId}`, {\r\n                            headers: { 'x-kie-key': kieKey || '' }\r\n                        });\r\n                        const statusData = await statusRes.json();\r\n\r\n                        if (statusData.data?.state === 'success') {\r\n                            clearInterval(pollInterval);\r\n                            const resultJson = JSON.parse(statusData.data.resultJson);\r\n                            // Try multiple paths for image URL\r\n                            const imageUrl = resultJson.resultUrls?.[0]\r\n                                || resultJson.url\r\n                                || resultJson.image_url\r\n                                || (Array.isArray(resultJson) ? resultJson[0] : null);\r\n\r\n                            if (imageUrl) {\r\n                                // Auto-save to library\r\n                                if (currentProject) {\r\n                                    await addAsset({\r\n                                        type: 'image',\r\n                                        title: `AI Generated - ${prompt}`,\r\n                                        url: imageUrl,\r\n                                        tag: selectedModel,\r\n                                        sceneNumber: 0\r\n                                    });\r\n                                    saveCurrentProject();\r\n                                }\r\n                            }\r\n                            setIsGenerating(false);\r\n                        } else if (statusData.data?.state === 'fail') {\r\n                            clearInterval(pollInterval);\r\n                            setIsGenerating(false);\r\n                            alert(`Generation failed: ${statusData.data.failMsg}`);\r\n                        }\r\n                    } catch (error) {\r\n                        console.error('Polling error:', error);\r\n                    }\r\n                }, 2000);\r\n            }\r\n            // Handle Flux/Direct Response (imageUrl present)\r\n            else if (createData.imageUrl) {\r\n                // Auto-save to library\r\n                if (currentProject) {\r\n                    await addAsset({\r\n                        type: 'image',\r\n                        title: `AI Generated - ${prompt}`,\r\n                        url: createData.imageUrl,\r\n                        tag: selectedModel,\r\n                        sceneNumber: 0\r\n                    });\r\n                    saveCurrentProject();\r\n                }\r\n\r\n                setIsGenerating(false);\r\n            } else {\r\n                throw new Error('Invalid response from generation API');\r\n            }\r\n\r\n        } catch (error) {\r\n            console.error('Generation error:', error);\r\n            setIsGenerating(false);\r\n            alert('Failed to generate image. Please try again.');\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex h-full gap-6 p-6 py-10\">\r\n            {/* Left Panel - Controls */}\r\n            <div className=\"w-[400px] shrink-0 flex flex-col gap-6 overflow-y-auto px-2\">\r\n                <div>\r\n                    <h1 className=\"text-2xl font-bold text-white mb-2\">AI 이미지 생성기</h1>\r\n                    <p className=\"text-sm text-muted\">텍스트를 입력하여 고품질 이미지를 생성하세요.</p>\r\n                </div>\r\n\r\n                <Tabs defaultValue=\"text-to-image\" className=\"w-full\">\r\n                    <TabsList className=\"w-full grid grid-cols-2 mb-4\">\r\n                        <TabsTrigger value=\"text-to-image\">텍스트를 이미지로</TabsTrigger>\r\n                        <TabsTrigger value=\"image-to-image\">이미지를 이미지로</TabsTrigger>\r\n                    </TabsList>\r\n\r\n                    <TabsContent value=\"text-to-image\" className=\"space-y-6\">\r\n                        {/* Prompt Input */}\r\n                        <div className=\"space-y-2\">\r\n                            <div className=\"flex justify-between items-center\">\r\n                                <label className=\"text-sm font-medium text-gray-300\">프롬프트</label>\r\n                                <MagicPromptButton\r\n                                    prompt={prompt}\r\n                                    onPromptChange={setPrompt}\r\n                                    type=\"image\"\r\n                                />\r\n                            </div>\r\n                            <Textarea\r\n                                placeholder=\"생성하고 싶은 이미지를 자세히 설명해주세요... (예: 사이버펑크 도시의 네온사인 거리, 비 오는 밤)\"\r\n                                className=\"h-32 resize-none\"\r\n                                value={prompt}\r\n                                onChange={(e) => setPrompt(e.target.value)}\r\n                                maxLength={2000}\r\n                            />\r\n                            <div className=\"flex justify-between text-xs text-muted\">\r\n                                <span>한국어 지원</span>\r\n                                <span>{prompt.length}/2000</span>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Model Selection */}\r\n                        <div className=\"space-y-2\">\r\n                            <label className=\"text-sm font-medium text-gray-300\">모델 선택</label>\r\n                            <div className=\"grid grid-cols-1 gap-2\">\r\n                                <div className=\"grid grid-cols-3 gap-2\">\r\n                                    <Button\r\n                                        variant={selectedModel === 'dev' ? 'secondary' : 'outline'}\r\n                                        className={`justify-center gap-2 h-auto py-3 ${selectedModel === 'dev' ? 'border-primary bg-primary/10 text-white' : ''}`}\r\n                                        onClick={() => setSelectedModel('dev')}\r\n                                    >\r\n                                        <Wand2 className=\"w-4 h-4\" />\r\n                                        <div className=\"text-center\">\r\n                                            <div className=\"font-medium text-xs\">Flux Dev</div>\r\n                                            <div className=\"text-[10px] text-muted\">Quality</div>\r\n                                        </div>\r\n                                    </Button>\r\n                                    <Button\r\n                                        variant={selectedModel === 'schnell' ? 'secondary' : 'outline'}\r\n                                        className={`justify-center gap-2 h-auto py-3 ${selectedModel === 'schnell' ? 'border-primary bg-primary/10 text-white' : ''}`}\r\n                                        onClick={() => setSelectedModel('schnell')}\r\n                                    >\r\n                                        <Sparkles className=\"w-4 h-4\" />\r\n                                        <div className=\"text-center\">\r\n                                            <div className=\"font-medium text-xs\">Flux Schnell</div>\r\n                                            <div className=\"text-[10px] text-muted\">Fast</div>\r\n                                        </div>\r\n                                    </Button>\r\n                                    <Button\r\n                                        variant={selectedModel === 'nanobanana' ? 'secondary' : 'outline'}\r\n                                        className={`justify-center gap-2 h-auto py-3 ${selectedModel === 'nanobanana' ? 'border-primary bg-primary/10 text-white' : ''}`}\r\n                                        onClick={() => setSelectedModel('nanobanana')}\r\n                                    >\r\n                                        <Wand2 className=\"w-4 h-4 text-primary\" />\r\n                                        <div className=\"text-center\">\r\n                                            <div className=\"font-medium text-xs\">Nanobanana</div>\r\n                                            <div className=\"text-[10px] text-muted\">Pro</div>\r\n                                        </div>\r\n                                    </Button>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Aspect Ratio */}\r\n                        <div className=\"space-y-2\">\r\n                            <label className=\"text-sm font-medium text-gray-300\">비율</label>\r\n                            <div className=\"grid grid-cols-3 gap-2\">\r\n                                {['1:1', '16:9', '9:16', '4:3', '3:4'].map((ratio) => (\r\n                                    <Button\r\n                                        key={ratio}\r\n                                        variant={aspectRatio === ratio ? \"secondary\" : \"outline\"}\r\n                                        size=\"sm\"\r\n                                        onClick={() => setAspectRatio(ratio)}\r\n                                        className={aspectRatio === ratio ? \"bg-primary text-white hover:bg-primary/90\" : \"\"}\r\n                                    >\r\n                                        {ratio}\r\n                                    </Button>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Generate Button */}\r\n                        <Button\r\n                            className=\"w-full h-12 text-lg font-semibold shadow-blue-500/20\"\r\n                            size=\"lg\"\r\n                            onClick={handleGenerate}\r\n                            disabled={isGenerating || !prompt.trim()}\r\n                        >\r\n                            {isGenerating ? (\r\n                                <>\r\n                                    <Loader2 className=\"w-5 h-5 mr-2 animate-spin\" />\r\n                                    생성 중...\r\n                                </>\r\n                            ) : (\r\n                                <>\r\n                                    <Sparkles className=\"w-5 h-5 mr-2\" />\r\n                                    이미지 생성하기\r\n                                </>\r\n                            )}\r\n                        </Button>\r\n                    </TabsContent>\r\n\r\n                    <TabsContent value=\"image-to-image\" className=\"space-y-6\">\r\n                        <div className=\"relative\">\r\n                            <input\r\n                                type=\"file\"\r\n                                accept=\"image/*\"\r\n                                className=\"hidden\"\r\n                                id=\"img-to-img-upload\"\r\n                                onChange={(e) => {\r\n                                    const file = e.target.files?.[0];\r\n                                    if (file) {\r\n                                        // Handle file upload (mock for now or implement real upload)\r\n\r\n                                        // You might want to set a state here to show the selected image\r\n                                    }\r\n                                }}\r\n                            />\r\n                            <label\r\n                                htmlFor=\"img-to-img-upload\"\r\n                                className=\"block w-full\"\r\n                            >\r\n                                <Card className=\"border-dashed border-2 border-border bg-transparent hover:bg-white/5 transition-colors cursor-pointer w-full\">\r\n                                    <CardContent className=\"flex flex-col items-center justify-center py-12 text-center\">\r\n                                        <Upload className=\"w-10 h-10 text-muted mb-4\" />\r\n                                        <h3 className=\"text-lg font-medium text-white mb-1\">참조 이미지 업로드</h3>\r\n                                        <p className=\"text-sm text-muted\">클릭하거나 이미지를 드래그하세요</p>\r\n                                        <p className=\"text-xs text-muted mt-2\">JPG, PNG (최대 10MB)</p>\r\n                                    </CardContent>\r\n                                </Card>\r\n                            </label>\r\n                        </div>\r\n\r\n                        <div className=\"space-y-2\">\r\n                            <label className=\"text-sm font-medium text-gray-300\">변경 프롬프트</label>\r\n                            <Textarea\r\n                                placeholder=\"이미지를 어떻게 변경하고 싶으신가요?\"\r\n                                className=\"h-24 w-full resize-none\"\r\n                            />\r\n                        </div>\r\n\r\n                        <Button className=\"w-full h-12 text-lg font-semibold\" size=\"lg\" disabled>\r\n                            <Wand2 className=\"w-5 h-5 mr-2\" />\r\n                            변환하기 (준비 중)\r\n                        </Button>\r\n                    </TabsContent>\r\n                </Tabs>\r\n            </div>\r\n\r\n            {/* Right Panel - Gallery/Preview */}\r\n            <div className=\"flex-1 flex flex-col min-w-0\">\r\n                <div className=\"flex items-center justify-between mb-6\">\r\n                    <h2 className=\"text-xl font-semibold text-white\">최근 생성된 이미지</h2>\r\n                    <div className=\"flex gap-2\">\r\n                        <Button variant=\"ghost\" size=\"sm\" className=\"text-muted\">\r\n                            <Settings2 className=\"w-4 h-4 mr-2\" />\r\n                            보기 설정\r\n                        </Button>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Empty State / Gallery Grid */}\r\n                <div className=\"flex-1 rounded-xl border border-border bg-[#15151e] p-6 overflow-y-auto custom-scrollbar\">\r\n                    {generatedImages.length === 0 ? (\r\n                        <div className=\"flex flex-col items-center justify-center h-full text-center text-muted opacity-50\">\r\n                            <ImageIcon className=\"w-16 h-16 mb-4\" />\r\n                            <p>생성된 이미지가 여기에 표시됩니다</p>\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4\">\r\n                            {generatedImages.map((img) => (\r\n                                <GeneratedImageCard key={img.id} img={img} />\r\n                            ))}\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\app\\image\\page.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The 'scenes' logical expression could make the dependencies of useEffect Hook (at line 36) change on every render. To fix this, wrap the initialization of 'scenes' in its own useMemo() Hook.","line":21,"column":11,"nodeType":"VariableDeclarator","endLine":21,"endColumn":48},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":311,"column":45,"nodeType":"JSXOpeningElement","endLine":311,"endColumn":138},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":343,"column":25,"nodeType":"JSXOpeningElement","endLine":348,"endColumn":27}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { Image as ImageIcon, Wand2, RefreshCw, Zap, X } from 'lucide-react';\r\nimport { useState, useEffect } from 'react';\r\nimport { useProjectStore } from '@/store/useProjectStore';\r\nimport toast, { Toaster } from 'react-hot-toast';\r\nimport { useSettingsStore } from '@/store/useSettingsStore';\r\nimport { MagicPromptButton } from '@/components/common/MagicPromptButton';\r\n\r\nexport default function ImagePage() {\r\n    const [fixedPrompt, setFixedPrompt] = useState('high quality, professional photography, 8k resolution, detailed, cinematic lighting, vibrant colors');\r\n    const [generatingId, setGeneratingId] = useState<number | null>(null);\r\n    const [selectedModel, setSelectedModel] = useState<'dev' | 'schnell' | 'nanobanana'>('dev');\r\n\r\n    // New state to track editable prompts for each scene\r\n    const [editablePrompts, setEditablePrompts] = useState<{ [key: number]: string }>({});\r\n    const [previewImage, setPreviewImage] = useState<string | null>(null);\r\n\r\n    const { currentProject, updateScene, saveCurrentProject, updateProjectInfo, addAsset } = useProjectStore();\r\n    const { falKey, openaiKey } = useSettingsStore();\r\n    const scenes = currentProject?.scenes || [];\r\n\r\n    // Initialize editable prompts when scenes load or fixedPrompt changes\r\n    useEffect(() => {\r\n        if (scenes.length > 0) {\r\n            setEditablePrompts(prev => {\r\n                const newPrompts = { ...prev };\r\n                scenes.forEach(scene => {\r\n                    newPrompts[scene.id] = fixedPrompt\r\n                        ? `${fixedPrompt}, ${scene.text}`\r\n                        : scene.text;\r\n                });\r\n                return newPrompts;\r\n            });\r\n        }\r\n    }, [scenes, fixedPrompt]);\r\n\r\n    const handlePromptChange = (sceneId: number, newPrompt: string) => {\r\n        setEditablePrompts(prev => ({\r\n            ...prev,\r\n            [sceneId]: newPrompt\r\n        }));\r\n    };\r\n\r\n    const handleGenerateImage = async (sceneId: number) => {\r\n        const finalPrompt = editablePrompts[sceneId];\r\n\r\n        if (!finalPrompt) {\r\n            toast.error('프롬프트가 없습니다');\r\n            return;\r\n        }\r\n\r\n        if (!falKey || !openaiKey) {\r\n            toast.error('설정에서 FAL 및 OpenAI API 키를 먼저 입력해주세요.');\r\n            return;\r\n        }\r\n\r\n        setGeneratingId(sceneId);\r\n        try {\r\n            const response = await fetch('/api/image/generate', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                    'x-fal-key': falKey,\r\n                    'x-openai-key': openaiKey,\r\n                    'x-kie-key': useSettingsStore.getState().kieKey\r\n                },\r\n                body: JSON.stringify({\r\n                    prompt: finalPrompt,\r\n                    imageSize: \"landscape_16_9\",\r\n                    guidanceScale: 3.5,\r\n                    model: selectedModel\r\n                }),\r\n            });\r\n\r\n            if (!response.ok) {\r\n                const errorData = await response.json();\r\n                throw new Error(errorData.error || 'Image generation failed');\r\n            }\r\n\r\n            const data = await response.json();\r\n\r\n            let finalImageUrl = data.imageUrl;\r\n\r\n            // Handle Polling for Nanobanana\r\n            if (data.status === 'pending' && data.taskId) {\r\n                const taskId = data.taskId;\r\n                let attempts = 0;\r\n                const maxAttempts = 60; // 2 minutes max (2s interval)\r\n\r\n                while (attempts < maxAttempts) {\r\n                    attempts++;\r\n                    await new Promise(resolve => setTimeout(resolve, 2000));\r\n\r\n                    // Use the existing image-generation status route or a new one. \r\n                    // Since we don't have a dedicated /api/image/status, we can use the one from AI Tools if compatible,\r\n                    // or better, fetch directly from KIE if we had the key client-side (we don't want to expose it).\r\n                    // Let's assume we can use /api/image-generation/[taskId] which is generic for KIE tasks.\r\n                    const statusRes = await fetch(`/api/image-generation/${taskId}`, {\r\n                        headers: { 'x-kie-key': useSettingsStore.getState().kieKey || '' }\r\n                    });\r\n                    const statusData = await statusRes.json();\r\n\r\n                    if (statusData.data?.state === 'success') {\r\n                        const resultJson = JSON.parse(statusData.data.resultJson);\r\n                        // Try multiple paths\r\n                        finalImageUrl = resultJson.resultUrls?.[0]\r\n                            || resultJson.url\r\n                            || resultJson.image_url\r\n                            || (Array.isArray(resultJson) ? resultJson[0] : null);\r\n\r\n                        if (finalImageUrl) break;\r\n                    } else if (statusData.data?.state === 'fail') {\r\n                        throw new Error(`Generation failed: ${statusData.data.failMsg}`);\r\n                    }\r\n                }\r\n\r\n                if (!finalImageUrl) throw new Error('Timeout waiting for image generation');\r\n            }\r\n\r\n            if (!finalImageUrl) throw new Error('No image URL received');\r\n\r\n            // Update scene with new image\r\n            updateScene(sceneId, { imageUrl: finalImageUrl });\r\n\r\n            // Update project info (thumbnail & type)\r\n            updateProjectInfo({\r\n                type: 'image',\r\n                thumbnail: finalImageUrl\r\n            });\r\n\r\n            // Auto-save to library\r\n            await addAsset({\r\n                type: 'image',\r\n                title: `${currentProject?.title || 'Project'} - Scene ${sceneId}`,\r\n                url: finalImageUrl,\r\n                tag: selectedModel,\r\n                sceneNumber: sceneId\r\n            });\r\n\r\n            saveCurrentProject();\r\n\r\n            toast.success(`이미지 생성 완료 (${selectedModel === 'dev' ? 'High Quality' : selectedModel === 'schnell' ? 'Fast' : 'Pro'})`);\r\n        } catch (error) {\r\n            console.error('Image generation error:', error);\r\n            toast.error(`이미지 생성 실패: ${error instanceof Error ? error.message : 'Unknown error'}`);\r\n        } finally {\r\n            setGeneratingId(null);\r\n        }\r\n    };\r\n\r\n    const handleGenerateAll = async () => {\r\n        let successCount = 0;\r\n        for (const scene of scenes) {\r\n            if (!scene.imageUrl && editablePrompts[scene.id]) {\r\n                await handleGenerateImage(scene.id);\r\n                successCount++;\r\n                await new Promise(resolve => setTimeout(resolve, 2000));\r\n            }\r\n        }\r\n        if (successCount > 0) {\r\n            toast.success(`${successCount}개 이미지 생성 완료`);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex-1 p-[30px_40px] py-10 flex flex-col gap-5 overflow-y-auto custom-scrollbar\">\r\n            <Toaster position=\"top-center\" />\r\n\r\n            <header className=\"flex items-center justify-between mb-2.5\">\r\n                <div className=\"flex items-center gap-2.5\">\r\n                    <ImageIcon className=\"w-5 h-5 text-white\" />\r\n                    <h2 className=\"text-[1.2rem] font-semibold\">이미지</h2>\r\n                </div>\r\n                <button\r\n                    onClick={handleGenerateAll}\r\n                    disabled={generatingId !== null}\r\n                    className=\"bg-(--primary-color) text-white px-5 py-2.5 rounded-lg font-semibold text-[0.9rem] cursor-pointer hover:bg-[#4a4ddb] disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n                >\r\n                    전체 이미지 생성\r\n                </button>\r\n            </header>\r\n\r\n            {/* Settings Section */}\r\n            <section className=\"bg-(--bg-card) rounded-xl p-5 border border-(--border-color) flex flex-col gap-4\">\r\n                <div className=\"flex items-center justify-between\">\r\n                    <div className=\"flex items-center gap-2.5\">\r\n                        <h3 className=\"text-[1rem] font-semibold\">이미지 설정</h3>\r\n                        <span className=\"text-[0.85rem] text-(--text-gray)\">모델과 프롬프트를 설정하세요.</span>\r\n                    </div>\r\n\r\n                    {/* Model Selector */}\r\n                    <div className=\"flex bg-[#16161d] p-1 rounded-lg border border-(--border-color)\">\r\n                        <button\r\n                            onClick={() => setSelectedModel('dev')}\r\n                            className={`px-3 py-1.5 rounded-md text-xs font-medium transition-all flex items-center gap-1.5 ${selectedModel === 'dev'\r\n                                ? 'bg-(--primary-color) text-white shadow-sm'\r\n                                : 'text-(--text-gray) hover:text-white'\r\n                                }`}\r\n                        >\r\n                            <Wand2 className=\"w-3 h-3\" />\r\n                            Flux Dev (Quality)\r\n                        </button>\r\n                        <button\r\n                            onClick={() => setSelectedModel('schnell')}\r\n                            className={`px-3 py-1.5 rounded-md text-xs font-medium transition-all flex items-center gap-1.5 ${selectedModel === 'schnell'\r\n                                ? 'bg-(--primary-color) text-white shadow-sm'\r\n                                : 'text-(--text-gray) hover:text-white'\r\n                                }`}\r\n                        >\r\n                            <Zap className=\"w-3 h-3\" />\r\n                            Flux Schnell (Fast)\r\n                        </button>\r\n                        <button\r\n                            onClick={() => setSelectedModel('nanobanana')}\r\n                            className={`px-3 py-1.5 rounded-md text-xs font-medium transition-all flex items-center gap-1.5 ${selectedModel === 'nanobanana'\r\n                                ? 'bg-(--primary-color) text-white shadow-sm'\r\n                                : 'text-(--text-gray) hover:text-white'\r\n                                }`}\r\n                        >\r\n                            <Wand2 className=\"w-3 h-3\" />\r\n                            Nanobanana (Pro)\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"flex gap-2.5\">\r\n                    <input\r\n                        type=\"text\"\r\n                        className=\"flex-1 bg-[#16161d] border border-(--border-color) rounded-lg px-4 py-2.5 text-white outline-none focus:border-(--primary-color) text-[0.9rem] transition-colors\"\r\n                        placeholder=\"고정 프롬프트 입력 (예: high quality, professional photography, 8k resolution)\"\r\n                        value={fixedPrompt}\r\n                        onChange={(e) => setFixedPrompt(e.target.value)}\r\n                    />\r\n                </div>\r\n                <p className=\"text-[0.75rem] text-(--text-gray)\">\r\n                    💡 <strong>{selectedModel === 'dev' ? 'Flux Dev' : selectedModel === 'schnell' ? 'Flux Schnell' : 'Nanobanana'}</strong> 모델이 선택되었습니다.\r\n                    {selectedModel === 'dev' ? ' 높은 품질의 이미지를 생성하지만 시간이 더 걸릴 수 있습니다.' : selectedModel === 'schnell' ? ' 빠르게 이미지를 생성하며 비용 효율적입니다.' : ' 최신 Nanobanana 모델로 고품질 이미지를 생성합니다.'}\r\n                </p>\r\n            </section>\r\n\r\n            {/* Scene Image Cards Grid */}\r\n            <div className=\"grid grid-cols-2 gap-5\">\r\n                {scenes.length > 0 ? scenes.map((scene) => (\r\n                    <div key={scene.id} className=\"bg-(--bg-card) rounded-xl border border-(--border-color) p-4 flex flex-col gap-4 h-[280px]\">\r\n                        {/* Card Header */}\r\n                        <div className=\"flex justify-between items-center shrink-0\">\r\n                            <span className=\"font-bold text-[1rem]\">#{scene.id}</span>\r\n                            <button\r\n                                onClick={() => handleGenerateImage(scene.id)}\r\n                                disabled={generatingId === scene.id || !editablePrompts[scene.id]}\r\n                                className=\"bg-[#3e3e50] text-[#c0c0c0] border-none px-3 py-1.5 rounded text-[0.8rem] cursor-pointer hover:bg-[#4a4a5c] disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1.5 transition-colors\"\r\n                            >\r\n                                {generatingId === scene.id ? (\r\n                                    <>\r\n                                        <RefreshCw className=\"w-3.5 h-3.5 animate-spin\" />\r\n                                        생성 중...\r\n                                    </>\r\n                                ) : (\r\n                                    <>\r\n                                        <Wand2 className=\"w-3.5 h-3.5\" />\r\n                                        생성\r\n                                    </>\r\n                                )}\r\n                            </button>\r\n                        </div>\r\n\r\n                        {/* Card Body */}\r\n                        <div className=\"flex gap-4 flex-1 min-h-0\">\r\n                            {/* Text Section */}\r\n                            <div className=\"flex-1 flex flex-col gap-3 min-w-0\">\r\n                                {/* Script Text (Read Only - 30%) */}\r\n                                <div className=\"flex flex-col gap-1.5 h-[30%] min-h-0\">\r\n                                    <span className=\"text-[0.75rem] font-bold text-(--text-gray) shrink-0\">스크립트 (참고용)</span>\r\n                                    <div className=\"flex-1 bg-[#16161d] rounded-md p-2.5 text-[0.85rem] text-[#d0d0d0] overflow-y-auto leading-[1.4] custom-scrollbar opacity-70\">\r\n                                        {scene.text || \"스크립트가 없습니다\"}\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Prompt Editor (Editable - 70%) */}\r\n                                <div className=\"flex flex-col gap-1.5 h-[70%] min-h-0 relative\">\r\n                                    <div className=\"flex justify-between items-center shrink-0\">\r\n                                        <span className=\"text-[0.75rem] font-bold text-(--text-gray)\">최종 프롬프트 (편집 가능)</span>\r\n                                    </div>\r\n                                    <div className=\"flex-1 relative flex flex-col gap-2\">\r\n                                        <div className=\"relative flex-1\">\r\n                                            <textarea\r\n                                                className=\"w-full h-full bg-[#1a1a24] rounded-md p-2.5 text-[0.8rem] text-white overflow-y-auto custom-scrollbar font-mono leading-relaxed border border-transparent focus:border-(--primary-color) outline-none resize-none transition-colors\"\r\n                                                value={editablePrompts[scene.id] || ''}\r\n                                                onChange={(e) => handlePromptChange(scene.id, e.target.value)}\r\n                                                placeholder=\"프롬프트를 입력하세요...\"\r\n                                            />\r\n                                        </div>\r\n                                        <div className=\"flex justify-end\">\r\n                                            <MagicPromptButton\r\n                                                prompt={editablePrompts[scene.id] || ''}\r\n                                                onPromptChange={(newPrompt) => handlePromptChange(scene.id, newPrompt)}\r\n                                                type=\"image\"\r\n                                                className=\"scale-90\"\r\n                                            />\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Preview Section */}\r\n                            <div className=\"w-[200px] shrink-0\">\r\n                                <div className=\"w-full h-full bg-[#323242] rounded-lg flex justify-center items-center text-(--text-gray) text-[0.9rem] border border-(--border-color) overflow-hidden relative group\">\r\n                                    {scene.imageUrl ? (\r\n                                        <>\r\n                                            <img src={scene.imageUrl} alt={`Scene ${scene.id}`} className=\"w-full h-full object-cover\" />\r\n                                            <div\r\n                                                className=\"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center cursor-pointer\"\r\n                                                onClick={() => setPreviewImage(scene.imageUrl!)}\r\n                                            >\r\n                                                <span className=\"text-white text-xs font-medium\">크게 보기</span>\r\n                                            </div>\r\n                                        </>\r\n                                    ) : (\r\n                                        <span>프리뷰</span>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                )) : (\r\n                    <div className=\"col-span-2 text-center text-(--text-gray) py-10\">\r\n                        생성된 장면이 없습니다. 스크립트 탭에서 먼저 스크립트를 생성하세요.\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Image Preview Modal */}\r\n            {previewImage && (\r\n                <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/90 backdrop-blur-sm\" onClick={() => setPreviewImage(null)}>\r\n                    <div className=\"relative max-w-[90vw] max-h-[90vh]\">\r\n                        <button\r\n                            onClick={() => setPreviewImage(null)}\r\n                            className=\"absolute -top-10 right-0 text-white hover:text-gray-300 transition-colors\"\r\n                        >\r\n                            <X className=\"w-8 h-8\" />\r\n                        </button>\r\n                        <img\r\n                            src={previewImage}\r\n                            alt=\"Preview\"\r\n                            className=\"max-w-full max-h-[90vh] object-contain rounded-lg shadow-2xl\"\r\n                            onClick={(e) => e.stopPropagation()}\r\n                        />\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\app\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\app\\login\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":70,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":70,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState } from 'react';\r\nimport { createClient } from '@/lib/supabase/client';\r\nimport { useRouter } from 'next/navigation';\r\nimport { Wand2, Mail, Lock, Loader2, Github } from 'lucide-react';\r\nimport toast, { Toaster } from 'react-hot-toast';\r\n\r\nexport default function LoginPage() {\r\n    const [email, setEmail] = useState('');\r\n    const [password, setPassword] = useState('');\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [isSignUp, setIsSignUp] = useState(false);\r\n    const router = useRouter();\r\n    const supabase = createClient();\r\n\r\n    const handleAuth = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        setIsLoading(true);\r\n\r\n        try {\r\n            if (isSignUp) {\r\n                const { data, error } = await supabase.auth.signUp({\r\n                    email,\r\n                    password,\r\n                    options: {\r\n                        emailRedirectTo: `${window.location.origin}/auth/callback`,\r\n                    }\r\n                });\r\n                if (error) throw error;\r\n\r\n                // Check if email confirmation is required\r\n                if (data?.user?.identities?.length === 0) {\r\n                    toast.error('이 이메일은 이미 사용 중입니다.');\r\n                } else if (data?.user && !data?.session) {\r\n                    toast.success('회원가입 성공! 이메일을 확인해주세요.');\r\n                } else {\r\n                    toast.success('회원가입 및 로그인 성공!');\r\n                    router.push('/library');\r\n                    router.refresh();\r\n                }\r\n            } else {\r\n                const { error } = await supabase.auth.signInWithPassword({\r\n                    email,\r\n                    password,\r\n                });\r\n                if (error) throw error;\r\n                toast.success('로그인 성공!');\r\n                router.push('/library');\r\n                router.refresh();\r\n            }\r\n        } catch (error) {\r\n            console.error('Auth error:', error);\r\n            const errorMessage = error instanceof Error ? error.message : '인증 실패';\r\n            toast.error(errorMessage);\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleSocialLogin = async (provider: 'google' | 'github') => {\r\n        try {\r\n            const { error } = await supabase.auth.signInWithOAuth({\r\n                provider,\r\n                options: {\r\n                    redirectTo: `${location.origin}/auth/callback`,\r\n                },\r\n            });\r\n            if (error) throw error;\r\n        } catch (error) {\r\n            toast.error('소셜 로그인 실패');\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-[#0f0f16] flex items-center justify-center p-4\">\r\n            <Toaster position=\"top-center\" />\r\n\r\n            <div className=\"w-full max-w-md bg-[#1a1a24] rounded-2xl border border-[#2a2a35] p-8 shadow-2xl\">\r\n                <div className=\"flex flex-col items-center mb-8\">\r\n                    <div className=\"w-12 h-12 bg-(--primary-color) rounded-xl flex items-center justify-center mb-4\">\r\n                        <Wand2 className=\"w-7 h-7 text-white\" />\r\n                    </div>\r\n                    <h1 className=\"text-2xl font-bold text-white mb-2\">AI Studio</h1>\r\n                    <p className=\"text-(--text-gray) text-sm\">\r\n                        {isSignUp ? '새로운 계정을 만들어보세요' : '나만의 스튜디오로 입장하세요'}\r\n                    </p>\r\n                </div>\r\n\r\n                <form onSubmit={handleAuth} className=\"flex flex-col gap-4\">\r\n                    <div className=\"space-y-1\">\r\n                        <label className=\"text-xs font-medium text-(--text-gray) ml-1\">이메일</label>\r\n                        <div className=\"relative\">\r\n                            <Mail className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-(--text-gray)\" />\r\n                            <input\r\n                                type=\"email\"\r\n                                value={email}\r\n                                onChange={(e) => setEmail(e.target.value)}\r\n                                className=\"w-full bg-[#15151e] border border-[#2a2a35] rounded-lg pl-10 pr-4 py-3 text-white text-sm focus:border-(--primary-color) outline-none transition-colors\"\r\n                                placeholder=\"name@example.com\"\r\n                                required\r\n                            />\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"space-y-1\">\r\n                        <label className=\"text-xs font-medium text-(--text-gray) ml-1\">비밀번호</label>\r\n                        <div className=\"relative\">\r\n                            <Lock className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-(--text-gray)\" />\r\n                            <input\r\n                                type=\"password\"\r\n                                value={password}\r\n                                onChange={(e) => setPassword(e.target.value)}\r\n                                className=\"w-full bg-[#15151e] border border-[#2a2a35] rounded-lg pl-10 pr-4 py-3 text-white text-sm focus:border-(--primary-color) outline-none transition-colors\"\r\n                                placeholder=\"••••••••\"\r\n                                required\r\n                                minLength={6}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n\r\n                    <button\r\n                        type=\"submit\"\r\n                        disabled={isLoading}\r\n                        className=\"w-full bg-(--primary-color) hover:bg-[#4a4ddb] text-white py-3 rounded-lg font-medium transition-colors flex items-center justify-center gap-2 mt-2 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                    >\r\n                        {isLoading ? (\r\n                            <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n                        ) : (\r\n                            isSignUp ? '회원가입' : '로그인'\r\n                        )}\r\n                    </button>\r\n                </form>\r\n\r\n                <div className=\"relative my-6\">\r\n                    <div className=\"absolute inset-0 flex items-center\">\r\n                        <div className=\"w-full border-t border-[#2a2a35]\"></div>\r\n                    </div>\r\n                    <div className=\"relative flex justify-center text-xs uppercase\">\r\n                        <span className=\"bg-[#1a1a24] px-2 text-(--text-gray)\">Or continue with</span>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-2 gap-3\">\r\n                    <button\r\n                        onClick={() => handleSocialLogin('github')}\r\n                        className=\"flex items-center justify-center gap-2 bg-[#15151e] hover:bg-[#2a2a35] border border-[#2a2a35] text-white py-2.5 rounded-lg transition-colors text-sm font-medium\"\r\n                    >\r\n                        <Github className=\"w-4 h-4\" />\r\n                        GitHub\r\n                    </button>\r\n                    <button\r\n                        onClick={() => handleSocialLogin('google')}\r\n                        className=\"flex items-center justify-center gap-2 bg-[#15151e] hover:bg-[#2a2a35] border border-[#2a2a35] text-white py-2.5 rounded-lg transition-colors text-sm font-medium\"\r\n                    >\r\n                        <svg className=\"w-4 h-4\" viewBox=\"0 0 24 24\">\r\n                            <path\r\n                                fill=\"currentColor\"\r\n                                d=\"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z\"\r\n                            />\r\n                            <path\r\n                                fill=\"currentColor\"\r\n                                d=\"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z\"\r\n                            />\r\n                            <path\r\n                                fill=\"currentColor\"\r\n                                d=\"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z\"\r\n                            />\r\n                            <path\r\n                                fill=\"currentColor\"\r\n                                d=\"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z\"\r\n                            />\r\n                        </svg>\r\n                        Google\r\n                    </button>\r\n                </div>\r\n\r\n                <div className=\"mt-6 text-center\">\r\n                    <button\r\n                        onClick={() => setIsSignUp(!isSignUp)}\r\n                        className=\"text-xs text-(--text-gray) hover:text-white transition-colors\"\r\n                    >\r\n                        {isSignUp ? '이미 계정이 있으신가요? 로그인' : '계정이 없으신가요? 회원가입'}\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\app\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\app\\preview\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Scene' is defined but never used.","line":4,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":32},{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`handleNext` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nC:\\Users\\user\\Desktop\\studioAI\\src\\app\\preview\\page.tsx:37:21\n  35 |                 // If no audio, just wait 3 seconds then move next\n  36 |                 const timer = setTimeout(() => {\n> 37 |                     handleNext();\n     |                     ^^^^^^^^^^ `handleNext` accessed before it is declared\n  38 |                 }, 3000);\n  39 |                 return () => clearTimeout(timer);\n  40 |             }\n\nC:\\Users\\user\\Desktop\\studioAI\\src\\app\\preview\\page.tsx:63:5\n  61 |     };\n  62 |\n> 63 |     const handleNext = () => {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 64 |         if (currentIndex < scenes.length - 1) {\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 65 |             setCurrentIndex(prev => prev + 1);\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 66 |         } else {\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 67 |             setIsPlaying(false);\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 68 |         }\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 69 |     };\n     | ^^^^^^^ `handleNext` is declared here\n  70 |\n  71 |     const handlePrev = () => {\n  72 |         if (currentIndex > 0) {","line":37,"column":21,"nodeType":null,"endLine":37,"endColumn":31},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'currentScene' and 'handleNext'. Either include them or remove the dependency array.","line":46,"column":8,"nodeType":"ArrayExpression","endLine":46,"endColumn":33,"suggestions":[{"desc":"Update the dependencies array to be: [isPlaying, currentIndex, currentScene, handleNext]","fix":{"range":[1773,1798],"text":"[isPlaying, currentIndex, currentScene, handleNext]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'currentScene?.videoUrl'. Either include it or remove the dependency array.","line":53,"column":8,"nodeType":"ArrayExpression","endLine":53,"endColumn":33,"suggestions":[{"desc":"Update the dependencies array to be: [isPlaying, currentIndex, currentScene?.videoUrl]","fix":{"range":[2090,2115],"text":"[isPlaying, currentIndex, currentScene?.videoUrl]"}}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":126,"column":25,"nodeType":"JSXOpeningElement","endLine":130,"endColumn":27},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":198,"column":33,"nodeType":"JSXOpeningElement","endLine":198,"endColumn":107}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useRef, useEffect } from 'react';\r\nimport { useProjectStore, Scene } from '@/store/useProjectStore';\r\nimport { Play, Pause, SkipBack, SkipForward, RotateCcw, Film } from 'lucide-react';\r\nimport { useRouter } from 'next/navigation';\r\n\r\nexport default function PreviewPage() {\r\n    const { currentProject } = useProjectStore();\r\n    const [currentIndex, setCurrentIndex] = useState(0);\r\n    const [isPlaying, setIsPlaying] = useState(false);\r\n    const audioRef = useRef<HTMLAudioElement | null>(null);\r\n    const videoRef = useRef<HTMLVideoElement | null>(null);\r\n    const router = useRouter();\r\n\r\n    const scenes = currentProject?.scenes || [];\r\n    const currentScene = scenes[currentIndex];\r\n\r\n    // Reset when project changes or on mount\r\n    useEffect(() => {\r\n        setCurrentIndex(0);\r\n        setIsPlaying(false);\r\n    }, [currentProject?.id]);\r\n\r\n    // Handle auto-play sequence\r\n    useEffect(() => {\r\n        if (isPlaying && currentScene) {\r\n            // If scene has audio, play it\r\n            if (currentScene.audioUrl) {\r\n                if (audioRef.current) {\r\n                    audioRef.current.src = currentScene.audioUrl;\r\n                    audioRef.current.play().catch(e => console.error(\"Audio play failed\", e));\r\n                }\r\n            } else {\r\n                // If no audio, just wait 3 seconds then move next\r\n                const timer = setTimeout(() => {\r\n                    handleNext();\r\n                }, 3000);\r\n                return () => clearTimeout(timer);\r\n            }\r\n        } else {\r\n            // Pause media if not playing\r\n            if (audioRef.current) audioRef.current.pause();\r\n            if (videoRef.current) videoRef.current.pause();\r\n        }\r\n    }, [isPlaying, currentIndex]);\r\n\r\n    // Sync video playback with audio if both exist, or just play video if no audio\r\n    useEffect(() => {\r\n        if (isPlaying && currentScene?.videoUrl && videoRef.current) {\r\n            videoRef.current.play().catch(e => console.error(\"Video play failed\", e));\r\n        }\r\n    }, [isPlaying, currentIndex]);\r\n\r\n    const handleAudioEnded = () => {\r\n        if (currentIndex < scenes.length - 1) {\r\n            setCurrentIndex(prev => prev + 1);\r\n        } else {\r\n            setIsPlaying(false); // End of sequence\r\n        }\r\n    };\r\n\r\n    const handleNext = () => {\r\n        if (currentIndex < scenes.length - 1) {\r\n            setCurrentIndex(prev => prev + 1);\r\n        } else {\r\n            setIsPlaying(false);\r\n        }\r\n    };\r\n\r\n    const handlePrev = () => {\r\n        if (currentIndex > 0) {\r\n            setCurrentIndex(prev => prev - 1);\r\n        }\r\n    };\r\n\r\n    const handleRestart = () => {\r\n        setCurrentIndex(0);\r\n        setIsPlaying(true);\r\n    };\r\n\r\n    const togglePlay = () => {\r\n        setIsPlaying(!isPlaying);\r\n    };\r\n\r\n    if (!currentProject) {\r\n        return (\r\n            <div className=\"flex-1 flex flex-col items-center justify-center text-[var(--text-gray)]\">\r\n                <Film className=\"w-12 h-12 mb-4 opacity-50\" />\r\n                <p>No active project to preview.</p>\r\n                <button\r\n                    onClick={() => router.push('/library')}\r\n                    className=\"mt-4 text-[var(--primary-color)] hover:underline\"\r\n                >\r\n                    Go to Library\r\n                </button>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (scenes.length === 0) {\r\n        return (\r\n            <div className=\"flex-1 flex flex-col items-center justify-center text-[var(--text-gray)]\">\r\n                <p>This project has no scenes.</p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"flex-1 flex flex-col h-full bg-[#0f0f16] overflow-hidden\">\r\n            {/* Main Viewer Area */}\r\n            <div className=\"flex-1 flex items-center justify-center p-10 relative\">\r\n                <div className=\"aspect-video w-full max-w-5xl bg-black rounded-xl overflow-hidden relative shadow-2xl border border-[#2a2a35]\">\r\n\r\n                    {/* Media Layer */}\r\n                    {currentScene?.videoUrl ? (\r\n                        <video\r\n                            ref={videoRef}\r\n                            src={currentScene.videoUrl}\r\n                            className=\"w-full h-full object-contain\"\r\n                            loop={!!currentScene.audioUrl} // Loop video if audio is driving duration\r\n                            muted // Mute video audio to prefer TTS audio\r\n                            playsInline\r\n                        />\r\n                    ) : currentScene?.imageUrl ? (\r\n                        <img\r\n                            src={currentScene.imageUrl}\r\n                            alt={`Scene ${currentScene.id}`}\r\n                            className=\"w-full h-full object-contain\"\r\n                        />\r\n                    ) : (\r\n                        <div className=\"w-full h-full flex items-center justify-center bg-[#1a1a24] text-[var(--text-gray)]\">\r\n                            <div className=\"text-center\">\r\n                                <Film className=\"w-12 h-12 mx-auto mb-2 opacity-50\" />\r\n                                <p>No visual asset</p>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Subtitle Overlay */}\r\n                    <div className=\"absolute bottom-8 left-0 right-0 text-center px-10\">\r\n                        <div className=\"inline-block bg-black/60 backdrop-blur-sm px-6 py-3 rounded-lg\">\r\n                            <p className=\"text-white text-lg font-medium leading-relaxed drop-shadow-md\">\r\n                                {currentScene?.text || \"...\"}\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Hidden Audio Player for TTS */}\r\n                    <audio\r\n                        ref={audioRef}\r\n                        onEnded={handleAudioEnded}\r\n                        className=\"hidden\"\r\n                    />\r\n                </div>\r\n            </div>\r\n\r\n            {/* Controls & Timeline */}\r\n            <div className=\"h-48 bg-(--bg-sidebar) border-t border-[#2a2a35] flex flex-col\">\r\n\r\n                {/* Playback Controls */}\r\n                <div className=\"h-14 flex items-center justify-center gap-4 border-b border-[#2a2a35]\">\r\n                    <button onClick={handleRestart} className=\"p-2 text-[var(--text-gray)] hover:text-white transition-colors\" title=\"Restart\">\r\n                        <RotateCcw className=\"w-4 h-4\" />\r\n                    </button>\r\n                    <button onClick={handlePrev} className=\"p-2 text-[var(--text-gray)] hover:text-white transition-colors\" disabled={currentIndex === 0}>\r\n                        <SkipBack className=\"w-5 h-5\" />\r\n                    </button>\r\n                    <button\r\n                        onClick={togglePlay}\r\n                        className=\"w-10 h-10 rounded-full bg-(--primary-color) hover:bg-[#4a4ddb] flex items-center justify-center text-white transition-transform hover:scale-105\"\r\n                    >\r\n                        {isPlaying ? <Pause className=\"w-4 h-4\" /> : <Play className=\"w-4 h-4 ml-0.5\" />}\r\n                    </button>\r\n                    <button onClick={handleNext} className=\"p-2 text-[var(--text-gray)] hover:text-white transition-colors\" disabled={currentIndex === scenes.length - 1}>\r\n                        <SkipForward className=\"w-5 h-5\" />\r\n                    </button>\r\n                    <div className=\"text-xs text-[var(--text-gray)] font-mono ml-4\">\r\n                        Scene {currentIndex + 1} / {scenes.length}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Filmstrip Timeline */}\r\n                <div className=\"flex-1 overflow-x-auto custom-scrollbar p-4 flex gap-3 items-center\">\r\n                    {scenes.map((scene, index) => (\r\n                        <div\r\n                            key={scene.id}\r\n                            onClick={() => {\r\n                                setCurrentIndex(index);\r\n                                setIsPlaying(false);\r\n                            }}\r\n                            className={`relative h-20 aspect-video rounded-md overflow-hidden cursor-pointer border-2 transition-all shrink-0 ${index === currentIndex\r\n                                ? 'border-[var(--primary-color)] ring-2 ring-[var(--primary-color)]/30 scale-105'\r\n                                : 'border-transparent opacity-60 hover:opacity-100'\r\n                                }`}\r\n                        >\r\n                            {scene.imageUrl ? (\r\n                                <img src={scene.imageUrl} alt=\"\" className=\"w-full h-full object-cover\" />\r\n                            ) : (\r\n                                <div className=\"w-full h-full bg-[#2b2b36] flex items-center justify-center text-[0.6rem] text-[var(--text-gray)]\">\r\n                                    #{scene.id}\r\n                                </div>\r\n                            )}\r\n                            <div className=\"absolute bottom-0 left-0 right-0 bg-black/70 text-[0.5rem] text-white px-1 py-0.5 truncate\">\r\n                                {scene.text}\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\app\\prompt-generation\\page.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":200,"column":51,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[10348,10392],"text":"구체적일수록 좋습니다. (단순히 &quot;개\"보다는 \"공원에서 뛰노는 골든 리트리버\")"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[10348,10392],"text":"구체적일수록 좋습니다. (단순히 &ldquo;개\"보다는 \"공원에서 뛰노는 골든 리트리버\")"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[10348,10392],"text":"구체적일수록 좋습니다. (단순히 &#34;개\"보다는 \"공원에서 뛰노는 골든 리트리버\")"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[10348,10392],"text":"구체적일수록 좋습니다. (단순히 &rdquo;개\"보다는 \"공원에서 뛰노는 골든 리트리버\")"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":200,"column":53,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[10348,10392],"text":"구체적일수록 좋습니다. (단순히 \"개&quot;보다는 \"공원에서 뛰노는 골든 리트리버\")"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[10348,10392],"text":"구체적일수록 좋습니다. (단순히 \"개&ldquo;보다는 \"공원에서 뛰노는 골든 리트리버\")"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[10348,10392],"text":"구체적일수록 좋습니다. (단순히 \"개&#34;보다는 \"공원에서 뛰노는 골든 리트리버\")"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[10348,10392],"text":"구체적일수록 좋습니다. (단순히 \"개&rdquo;보다는 \"공원에서 뛰노는 골든 리트리버\")"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":200,"column":58,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[10348,10392],"text":"구체적일수록 좋습니다. (단순히 \"개\"보다는 &quot;공원에서 뛰노는 골든 리트리버\")"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[10348,10392],"text":"구체적일수록 좋습니다. (단순히 \"개\"보다는 &ldquo;공원에서 뛰노는 골든 리트리버\")"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[10348,10392],"text":"구체적일수록 좋습니다. (단순히 \"개\"보다는 &#34;공원에서 뛰노는 골든 리트리버\")"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[10348,10392],"text":"구체적일수록 좋습니다. (단순히 \"개\"보다는 &rdquo;공원에서 뛰노는 골든 리트리버\")"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":200,"column":75,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[10348,10392],"text":"구체적일수록 좋습니다. (단순히 \"개\"보다는 \"공원에서 뛰노는 골든 리트리버&quot;)"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[10348,10392],"text":"구체적일수록 좋습니다. (단순히 \"개\"보다는 \"공원에서 뛰노는 골든 리트리버&ldquo;)"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[10348,10392],"text":"구체적일수록 좋습니다. (단순히 \"개\"보다는 \"공원에서 뛰노는 골든 리트리버&#34;)"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[10348,10392],"text":"구체적일수록 좋습니다. (단순히 \"개\"보다는 \"공원에서 뛰노는 골든 리트리버&rdquo;)"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":201,"column":63,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[10431,10481],"text":"조명과 분위기를 묘사하면 퀄리티가 높아집니다. (예: &quot;따뜻한 햇살\", \"신비로운 안개\")"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[10431,10481],"text":"조명과 분위기를 묘사하면 퀄리티가 높아집니다. (예: &ldquo;따뜻한 햇살\", \"신비로운 안개\")"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[10431,10481],"text":"조명과 분위기를 묘사하면 퀄리티가 높아집니다. (예: &#34;따뜻한 햇살\", \"신비로운 안개\")"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[10431,10481],"text":"조명과 분위기를 묘사하면 퀄리티가 높아집니다. (예: &rdquo;따뜻한 햇살\", \"신비로운 안개\")"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":201,"column":70,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[10431,10481],"text":"조명과 분위기를 묘사하면 퀄리티가 높아집니다. (예: \"따뜻한 햇살&quot;, \"신비로운 안개\")"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[10431,10481],"text":"조명과 분위기를 묘사하면 퀄리티가 높아집니다. (예: \"따뜻한 햇살&ldquo;, \"신비로운 안개\")"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[10431,10481],"text":"조명과 분위기를 묘사하면 퀄리티가 높아집니다. (예: \"따뜻한 햇살&#34;, \"신비로운 안개\")"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[10431,10481],"text":"조명과 분위기를 묘사하면 퀄리티가 높아집니다. (예: \"따뜻한 햇살&rdquo;, \"신비로운 안개\")"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":201,"column":73,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[10431,10481],"text":"조명과 분위기를 묘사하면 퀄리티가 높아집니다. (예: \"따뜻한 햇살\", &quot;신비로운 안개\")"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[10431,10481],"text":"조명과 분위기를 묘사하면 퀄리티가 높아집니다. (예: \"따뜻한 햇살\", &ldquo;신비로운 안개\")"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[10431,10481],"text":"조명과 분위기를 묘사하면 퀄리티가 높아집니다. (예: \"따뜻한 햇살\", &#34;신비로운 안개\")"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[10431,10481],"text":"조명과 분위기를 묘사하면 퀄리티가 높아집니다. (예: \"따뜻한 햇살\", &rdquo;신비로운 안개\")"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":201,"column":81,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[10431,10481],"text":"조명과 분위기를 묘사하면 퀄리티가 높아집니다. (예: \"따뜻한 햇살\", \"신비로운 안개&quot;)"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[10431,10481],"text":"조명과 분위기를 묘사하면 퀄리티가 높아집니다. (예: \"따뜻한 햇살\", \"신비로운 안개&ldquo;)"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[10431,10481],"text":"조명과 분위기를 묘사하면 퀄리티가 높아집니다. (예: \"따뜻한 햇살\", \"신비로운 안개&#34;)"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[10431,10481],"text":"조명과 분위기를 묘사하면 퀄리티가 높아집니다. (예: \"따뜻한 햇살\", \"신비로운 안개&rdquo;)"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":202,"column":53,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[10520,10567],"text":"원하는 스타일을 명시하세요. (예: &quot;수채화 풍\", \"3D 렌더링\", \"픽셀 아트\")"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[10520,10567],"text":"원하는 스타일을 명시하세요. (예: &ldquo;수채화 풍\", \"3D 렌더링\", \"픽셀 아트\")"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[10520,10567],"text":"원하는 스타일을 명시하세요. (예: &#34;수채화 풍\", \"3D 렌더링\", \"픽셀 아트\")"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[10520,10567],"text":"원하는 스타일을 명시하세요. (예: &rdquo;수채화 풍\", \"3D 렌더링\", \"픽셀 아트\")"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":202,"column":59,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[10520,10567],"text":"원하는 스타일을 명시하세요. (예: \"수채화 풍&quot;, \"3D 렌더링\", \"픽셀 아트\")"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[10520,10567],"text":"원하는 스타일을 명시하세요. (예: \"수채화 풍&ldquo;, \"3D 렌더링\", \"픽셀 아트\")"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[10520,10567],"text":"원하는 스타일을 명시하세요. (예: \"수채화 풍&#34;, \"3D 렌더링\", \"픽셀 아트\")"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[10520,10567],"text":"원하는 스타일을 명시하세요. (예: \"수채화 풍&rdquo;, \"3D 렌더링\", \"픽셀 아트\")"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":202,"column":62,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[10520,10567],"text":"원하는 스타일을 명시하세요. (예: \"수채화 풍\", &quot;3D 렌더링\", \"픽셀 아트\")"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[10520,10567],"text":"원하는 스타일을 명시하세요. (예: \"수채화 풍\", &ldquo;3D 렌더링\", \"픽셀 아트\")"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[10520,10567],"text":"원하는 스타일을 명시하세요. (예: \"수채화 풍\", &#34;3D 렌더링\", \"픽셀 아트\")"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[10520,10567],"text":"원하는 스타일을 명시하세요. (예: \"수채화 풍\", &rdquo;3D 렌더링\", \"픽셀 아트\")"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":202,"column":69,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[10520,10567],"text":"원하는 스타일을 명시하세요. (예: \"수채화 풍\", \"3D 렌더링&quot;, \"픽셀 아트\")"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[10520,10567],"text":"원하는 스타일을 명시하세요. (예: \"수채화 풍\", \"3D 렌더링&ldquo;, \"픽셀 아트\")"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[10520,10567],"text":"원하는 스타일을 명시하세요. (예: \"수채화 풍\", \"3D 렌더링&#34;, \"픽셀 아트\")"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[10520,10567],"text":"원하는 스타일을 명시하세요. (예: \"수채화 풍\", \"3D 렌더링&rdquo;, \"픽셀 아트\")"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":202,"column":72,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[10520,10567],"text":"원하는 스타일을 명시하세요. (예: \"수채화 풍\", \"3D 렌더링\", &quot;픽셀 아트\")"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[10520,10567],"text":"원하는 스타일을 명시하세요. (예: \"수채화 풍\", \"3D 렌더링\", &ldquo;픽셀 아트\")"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[10520,10567],"text":"원하는 스타일을 명시하세요. (예: \"수채화 풍\", \"3D 렌더링\", &#34;픽셀 아트\")"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[10520,10567],"text":"원하는 스타일을 명시하세요. (예: \"수채화 풍\", \"3D 렌더링\", &rdquo;픽셀 아트\")"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":202,"column":78,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[10520,10567],"text":"원하는 스타일을 명시하세요. (예: \"수채화 풍\", \"3D 렌더링\", \"픽셀 아트&quot;)"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[10520,10567],"text":"원하는 스타일을 명시하세요. (예: \"수채화 풍\", \"3D 렌더링\", \"픽셀 아트&ldquo;)"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[10520,10567],"text":"원하는 스타일을 명시하세요. (예: \"수채화 풍\", \"3D 렌더링\", \"픽셀 아트&#34;)"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[10520,10567],"text":"원하는 스타일을 명시하세요. (예: \"수채화 풍\", \"3D 렌더링\", \"픽셀 아트&rdquo;)"},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":14,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport { Button } from \"@/components/ui/Button\"\r\nimport { Input, Textarea } from \"@/components/ui/Input\"\r\nimport { Card, CardContent } from \"@/components/ui/Card\"\r\nimport { MessageSquarePlus, Copy, Check, Sparkles, RefreshCw } from \"lucide-react\"\r\n\r\ninterface PromptTemplate {\r\n    id: string;\r\n    name: string;\r\n    description: string;\r\n    fields: {\r\n        key: string;\r\n        label: string;\r\n        placeholder: string;\r\n    }[];\r\n    generate: (values: { [key: string]: string }) => string;\r\n}\r\n\r\nconst TEMPLATES: PromptTemplate[] = [\r\n    {\r\n        id: 'cinematic',\r\n        name: '시네마틱 영화 장면',\r\n        description: '영화 같은 고품질 이미지 생성을 위한 프롬프트',\r\n        fields: [\r\n            { key: 'subject', label: '주제/피사체', placeholder: '예: 사이버펑크 거리의 탐정' },\r\n            { key: 'lighting', label: '조명', placeholder: '예: 네온 사인, 비 오는 밤의 가로등' },\r\n            { key: 'camera', label: '카메라 앵글', placeholder: '예: 로우 앵글, 광각 렌즈' },\r\n            { key: 'mood', label: '분위기', placeholder: '예: 미스터리, 긴장감' }\r\n        ],\r\n        generate: (v) => `Cinematic shot of ${v.subject}, ${v.lighting} lighting, ${v.camera}, ${v.mood} atmosphere, 8k resolution, highly detailed, photorealistic, movie still.`\r\n    },\r\n    {\r\n        id: 'anime',\r\n        name: '애니메이션 스타일',\r\n        description: '일본 애니메이션 스타일의 캐릭터나 배경',\r\n        fields: [\r\n            { key: 'character', label: '캐릭터 설명', placeholder: '예: 은발의 마법사 소녀' },\r\n            { key: 'action', label: '행동/포즈', placeholder: '예: 마법을 시전하는, 하늘을 나는' },\r\n            { key: 'background', label: '배경', placeholder: '예: 마법 학교 교실' },\r\n            { key: 'style', label: '화풍', placeholder: '예: 지브리 스타일, 신카이 마코토 스타일' }\r\n        ],\r\n        generate: (v) => `Anime style illustration of ${v.character}, ${v.action}, ${v.background} background, ${v.style}, vibrant colors, high quality, detailed.`\r\n    },\r\n    {\r\n        id: 'product',\r\n        name: '제품 사진',\r\n        description: '광고용 고퀄리티 제품 사진',\r\n        fields: [\r\n            { key: 'product', label: '제품명/설명', placeholder: '예: 고급 가죽 시계' },\r\n            { key: 'setting', label: '배경/세팅', placeholder: '예: 대리석 테이블 위' },\r\n            { key: 'lighting', label: '조명', placeholder: '예: 스튜디오 조명, 부드러운 그림자' }\r\n        ],\r\n        generate: (v) => `Professional product photography of ${v.product}, placed on ${v.setting}, ${v.lighting}, 4k, sharp focus, commercial quality, elegant. ${v.remarks ? `Note: ${v.remarks}` : ''}`\r\n    }\r\n];\r\n\r\n// Add 'remarks' field to all templates dynamically or manually\r\nTEMPLATES.forEach(t => {\r\n    t.fields.push({ key: 'remarks', label: '비고 (추가 요청사항)', placeholder: '추가적으로 원하는 내용을 자유롭게 적어주세요...' });\r\n});\r\n\r\nexport default function PromptGenerationPage() {\r\n    const [selectedTemplateId, setSelectedTemplateId] = React.useState(TEMPLATES[0].id);\r\n    const [fieldValues, setFieldValues] = React.useState<{ [key: string]: string }>({});\r\n    const [generatedPrompt, setGeneratedPrompt] = React.useState(\"\");\r\n    const [isCopied, setIsCopied] = React.useState(false);\r\n\r\n    const selectedTemplate = TEMPLATES.find(t => t.id === selectedTemplateId) || TEMPLATES[0];\r\n\r\n    const handleFieldChange = (key: string, value: string) => {\r\n        setFieldValues(prev => ({ ...prev, [key]: value }));\r\n    };\r\n\r\n    const handleGenerate = () => {\r\n        const prompt = selectedTemplate.generate(fieldValues);\r\n        setGeneratedPrompt(prompt);\r\n        setIsCopied(false);\r\n    };\r\n\r\n    const handleCopy = () => {\r\n        navigator.clipboard.writeText(generatedPrompt);\r\n        setIsCopied(true);\r\n        setTimeout(() => setIsCopied(false), 2000);\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex h-full gap-6 p-6\">\r\n            {/* Left Panel - Controls */}\r\n            <div className=\"w-[400px] shrink-0 flex flex-col gap-6 overflow-y-auto pr-2\">\r\n                <div>\r\n                    <h1 className=\"text-2xl font-bold text-white mb-2\">프롬프트 생성기</h1>\r\n                    <p className=\"text-sm text-muted\">템플릿을 사용하여 완벽한 프롬프트를 만드세요.</p>\r\n                </div>\r\n\r\n                <div className=\"space-y-6\">\r\n                    {/* Template Selection */}\r\n                    <div className=\"space-y-2\">\r\n                        <label className=\"text-sm font-medium text-gray-300\">템플릿 선택</label>\r\n                        <div className=\"grid grid-cols-1 gap-2\">\r\n                            {TEMPLATES.map(template => (\r\n                                <button\r\n                                    key={template.id}\r\n                                    onClick={() => {\r\n                                        setSelectedTemplateId(template.id);\r\n                                        setFieldValues({});\r\n                                        setGeneratedPrompt(\"\");\r\n                                    }}\r\n                                    className={`flex flex-col items-start p-3 rounded-lg border transition-all ${selectedTemplateId === template.id\r\n                                        ? 'bg-primary/10 border-primary text-white'\r\n                                        : 'bg-[#262633] border-[#2a2a35] text-gray-400 hover:border-gray-500'\r\n                                        }`}\r\n                                >\r\n                                    <span className=\"font-medium text-sm\">{template.name}</span>\r\n                                    <span className=\"text-xs opacity-70\">{template.description}</span>\r\n                                </button>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Dynamic Fields */}\r\n                    <div className=\"space-y-4 p-4 bg-[#15151e] rounded-lg border border-[#2a2a35]\">\r\n                        <h3 className=\"text-sm font-semibold text-white mb-2\">{selectedTemplate.name} 설정</h3>\r\n                        {selectedTemplate.fields.map(field => (\r\n                            <div key={field.key} className=\"space-y-1.5\">\r\n                                <label className=\"text-xs font-medium text-gray-400\">{field.label}</label>\r\n                                {field.key === 'custom_prompt' || field.key === 'remarks' ? (\r\n                                    <Textarea\r\n                                        placeholder={field.placeholder}\r\n                                        value={fieldValues[field.key] || ''}\r\n                                        onChange={(e) => handleFieldChange(field.key, e.target.value)}\r\n                                        className=\"h-24 text-sm resize-none\"\r\n                                    />\r\n                                ) : (\r\n                                    <Input\r\n                                        placeholder={field.placeholder}\r\n                                        value={fieldValues[field.key] || ''}\r\n                                        onChange={(e) => handleFieldChange(field.key, e.target.value)}\r\n                                        className=\"h-9 text-sm\"\r\n                                    />\r\n                                )}\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n\r\n                    {/* Generate Button */}\r\n                    <Button\r\n                        className=\"w-full h-12 text-lg font-semibold shadow-blue-500/20\"\r\n                        size=\"lg\"\r\n                        onClick={handleGenerate}\r\n                    >\r\n                        <Sparkles className=\"w-5 h-5 mr-2\" />\r\n                        프롬프트 생성\r\n                    </Button>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Right Panel - Result */}\r\n            <div className=\"flex-1 flex flex-col min-w-0\">\r\n                <div className=\"flex items-center justify-between mb-6\">\r\n                    <h2 className=\"text-xl font-semibold text-white\">생성 결과</h2>\r\n                </div>\r\n\r\n                <div className=\"flex-1 flex flex-col gap-4\">\r\n                    <Card className=\"flex-1 bg-[#15151e] border-[#2a2a35]\">\r\n                        <CardContent className=\"p-6 h-full flex flex-col\">\r\n                            {generatedPrompt ? (\r\n                                <>\r\n                                    <div className=\"flex-1\">\r\n                                        <label className=\"text-sm font-medium text-gray-400 mb-2 block\">English Prompt (Optimized)</label>\r\n                                        <div className=\"p-4 bg-[#262633] rounded-lg border border-[#2a2a35] text-white text-lg leading-relaxed min-h-[200px]\">\r\n                                            {generatedPrompt}\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"mt-6 flex justify-end gap-3\">\r\n                                        <Button variant=\"outline\" onClick={handleGenerate}>\r\n                                            <RefreshCw className=\"w-4 h-4 mr-2\" />\r\n                                            다시 생성\r\n                                        </Button>\r\n                                        <Button onClick={handleCopy} className={isCopied ? \"bg-green-600 hover:bg-green-700\" : \"\"}>\r\n                                            {isCopied ? <Check className=\"w-4 h-4 mr-2\" /> : <Copy className=\"w-4 h-4 mr-2\" />}\r\n                                            {isCopied ? \"복사됨\" : \"프롬프트 복사\"}\r\n                                        </Button>\r\n                                    </div>\r\n                                </>\r\n                            ) : (\r\n                                <div className=\"h-full flex flex-col items-center justify-center text-muted opacity-50\">\r\n                                    <MessageSquarePlus className=\"w-16 h-16 mb-4\" />\r\n                                    <p>왼쪽에서 설정을 입력하고 프롬프트를 생성하세요</p>\r\n                                </div>\r\n                            )}\r\n                        </CardContent>\r\n                    </Card>\r\n\r\n                    {/* Tips Section */}\r\n                    <div className=\"bg-blue-500/10 border border-blue-500/20 rounded-lg p-4\">\r\n                        <h4 className=\"text-sm font-semibold text-blue-400 mb-2\">💡 프롬프트 작성 팁</h4>\r\n                        <ul className=\"text-xs text-gray-300 space-y-1 list-disc list-inside\">\r\n                            <li>구체적일수록 좋습니다. (단순히 \"개\"보다는 \"공원에서 뛰노는 골든 리트리버\")</li>\r\n                            <li>조명과 분위기를 묘사하면 퀄리티가 높아집니다. (예: \"따뜻한 햇살\", \"신비로운 안개\")</li>\r\n                            <li>원하는 스타일을 명시하세요. (예: \"수채화 풍\", \"3D 렌더링\", \"픽셀 아트\")</li>\r\n                        </ul>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\app\\script\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\app\\sfx-generation\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\app\\video-generation\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Input' is defined but never used.","line":5,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardContent' is defined but never used.","line":6,"column":16,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":27},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":129,"column":29,"nodeType":"JSXOpeningElement","endLine":129,"endColumn":176},{"ruleId":"jsx-a11y/alt-text","severity":1,"message":"img elements must have an alt prop, either with meaningful text, or an empty string for decorative images.","line":129,"column":29,"nodeType":"JSXOpeningElement","endLine":129,"endColumn":176}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport { Button } from \"@/components/ui/Button\"\r\nimport { Input, Textarea } from \"@/components/ui/Input\"\r\nimport { Card, CardContent } from \"@/components/ui/Card\"\r\nimport { Tabs, TabsList, TabsTrigger, TabsContent } from \"@/components/ui/Tabs\"\r\nimport { Video, Upload, Play, Film, Clock, Zap } from \"lucide-react\"\r\n\r\nexport default function VideoGenerationPage() {\r\n    return (\r\n        <div className=\"flex h-full gap-6 p-6\">\r\n            {/* Left Panel - Controls */}\r\n            <div className=\"w-[400px] flex-shrink-0 flex flex-col gap-6 overflow-y-auto pr-2\">\r\n                <div>\r\n                    <h1 className=\"text-2xl font-bold text-white mb-2\">AI 비디오 생성기</h1>\r\n                    <p className=\"text-sm text-muted\">이미지에 생명을 불어넣어 동영상으로 만드세요.</p>\r\n                </div>\r\n\r\n                <Tabs defaultValue=\"image-to-video\" className=\"w-full\">\r\n                    <TabsList className=\"w-full grid grid-cols-2 mb-4\">\r\n                        <TabsTrigger value=\"image-to-video\">이미지를 동영상으로</TabsTrigger>\r\n                        <TabsTrigger value=\"text-to-video\">텍스트를 동영상으로</TabsTrigger>\r\n                    </TabsList>\r\n\r\n                    <TabsContent value=\"image-to-video\" className=\"space-y-6\">\r\n                        {/* Image Upload Area */}\r\n                        <div className=\"grid grid-cols-2 gap-4\">\r\n                            <Card className=\"border-dashed border-2 border-border bg-transparent hover:bg-white/5 transition-colors cursor-pointer aspect-video flex items-center justify-center\">\r\n                                <div className=\"text-center p-4\">\r\n                                    <Upload className=\"w-6 h-6 text-muted mx-auto mb-2\" />\r\n                                    <span className=\"text-xs text-muted\">시작 이미지</span>\r\n                                </div>\r\n                            </Card>\r\n                            <Card className=\"border-dashed border-2 border-border bg-transparent hover:bg-white/5 transition-colors cursor-pointer aspect-video flex items-center justify-center opacity-50 hover:opacity-100\">\r\n                                <div className=\"text-center p-4\">\r\n                                    <Upload className=\"w-6 h-6 text-muted mx-auto mb-2\" />\r\n                                    <span className=\"text-xs text-muted\">최종 프레임 (선택)</span>\r\n                                </div>\r\n                            </Card>\r\n                        </div>\r\n\r\n                        {/* Prompt Input */}\r\n                        <div className=\"space-y-2\">\r\n                            <label className=\"text-sm font-medium text-gray-300\">모션 설명</label>\r\n                            <Textarea\r\n                                placeholder=\"이미지가 어떻게 움직여야 하는지 설명하세요... (예: 카메라가 천천히 줌인하면서 깃발이 펄럭임)\"\r\n                                className=\"h-24 resize-none\"\r\n                            />\r\n                        </div>\r\n\r\n                        {/* Settings */}\r\n                        <div className=\"space-y-4\">\r\n                            <div className=\"space-y-2\">\r\n                                <label className=\"text-sm font-medium text-gray-300\">품질 설정</label>\r\n                                <div className=\"grid grid-cols-2 gap-2\">\r\n                                    <Button variant=\"outline\" className=\"justify-start gap-2 h-auto py-2 border-primary bg-primary/10 text-white\">\r\n                                        <Zap className=\"w-4 h-4 text-primary\" />\r\n                                        <div className=\"text-left\">\r\n                                            <div className=\"text-sm font-medium\">빠르게 V2.0</div>\r\n                                        </div>\r\n                                    </Button>\r\n                                    <Button variant=\"outline\" className=\"justify-start gap-2 h-auto py-2\">\r\n                                        <Film className=\"w-4 h-4\" />\r\n                                        <div className=\"text-left\">\r\n                                            <div className=\"text-sm font-medium\">고품질 V1.0</div>\r\n                                        </div>\r\n                                    </Button>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"grid grid-cols-2 gap-4\">\r\n                                <div className=\"space-y-2\">\r\n                                    <label className=\"text-sm font-medium text-gray-300\">해상도</label>\r\n                                    <select className=\"w-full h-10 rounded-lg border border-border bg-input px-3 text-sm text-white focus:outline-none focus:ring-2 focus:ring-primary\">\r\n                                        <option>720p</option>\r\n                                        <option>1080p</option>\r\n                                    </select>\r\n                                </div>\r\n                                <div className=\"space-y-2\">\r\n                                    <label className=\"text-sm font-medium text-gray-300\">길이</label>\r\n                                    <select className=\"w-full h-10 rounded-lg border border-border bg-input px-3 text-sm text-white focus:outline-none focus:ring-2 focus:ring-primary\">\r\n                                        <option>5초</option>\r\n                                        <option>10초</option>\r\n                                    </select>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Generate Button */}\r\n                        <Button className=\"w-full h-12 text-lg font-semibold shadow-blue-500/20\" size=\"lg\">\r\n                            <Video className=\"w-5 h-5 mr-2\" />\r\n                            비디오 생성하기\r\n                        </Button>\r\n                    </TabsContent>\r\n\r\n                    <TabsContent value=\"text-to-video\" className=\"space-y-6\">\r\n                        <div className=\"space-y-2\">\r\n                            <label className=\"text-sm font-medium text-gray-300\">비디오 프롬프트</label>\r\n                            <Textarea\r\n                                placeholder=\"생성하고 싶은 비디오 장면을 묘사하세요...\"\r\n                                className=\"h-32 resize-none\"\r\n                            />\r\n                        </div>\r\n                        <Button className=\"w-full h-12 text-lg font-semibold\" size=\"lg\">\r\n                            <Video className=\"w-5 h-5 mr-2\" />\r\n                            비디오 생성하기\r\n                        </Button>\r\n                    </TabsContent>\r\n                </Tabs>\r\n            </div>\r\n\r\n            {/* Right Panel - Preview Player */}\r\n            <div className=\"flex-1 flex flex-col min-w-0 bg-black/40 rounded-xl border border-border overflow-hidden\">\r\n                {/* Main Preview Area */}\r\n                <div className=\"flex-1 flex items-center justify-center bg-[#0a0a0a] relative group\">\r\n                    <div className=\"text-center space-y-4\">\r\n                        <div className=\"w-16 h-16 rounded-full bg-white/5 flex items-center justify-center mx-auto group-hover:bg-primary/20 transition-colors cursor-pointer\">\r\n                            <Play className=\"w-8 h-8 text-white ml-1\" />\r\n                        </div>\r\n                        <p className=\"text-muted text-sm\">생성된 비디오가 여기에 재생됩니다</p>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* History Strip */}\r\n                <div className=\"h-32 border-t border-border bg-[#15151e] p-4 flex gap-4 overflow-x-auto\">\r\n                    {[1, 2, 3].map((i) => (\r\n                        <div key={i} className=\"flex-shrink-0 aspect-video rounded-lg bg-gray-800 relative overflow-hidden border border-transparent hover:border-primary cursor-pointer\">\r\n                            <img src={`https://picsum.photos/seed/${i + 10}/300/169`} className=\"w-full h-full object-cover opacity-60 hover:opacity-100 transition-opacity\" />\r\n                            <div className=\"absolute bottom-1 right-1 bg-black/60 px-1.5 py-0.5 rounded text-[10px] text-white flex items-center gap-1\">\r\n                                <Clock className=\"w-3 h-3\" /> 00:05\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\app\\video\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'endSceneId' is assigned a value but never used.","line":28,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":28,"endColumn":22},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The 'scenes' logical expression could make the dependencies of useEffect Hook (at line 71) change on every render. Move it inside the useEffect callback. Alternatively, wrap the initialization of 'scenes' in its own useMemo() Hook.","line":44,"column":11,"nodeType":"VariableDeclarator","endLine":44,"endColumn":48},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'addAsset', 'currentProject?.title', and 'settings.model'. Either include them or remove the dependency array.","line":139,"column":8,"nodeType":"ArrayExpression","endLine":139,"endColumn":141,"suggestions":[{"desc":"Update the dependencies array to be: [taskId, generatedVideo, singleSceneId, startSceneId, settings.videoType, updateScene, saveCurrentProject, updateProjectInfo, kieKey, settings.model, addAsset, currentProject?.title]","fix":{"range":[5846,5979],"text":"[taskId, generatedVideo, singleSceneId, startSceneId, settings.videoType, updateScene, saveCurrentProject, updateProjectInfo, kieKey, settings.model, addAsset, currentProject?.title]"}}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":300,"column":41,"nodeType":"JSXOpeningElement","endLine":300,"endColumn":121},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":328,"column":41,"nodeType":"JSXOpeningElement","endLine":328,"endColumn":120},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":357,"column":49,"nodeType":"JSXOpeningElement","endLine":357,"endColumn":132},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":385,"column":49,"nodeType":"JSXOpeningElement","endLine":385,"endColumn":128},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":418,"column":45,"nodeType":"JSXOpeningElement","endLine":418,"endColumn":125}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { PlayCircle, Upload, Wand2, RefreshCw, Image as ImageIcon, Check } from 'lucide-react';\r\nimport { useEffect, useState } from 'react';\r\nimport dynamic from 'next/dynamic';\r\n\r\nconst VideoResultModal = dynamic(() => import('@/components/video/VideoResultModal').then(mod => mod.VideoResultModal), { ssr: false });\r\nimport { useProjectStore } from '@/store/useProjectStore';\r\nimport { VideoSettings, VideoSettingsState } from '@/components/video/VideoSettings';\r\nimport toast, { Toaster } from 'react-hot-toast';\r\nimport { useSettingsStore } from '@/store/useSettingsStore';\r\nimport { MagicPromptButton } from '@/components/common/MagicPromptButton';\r\n\r\nimport { Suspense } from 'react';\r\nimport { useSearchParams } from 'next/navigation';\r\n\r\nfunction VideoPageContent() {\r\n    const searchParams = useSearchParams();\r\n\r\n    // Image-to-Video 상태\r\n    const [singleImage, setSingleImage] = useState<string | null>(null);\r\n    const [singleSceneId, setSingleSceneId] = useState<number | null>(null);\r\n\r\n    // Start-End Frame 상태\r\n    const [startImage, setStartImage] = useState<string | null>(null);\r\n    const [endImage, setEndImage] = useState<string | null>(null);\r\n    const [startSceneId, setStartSceneId] = useState<number | null>(null);\r\n    const [endSceneId, setEndSceneId] = useState<number | null>(null);\r\n\r\n    const [prompt, setPrompt] = useState('');\r\n    const [generatedVideo, setGeneratedVideo] = useState<string | null>(null);\r\n    const [taskId, setTaskId] = useState<string | null>(null);\r\n\r\n    const [settings, setSettings] = useState<VideoSettingsState>({\r\n        videoType: 'image-to-video',\r\n        model: 'grok',\r\n        mode: 'normal',\r\n        duration: '5',\r\n        resolution: '720p'\r\n    });\r\n\r\n    const { currentProject, updateScene, saveCurrentProject, updateProjectInfo, addAsset } = useProjectStore();\r\n    const { kieKey, openaiKey } = useSettingsStore();\r\n    const scenes = currentProject?.scenes || [];\r\n\r\n    // Handle query params for library integration\r\n    useEffect(() => {\r\n        const sourceImageParam = searchParams.get('sourceImage');\r\n        const sceneIdParam = searchParams.get('sceneId');\r\n\r\n        if (sourceImageParam) {\r\n            setSingleImage(sourceImageParam);\r\n            if (sceneIdParam) {\r\n                setSingleSceneId(parseInt(sceneIdParam));\r\n            }\r\n            // Ensure we are in image-to-video mode\r\n            setSettings(prev => ({ ...prev, videoType: 'image-to-video' }));\r\n        }\r\n    }, [searchParams]);\r\n\r\n    // Auto-select first available image if none selected (Image-to-Video only)\r\n    useEffect(() => {\r\n        // Only auto-select if NOT set by query param (checked above) and empty\r\n        if (settings.videoType === 'image-to-video' && !singleImage && scenes.length > 0 && !searchParams.get('sourceImage')) {\r\n            const firstImageScene = scenes.find(s => s.imageUrl);\r\n            if (firstImageScene) {\r\n                setSingleImage(firstImageScene.imageUrl!);\r\n                setSingleSceneId(firstImageScene.id);\r\n            }\r\n        }\r\n    }, [scenes, singleImage, settings.videoType, searchParams]);\r\n\r\n    // Polling for video generation status\r\n    useEffect(() => {\r\n        let isMounted = true;\r\n        let timeoutId: NodeJS.Timeout;\r\n\r\n        const checkStatus = async (currentInterval: number) => {\r\n            if (!taskId || generatedVideo) return;\r\n\r\n            try {\r\n                const res = await fetch(`/api/video/status?taskId=${taskId}`, {\r\n                    headers: {\r\n                        'x-kie-key': kieKey || ''\r\n                    }\r\n                });\r\n                const data = await res.json();\r\n\r\n                if (!isMounted) return;\r\n\r\n                if (data.status === 'completed') {\r\n                    setGeneratedVideo(data.videoUrl);\r\n                    setTaskId(null);\r\n\r\n                    // Auto-save logic\r\n                    if (settings.videoType === 'image-to-video' && singleSceneId) {\r\n                        updateScene(singleSceneId, { videoUrl: data.videoUrl });\r\n                    } else if (settings.videoType === 'start-end-frame' && startSceneId) {\r\n                        updateScene(startSceneId, { videoUrl: data.videoUrl });\r\n                    }\r\n                    updateProjectInfo({ type: 'video', thumbnail: data.videoUrl });\r\n\r\n                    // Auto-save to library\r\n                    addAsset({\r\n                        type: 'video',\r\n                        title: `${currentProject?.title || 'Project'} - Video`,\r\n                        url: data.videoUrl,\r\n                        tag: settings.model,\r\n                        sceneNumber: singleSceneId || startSceneId || undefined\r\n                    });\r\n\r\n                    saveCurrentProject();\r\n                    toast.success('비디오가 생성되어 저장되었습니다!');\r\n                } else if (data.status === 'failed') {\r\n                    toast.error(`비디오 생성 실패: ${data.error}`);\r\n                    setTaskId(null);\r\n                } else {\r\n                    // Still pending, schedule next check\r\n                    // Adaptive: increase interval up to 5s\r\n                    const nextInterval = Math.min(currentInterval + 500, 5000);\r\n                    timeoutId = setTimeout(() => checkStatus(nextInterval), nextInterval);\r\n                }\r\n            } catch (error) {\r\n                console.error('Polling error:', error);\r\n                // Retry on error with max interval\r\n                timeoutId = setTimeout(() => checkStatus(5000), 5000);\r\n            }\r\n        };\r\n\r\n        if (taskId && !generatedVideo) {\r\n            // Start with fast polling\r\n            checkStatus(1000);\r\n        }\r\n\r\n        return () => {\r\n            isMounted = false;\r\n            clearTimeout(timeoutId);\r\n        };\r\n    }, [taskId, generatedVideo, singleSceneId, startSceneId, settings.videoType, updateScene, saveCurrentProject, updateProjectInfo, kieKey]);\r\n\r\n    const handleGenerateVideo = async () => {\r\n        // Validation\r\n        if (settings.videoType === 'image-to-video' && !singleImage) {\r\n            toast.error('이미지를 선택해주세요');\r\n            return;\r\n        }\r\n        if (settings.videoType === 'start-end-frame' && (!startImage || !endImage)) {\r\n            toast.error('시작 프레임과 종료 프레임을 모두 선택해주세요');\r\n            return;\r\n        }\r\n\r\n        if (!kieKey || !openaiKey) {\r\n            toast.error('설정에서 KIE 및 OpenAI API 키를 먼저 입력해주세요.');\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const requestBody = settings.videoType === 'image-to-video'\r\n                ? {\r\n                    imageUrl: singleImage,\r\n                    prompt: prompt,\r\n                    ...settings\r\n                }\r\n                : {\r\n                    startImageUrl: startImage,\r\n                    endImageUrl: endImage,\r\n                    prompt: prompt,\r\n                    ...settings\r\n                };\r\n\r\n            const response = await fetch('/api/video/generate', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                    'x-kie-key': kieKey,\r\n                    'x-openai-key': openaiKey\r\n                },\r\n                body: JSON.stringify(requestBody),\r\n            });\r\n\r\n            if (!response.ok) {\r\n                const errorData = await response.json();\r\n                throw new Error(errorData.details || '생성 실패');\r\n            }\r\n\r\n            const data = await response.json();\r\n            setTaskId(data.taskId);\r\n            toast.success('비디오 생성이 시작되었습니다...');\r\n        } catch (error) {\r\n            console.error('Video generation error:', error);\r\n            toast.error(`생성 시작 실패: ${error instanceof Error ? error.message : '알 수 없는 오류'}`);\r\n        }\r\n    };\r\n\r\n    const handleImageUpload = async (e: React.ChangeEvent<HTMLInputElement>, target: 'single' | 'start' | 'end') => {\r\n        const file = e.target.files?.[0];\r\n        if (file) {\r\n            if (!file.type.startsWith('image/')) {\r\n                toast.error('이미지 파일만 업로드 가능합니다.');\r\n                return;\r\n            }\r\n            const url = URL.createObjectURL(file);\r\n\r\n            // Auto-save uploaded image to assets\r\n            if (currentProject) {\r\n                try {\r\n                    // In a real app, we would upload the file to storage here and get a permanent URL.\r\n                    // For now, we'll use the blob URL but note that it won't persist across reloads unless we handle file upload properly.\r\n                    // Assuming we want to simulate persistence or use a base64/blob for now.\r\n                    // Ideally, we should use the uploadAssetFromUrl or similar utility if available, or just add it as a local asset.\r\n                    // Since we don't have the file upload logic fully exposed here, we will add it to assets with the blob URL for the session.\r\n                    // To make it truly permanent, we'd need to upload to Supabase storage.\r\n\r\n                    await addAsset({\r\n                        type: 'image',\r\n                        title: file.name,\r\n                        url: url,\r\n                        tag: 'upload',\r\n                        sceneNumber: 0\r\n                    });\r\n                    saveCurrentProject();\r\n                } catch (error) {\r\n                    console.error('Failed to save uploaded image to assets:', error);\r\n                }\r\n            }\r\n\r\n            if (target === 'single') {\r\n                setSingleImage(url);\r\n                setSingleSceneId(null);\r\n            } else if (target === 'start') {\r\n                setStartImage(url);\r\n                setStartSceneId(null);\r\n            } else {\r\n                setEndImage(url);\r\n                setEndSceneId(null);\r\n            }\r\n        }\r\n    };\r\n\r\n    // 드래그 앤 드롭 핸들러\r\n    const handleDrop = (e: React.DragEvent, target: 'single' | 'start' | 'end') => {\r\n        e.preventDefault();\r\n        const imageUrl = e.dataTransfer.getData('imageUrl');\r\n        const sceneId = e.dataTransfer.getData('sceneId');\r\n\r\n        if (imageUrl) {\r\n            if (target === 'single') {\r\n                setSingleImage(imageUrl);\r\n                setSingleSceneId(sceneId ? parseInt(sceneId) : null);\r\n            } else if (target === 'start') {\r\n                setStartImage(imageUrl);\r\n                setStartSceneId(sceneId ? parseInt(sceneId) : null);\r\n            } else {\r\n                setEndImage(imageUrl);\r\n                setEndSceneId(sceneId ? parseInt(sceneId) : null);\r\n            }\r\n        }\r\n    };\r\n\r\n    const handleDragOver = (e: React.DragEvent) => {\r\n        e.preventDefault();\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex-1 p-[30px_40px] flex flex-col gap-5 overflow-y-auto custom-scrollbar\">\r\n            <Toaster position=\"top-center\" />\r\n\r\n            <header className=\"flex items-center gap-2.5 mb-2.5\">\r\n                <PlayCircle className=\"w-5 h-5 text-white\" />\r\n                <h2 className=\"text-[1.2rem] font-semibold\">비디오</h2>\r\n            </header>\r\n\r\n            <div className=\"grid grid-cols-3 gap-5 h-full\">\r\n                {/* Left Column: Image Source & Prompt */}\r\n                <section className=\"col-span-2 flex flex-col gap-5\">\r\n                    {settings.videoType === 'image-to-video' ? (\r\n                        /* Image-to-Video UI */\r\n                        <div className=\"bg-(--bg-card) rounded-xl p-5 border border-(--border-color) flex-1 flex flex-col\">\r\n                            <h3 className=\"text-[0.9rem] font-semibold mb-[15px]\">소스 이미지 선택</h3>\r\n\r\n                            {/* Scene Images Grid */}\r\n                            <div className=\"grid grid-cols-4 gap-3 mb-5\">\r\n                                {currentProject?.assets.filter(a => a.type === 'image').map(asset => (\r\n                                    <div\r\n                                        key={asset.id}\r\n                                        onClick={() => {\r\n                                            setSingleImage(asset.url);\r\n                                            setSingleSceneId(asset.sceneNumber || null);\r\n                                        }}\r\n                                        draggable\r\n                                        onDragStart={(e) => {\r\n                                            e.dataTransfer.setData('imageUrl', asset.url);\r\n                                            e.dataTransfer.setData('sceneId', asset.sceneNumber?.toString() || '');\r\n                                        }}\r\n                                        className={`aspect-video rounded-md overflow-hidden cursor-pointer border-2 transition-all relative group ${singleImage === asset.url\r\n                                            ? 'border-(--primary-color) ring-2 ring-(--primary-color)/30'\r\n                                            : 'border-transparent hover:border-(--text-gray)'\r\n                                            }`}\r\n                                    >\r\n                                        <img src={asset.url} alt={asset.title} className=\"w-full h-full object-cover\" />\r\n                                        {singleImage === asset.url && (\r\n                                            <div className=\"absolute top-1 right-1 bg-(--primary-color) rounded-full p-0.5\">\r\n                                                <Check className=\"w-3 h-3 text-white\" />\r\n                                            </div>\r\n                                        )}\r\n                                        <div className=\"absolute bottom-0 left-0 right-0 bg-black/60 p-1 text-[0.65rem] text-white truncate opacity-0 group-hover:opacity-100 transition-opacity\">\r\n                                            {asset.title}\r\n                                        </div>\r\n                                    </div>\r\n                                ))}\r\n\r\n                                {/* Upload Button */}\r\n                                <div className=\"aspect-video bg-[#15151e] rounded-md border border-dashed border-(--border-color) flex flex-col items-center justify-center cursor-pointer hover:border-(--text-gray) hover:bg-[#1a1a24] transition-colors relative group\">\r\n                                    <Upload className=\"w-5 h-5 text-(--text-gray) mb-1 group-hover:text-white transition-colors\" />\r\n                                    <span className=\"text-[0.7rem] text-(--text-gray)\">업로드</span>\r\n                                    <input type=\"file\" accept=\"image/*\" className=\"absolute inset-0 opacity-0 cursor-pointer\" onChange={(e) => handleImageUpload(e, 'single')} />\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Selected Image Preview with Drop Zone */}\r\n                            <div\r\n                                onDrop={(e) => handleDrop(e, 'single')}\r\n                                onDragOver={handleDragOver}\r\n                                className=\"flex-1 bg-[#15151e] border-2 border-dashed border-(--border-color) rounded-lg flex flex-col items-center justify-center relative overflow-hidden group hover:border-(--primary-color) transition-colors min-h-[250px]\"\r\n                            >\r\n                                {singleImage ? (\r\n                                    <>\r\n                                        <img src={singleImage} alt=\"Source\" className=\"w-full h-full object-contain\" />\r\n                                        <div className=\"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center\">\r\n                                            <button onClick={() => { setSingleImage(null); setSingleSceneId(null); }} className=\"text-white underline text-sm\">이미지 변경</button>\r\n                                        </div>\r\n                                    </>\r\n                                ) : (\r\n                                    <>\r\n                                        <ImageIcon className=\"w-10 h-10 text-(--text-gray) mb-3\" />\r\n                                        <p className=\"text-[0.9rem] text-(--text-gray) mb-1\">위 목록에서 선택하거나 이미지를 드래그 앤 드롭하세요</p>\r\n                                    </>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                    ) : (\r\n                        /* Start-End Frame UI */\r\n                        <div className=\"bg-(--bg-card) rounded-xl p-5 border border-(--border-color) flex-1 flex flex-col\">\r\n                            <h3 className=\"text-[0.9rem] font-semibold mb-[15px]\">시작 및 종료 프레임 선택</h3>\r\n\r\n                            <div className=\"grid grid-cols-2 gap-4 flex-1\">\r\n                                {/* Start Frame */}\r\n                                <div className=\"flex flex-col gap-3\">\r\n                                    <label className=\"text-[0.8rem] text-(--text-gray) font-medium\">시작 프레임</label>\r\n                                    <div\r\n                                        onDrop={(e) => handleDrop(e, 'start')}\r\n                                        onDragOver={handleDragOver}\r\n                                        className=\"flex-1 bg-[#15151e] border-2 border-dashed border-(--border-color) rounded-lg flex flex-col items-center justify-center relative overflow-hidden hover:border-(--primary-color) transition-colors min-h-[200px] cursor-pointer\"\r\n                                    >\r\n                                        {startImage ? (\r\n                                            <>\r\n                                                <img src={startImage} alt=\"Start Frame\" className=\"w-full h-full object-contain\" />\r\n                                                <button\r\n                                                    onClick={() => { setStartImage(null); setStartSceneId(null); }}\r\n                                                    className=\"absolute top-2 right-2 bg-black/60 hover:bg-black/80 text-white px-2 py-1 rounded text-xs\"\r\n                                                >\r\n                                                    변경\r\n                                                </button>\r\n                                            </>\r\n                                        ) : (\r\n                                            <>\r\n                                                <ImageIcon className=\"w-8 h-8 text-(--text-gray) mb-2\" />\r\n                                                <p className=\"text-[0.75rem] text-(--text-gray) text-center px-4\">드래그 앤 드롭 또는 클릭하여 업로드</p>\r\n                                                <input type=\"file\" accept=\"image/*\" className=\"absolute inset-0 opacity-0 cursor-pointer\" onChange={(e) => handleImageUpload(e, 'start')} />\r\n                                            </>\r\n                                        )}\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* End Frame */}\r\n                                <div className=\"flex flex-col gap-3\">\r\n                                    <label className=\"text-[0.8rem] text-(--text-gray) font-medium\">종료 프레임</label>\r\n                                    <div\r\n                                        onDrop={(e) => handleDrop(e, 'end')}\r\n                                        onDragOver={handleDragOver}\r\n                                        className=\"flex-1 bg-[#15151e] border-2 border-dashed border-(--border-color) rounded-lg flex flex-col items-center justify-center relative overflow-hidden hover:border-(--primary-color) transition-colors min-h-[200px] cursor-pointer\"\r\n                                    >\r\n                                        {endImage ? (\r\n                                            <>\r\n                                                <img src={endImage} alt=\"End Frame\" className=\"w-full h-full object-contain\" />\r\n                                                <button\r\n                                                    onClick={() => { setEndImage(null); setEndSceneId(null); }}\r\n                                                    className=\"absolute top-2 right-2 bg-black/60 hover:bg-black/80 text-white px-2 py-1 rounded text-xs\"\r\n                                                >\r\n                                                    변경\r\n                                                </button>\r\n                                            </>\r\n                                        ) : (\r\n                                            <>\r\n                                                <ImageIcon className=\"w-8 h-8 text-(--text-gray) mb-2\" />\r\n                                                <p className=\"text-[0.75rem] text-(--text-gray) text-center px-4\">드래그 앤 드롭 또는 클릭하여 업로드</p>\r\n                                                <input type=\"file\" accept=\"image/*\" className=\"absolute inset-0 opacity-0 cursor-pointer\" onChange={(e) => handleImageUpload(e, 'end')} />\r\n                                            </>\r\n                                        )}\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Scene Images Grid for Selection */}\r\n                            <div className=\"mt-4\">\r\n                                <p className=\"text-[0.75rem] text-(--text-gray) mb-2\">라이브러리에서 드래그하거나 클릭하여 선택:</p>\r\n                                <div className=\"grid grid-cols-6 gap-2\">\r\n                                    {currentProject?.assets.filter(a => a.type === 'image').map(asset => (\r\n                                        <div\r\n                                            key={asset.id}\r\n                                            draggable\r\n                                            onDragStart={(e) => {\r\n                                                e.dataTransfer.setData('imageUrl', asset.url);\r\n                                                e.dataTransfer.setData('sceneId', asset.sceneNumber?.toString() || '');\r\n                                            }}\r\n                                            className=\"aspect-video rounded overflow-hidden cursor-move border border-(--border-color) hover:border-(--primary-color) transition-all\"\r\n                                        >\r\n                                            <img src={asset.url} alt={asset.title} className=\"w-full h-full object-cover\" />\r\n                                        </div>\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Prompt Section - Restored */}\r\n                    <div className=\"bg-(--bg-card) rounded-xl p-5 border border-(--border-color)\">\r\n                        <div className=\"flex justify-between items-center mb-[15px]\">\r\n                            <h3 className=\"text-[0.9rem] font-semibold\">프롬프트 (Optional)</h3>\r\n                            <MagicPromptButton\r\n                                prompt={prompt}\r\n                                onPromptChange={setPrompt}\r\n                                type=\"video\"\r\n                            />\r\n                        </div>\r\n                        <textarea\r\n                            className=\"w-full h-24 bg-[#15151e] border border-(--border-color) rounded-lg p-3 text-white resize-none outline-none focus:border-(--primary-color) text-sm transition-colors\"\r\n                            placeholder={settings.videoType === 'image-to-video'\r\n                                ? \"비디오의 움직임이나 분위기를 설명하세요... (비워두면 AI가 이미지에 맞춰 자동으로 생성합니다)\"\r\n                                : \"두 프레임 사이의 전환 과정을 설명하세요... (비워두면 자동으로 자연스러운 전환을 생성합니다)\"}\r\n                            value={prompt}\r\n                            onChange={(e) => setPrompt(e.target.value)}\r\n                        ></textarea>\r\n                    </div>\r\n                </section>\r\n\r\n                {/* Right Column: Settings */}\r\n                <section className=\"col-span-1 flex flex-col gap-5\">\r\n                    <div className=\"flex flex-col gap-5 h-full\">\r\n                        <VideoSettings\r\n                            settings={settings}\r\n                            onSettingsChange={setSettings}\r\n                        />\r\n\r\n                        <div className=\"bg-(--bg-card) rounded-xl p-5 border border-(--border-color) mt-auto\">\r\n                            <button\r\n                                className=\"w-full bg-(--primary-color) text-white py-3.5 rounded-lg font-semibold hover:bg-[#4a4ddb] transition-colors flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg shadow-blue-900/20\"\r\n                                disabled={\r\n                                    (settings.videoType === 'image-to-video' && !singleImage) ||\r\n                                    (settings.videoType === 'start-end-frame' && (!startImage || !endImage)) ||\r\n                                    !!taskId\r\n                                }\r\n                                onClick={handleGenerateVideo}\r\n                            >\r\n                                {taskId ? (\r\n                                    <>\r\n                                        <RefreshCw className=\"w-5 h-5 animate-spin\" />\r\n                                        생성 중...\r\n                                    </>\r\n                                ) : (\r\n                                    <>\r\n                                        <Wand2 className=\"w-5 h-5\" />\r\n                                        비디오 생성하기\r\n                                    </>\r\n                                )}\r\n                            </button>\r\n                            <p className=\"text-[0.7rem] text-(--text-gray) text-center mt-3\">\r\n                                생성된 비디오는 자동으로 라이브러리에 저장됩니다.\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n                </section>\r\n            </div>\r\n\r\n            <VideoResultModal\r\n                isOpen={!!generatedVideo}\r\n                onClose={() => setGeneratedVideo(null)}\r\n                videoUrl={generatedVideo || ''}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default function VideoPage() {\r\n    return (\r\n        <Suspense fallback={<div className=\"flex items-center justify-center h-full text-white\">Loading...</div>}>\r\n            <VideoPageContent />\r\n        </Suspense>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\components\\audio\\AudioGenerationView.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Toaster' is defined but never used.","line":25,"column":17,"nodeType":null,"messageId":"unusedVar","endLine":25,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'saveCurrentProject' is assigned a value but never used.","line":209,"column":40,"nodeType":null,"messageId":"unusedVar","endLine":209,"endColumn":58},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'updateProjectInfo' is assigned a value but never used.","line":209,"column":60,"nodeType":null,"messageId":"unusedVar","endLine":209,"endColumn":77},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'googleCredentials' is assigned a value but never used.","line":210,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":210,"endColumn":30}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { Play, Pause, Download, RefreshCw, Wand2, Save, GripVertical, Settings2, Trash2, Copy } from 'lucide-react';\r\nimport { useState, useRef, useEffect, useCallback, memo } from 'react';\r\nimport { useProjectStore } from '@/store/useProjectStore';\r\nimport { VoiceSelector } from './VoiceSelector';\r\nimport { TTSVoice, getDefaultVoice } from '@/lib/tts-voices';\r\nimport {\r\n    DndContext,\r\n    closestCenter,\r\n    KeyboardSensor,\r\n    PointerSensor,\r\n    useSensor,\r\n    useSensors,\r\n    DragEndEvent\r\n} from '@dnd-kit/core';\r\nimport {\r\n    arrayMove,\r\n    SortableContext,\r\n    sortableKeyboardCoordinates,\r\n    verticalListSortingStrategy,\r\n    useSortable\r\n} from '@dnd-kit/sortable';\r\nimport { CSS } from '@dnd-kit/utilities';\r\nimport toast, { Toaster } from 'react-hot-toast';\r\nimport { useSettingsStore } from '@/store/useSettingsStore';\r\n\r\ninterface Scene {\r\n    id: number;\r\n    text: string;\r\n    audioUrl?: string;\r\n}\r\n\r\ninterface AudioGenerationViewProps {\r\n    scenes: Scene[];\r\n}\r\n\r\ninterface SortableSceneItemProps {\r\n    scene: Scene;\r\n    playingId: number | null;\r\n    generatingId: number | null;\r\n    isGeneratingAll: boolean;\r\n    togglePlay: (id: number, url?: string) => void;\r\n    handleGenerateAudio: (scene: Scene) => void;\r\n    handleDownload: (scene: Scene) => void;\r\n    handleTextChange: (id: number, text: string) => void;\r\n    handleDelete: (id: number) => void;\r\n    handleDuplicate: (scene: Scene) => void;\r\n    isSelected: boolean;\r\n    onSelect: (id: number) => void;\r\n    setAudioRef: (id: number, el: HTMLAudioElement | null) => void;\r\n}\r\n\r\nconst SortableSceneItem = memo(function SortableSceneItem({\r\n    scene,\r\n    playingId,\r\n    generatingId,\r\n    isGeneratingAll,\r\n    togglePlay,\r\n    handleGenerateAudio,\r\n    handleDownload,\r\n    handleTextChange,\r\n    handleDelete,\r\n    handleDuplicate,\r\n    isSelected,\r\n    onSelect,\r\n    setAudioRef\r\n}: SortableSceneItemProps) {\r\n    const {\r\n        attributes,\r\n        listeners,\r\n        setNodeRef,\r\n        transform,\r\n        transition,\r\n        isDragging\r\n    } = useSortable({ id: scene.id });\r\n\r\n    const style = {\r\n        transform: CSS.Transform.toString(transform),\r\n        transition,\r\n        zIndex: isDragging ? 10 : 1,\r\n        opacity: isDragging ? 0.5 : 1\r\n    };\r\n\r\n    const textareaRef = useRef<HTMLTextAreaElement>(null);\r\n\r\n    useEffect(() => {\r\n        if (textareaRef.current) {\r\n            textareaRef.current.style.height = 'auto';\r\n            textareaRef.current.style.height = textareaRef.current.scrollHeight + 'px';\r\n        }\r\n    }, [scene.text]);\r\n\r\n    return (\r\n        <div\r\n            ref={setNodeRef}\r\n            style={style}\r\n            onClick={() => onSelect(scene.id)}\r\n            className={`bg-(--bg-card) p-2 rounded-lg border flex gap-2 group transition-colors relative items-start ${isSelected ? 'border-(--primary-color) ring-1 ring-(--primary-color)' : 'border-(--border-color) hover:border-(--text-gray)'\r\n                }`}\r\n        >\r\n            {/* Drag Handle */}\r\n            <div\r\n                {...attributes}\r\n                {...listeners}\r\n                className=\"absolute left-1 top-1/2 -translate-y-1/2 p-1 cursor-grab text-(--text-gray) hover:text-white opacity-0 group-hover:opacity-100 transition-opacity\"\r\n            >\r\n                <GripVertical className=\"w-3 h-3\" />\r\n            </div>\r\n\r\n            <div className=\"w-5 h-5 rounded-full bg-[#2b2b36] flex items-center justify-center text-[0.7rem] font-bold text-(--text-gray) shrink-0 mt-1 ml-4\">\r\n                {scene.id}\r\n            </div>\r\n\r\n            <div className=\"flex-1 flex flex-col gap-1.5\">\r\n                <textarea\r\n                    ref={textareaRef}\r\n                    value={scene.text}\r\n                    onChange={(e) => handleTextChange(scene.id, e.target.value)}\r\n                    className=\"w-full bg-transparent text-[0.85rem] text-white leading-relaxed outline-none resize-none border border-transparent focus:border-(--border-color) rounded p-1 transition-colors min-h-[32px] overflow-hidden\"\r\n                    placeholder=\"스크립트를 입력하세요...\"\r\n                    rows={1}\r\n                />\r\n\r\n                <div className=\"flex items-center gap-2\">\r\n                    {/* Audio Player */}\r\n                    <div className=\"flex-1 h-7 bg-[#15151e] rounded-full border border-(--border-color) flex items-center px-2 gap-2\">\r\n                        <button\r\n                            onClick={() => togglePlay(scene.id, scene.audioUrl)}\r\n                            disabled={!scene.audioUrl && !generatingId}\r\n                            className={`w-4 h-4 rounded-full flex items-center justify-center text-white transition-transform ${scene.audioUrl ? 'bg-(--primary-color) hover:scale-105' : 'bg-[#2b2b36] cursor-not-allowed'\r\n                                }`}\r\n                        >\r\n                            {playingId === scene.id ? <Pause className=\"w-2 h-2\" /> : <Play className=\"w-2 h-2 ml-0.5\" />}\r\n                        </button>\r\n\r\n                        {scene.audioUrl ? (\r\n                            <div className=\"flex-1 h-1 bg-[#2b2b36] rounded-full overflow-hidden\">\r\n                                <div className=\"h-full bg-(--primary-color) w-[0%]\"></div>\r\n                            </div>\r\n                        ) : (\r\n                            <span className=\"text-[0.65rem] text-(--text-gray) flex-1\">\r\n                                {generatingId === scene.id ? '생성 중...' : '오디오 없음'}\r\n                            </span>\r\n                        )}\r\n\r\n                        {scene.audioUrl && <span className=\"text-[0.6rem] text-(--text-gray)\">00:00</span>}\r\n\r\n                        {/* Hidden Audio Element */}\r\n                        {scene.audioUrl && (\r\n                            <audio\r\n                                ref={(el) => setAudioRef(scene.id, el)}\r\n                                src={scene.audioUrl}\r\n                                onEnded={() => togglePlay(scene.id, scene.audioUrl)} // Reset play state on end\r\n                                className=\"hidden\"\r\n                            />\r\n                        )}\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center gap-1\">\r\n                        <button\r\n                            onClick={(e) => { e.stopPropagation(); handleDuplicate(scene); }}\r\n                            className=\"p-1.5 rounded-md hover:bg-white/5 text-(--text-gray) hover:text-white transition-colors\"\r\n                            title=\"복제\"\r\n                        >\r\n                            <Copy className=\"w-3 h-3\" />\r\n                        </button>\r\n                        <button\r\n                            onClick={(e) => { e.stopPropagation(); handleGenerateAudio(scene); }}\r\n                            disabled={generatingId === scene.id || isGeneratingAll}\r\n                            className=\"p-1.5 rounded-md hover:bg-white/5 text-(--text-gray) hover:text-white transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                            title=\"생성/재생성\"\r\n                        >\r\n                            <RefreshCw className={`w-3 h-3 ${generatingId === scene.id ? 'animate-spin' : ''}`} />\r\n                        </button>\r\n                        <button\r\n                            onClick={(e) => { e.stopPropagation(); handleDownload(scene); }}\r\n                            disabled={!scene.audioUrl}\r\n                            className=\"p-1.5 rounded-md hover:bg-white/5 text-(--text-gray) hover:text-white transition-colors disabled:opacity-30 disabled:cursor-not-allowed\"\r\n                            title=\"다운로드\"\r\n                        >\r\n                            <Download className=\"w-3 h-3\" />\r\n                        </button>\r\n                        <button\r\n                            onClick={(e) => { e.stopPropagation(); handleDelete(scene.id); }}\r\n                            className=\"p-1.5 rounded-md hover:bg-red-500/10 text-(--text-gray) hover:text-red-500 transition-colors\"\r\n                            title=\"삭제\"\r\n                        >\r\n                            <Trash2 className=\"w-3 h-3\" />\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n});\r\n\r\nexport function AudioGenerationView({ scenes }: AudioGenerationViewProps) {\r\n    const [playingId, setPlayingId] = useState<number | null>(null);\r\n    const [generatingId, setGeneratingId] = useState<number | null>(null);\r\n    const [selectedVoice, setSelectedVoice] = useState<TTSVoice>(getDefaultVoice());\r\n    const [speed, setSpeed] = useState(1.0);\r\n    const [pitch, setPitch] = useState(0); // Added Pitch\r\n    const [isGeneratingAll, setIsGeneratingAll] = useState(false);\r\n    const [selectedSceneId, setSelectedSceneId] = useState<number | null>(null);\r\n    const [copiedScene, setCopiedScene] = useState<Scene | null>(null);\r\n    const audioRefs = useRef<{ [key: number]: HTMLAudioElement | null }>({});\r\n\r\n    const { updateScene, updateScenes, saveCurrentProject, updateProjectInfo, addAsset } = useProjectStore();\r\n    const { googleCredentials } = useSettingsStore();\r\n\r\n    const sensors = useSensors(\r\n        useSensor(PointerSensor),\r\n        useSensor(KeyboardSensor, {\r\n            coordinateGetter: sortableKeyboardCoordinates,\r\n        })\r\n    );\r\n\r\n    const setAudioRef = useCallback((id: number, el: HTMLAudioElement | null) => {\r\n        audioRefs.current[id] = el;\r\n    }, []);\r\n\r\n    const handleDuplicate = useCallback((scene: Scene) => {\r\n        const newId = Math.max(...scenes.map(s => s.id), 0) + 1;\r\n        const newScene = {\r\n            ...scene,\r\n            id: newId,\r\n            audioUrl: undefined\r\n        };\r\n        const newScenes = [...scenes, newScene];\r\n        updateScenes(newScenes);\r\n        toast.success('장면이 붙여넣기 되었습니다.');\r\n    }, [scenes, updateScenes]);\r\n\r\n    // Keyboard Shortcuts for Copy/Paste\r\n    useEffect(() => {\r\n        const handleKeyDown = (e: KeyboardEvent) => {\r\n            // Check if user is typing in an input or textarea\r\n            if (e.target instanceof HTMLInputElement || e.target instanceof HTMLTextAreaElement) {\r\n                return;\r\n            }\r\n\r\n            if (e.ctrlKey || e.metaKey) {\r\n                if (e.key === 'c' && selectedSceneId) {\r\n                    const sceneToCopy = scenes.find(s => s.id === selectedSceneId);\r\n                    if (sceneToCopy) {\r\n                        setCopiedScene(sceneToCopy);\r\n                        toast.success('장면이 복사되었습니다.');\r\n                    }\r\n                } else if (e.key === 'v' && copiedScene) {\r\n                    handleDuplicate(copiedScene);\r\n                }\r\n            }\r\n        };\r\n\r\n        window.addEventListener('keydown', handleKeyDown);\r\n        return () => window.removeEventListener('keydown', handleKeyDown);\r\n    }, [selectedSceneId, copiedScene, scenes, handleDuplicate]);\r\n\r\n    const handleDragEnd = useCallback((event: DragEndEvent) => {\r\n        const { active, over } = event;\r\n\r\n        if (over && active.id !== over.id) {\r\n            const oldIndex = scenes.findIndex((scene) => scene.id === active.id);\r\n            const newIndex = scenes.findIndex((scene) => scene.id === over.id);\r\n\r\n            const newScenes = arrayMove(scenes, oldIndex, newIndex);\r\n            updateScenes(newScenes);\r\n        }\r\n    }, [scenes, updateScenes]);\r\n\r\n    const handleTextChange = useCallback((id: number, text: string) => {\r\n        updateScene(id, { text });\r\n    }, [updateScene]);\r\n\r\n    const handleDelete = useCallback((id: number) => {\r\n        if (confirm('이 장면을 삭제하시겠습니까?')) {\r\n            const newScenes = scenes.filter(s => s.id !== id);\r\n            updateScenes(newScenes);\r\n            if (selectedSceneId === id) setSelectedSceneId(null);\r\n        }\r\n    }, [scenes, updateScenes, selectedSceneId]);\r\n\r\n    const handleSaveToLibrary = useCallback(async () => {\r\n        // 오디오가 없는 scene 확인\r\n        const scenesWithAudio = scenes.filter(scene => scene.audioUrl);\r\n\r\n        if (scenesWithAudio.length === 0) {\r\n            toast.error('저장할 오디오가 없습니다. 먼저 오디오를 생성해주세요.');\r\n            return;\r\n        }\r\n\r\n        try {\r\n            toast.loading('오디오를 병합하고 라이브러리에 저장 중...', { id: 'save-library' });\r\n\r\n            // API 호출하여 오디오 병합\r\n            const response = await fetch('/api/audio/merge', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                },\r\n            });\r\n\r\n            const data = await response.json();\r\n\r\n            if (!response.ok) {\r\n                throw new Error(data.error || '오디오 병합 실패');\r\n            }\r\n\r\n            // 병합된 오디오를 에셋으로 저장\r\n            await addAsset({\r\n                type: 'audio',\r\n                url: data.audioUrl,\r\n                title: `${useProjectStore.getState().currentProject?.title || 'Project'} - Full Audio`,\r\n                duration: data.duration,\r\n                tag: `Voice: ${selectedVoice.name}`\r\n            });\r\n\r\n            toast.success('오디오가 라이브러리에 저장되었습니다.', { id: 'save-library' });\r\n        } catch (error) {\r\n            console.error('Library save error:', error);\r\n            toast.error('라이브러리 저장에 실패했습니다.', { id: 'save-library' });\r\n        }\r\n    }, [scenes, addAsset, selectedVoice.name]);\r\n\r\n    const saveAudioToLibrary = useCallback(async (audioUrl: string, text: string) => {\r\n        try {\r\n            await fetch('/api/assets/save', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({\r\n                    type: 'audio',\r\n                    content: audioUrl,\r\n                    metadata: {\r\n                        title: text.slice(0, 20) + (text.length > 20 ? '...' : ''),\r\n                        description: `Voice: ${selectedVoice.name}, Speed: ${speed}x`,\r\n                        voiceId: selectedVoice.id\r\n                    }\r\n                })\r\n            });\r\n        } catch (error) {\r\n            console.error('Background save failed:', error);\r\n        }\r\n    }, [selectedVoice.name, selectedVoice.id, speed]);\r\n\r\n    const togglePlay = useCallback((id: number, url?: string) => {\r\n        if (playingId === id) {\r\n            const audio = audioRefs.current[id];\r\n            if (audio) {\r\n                audio.pause();\r\n                audio.currentTime = 0;\r\n            }\r\n            setPlayingId(null);\r\n        } else {\r\n            if (playingId !== null && audioRefs.current[playingId]) {\r\n                audioRefs.current[playingId]?.pause();\r\n            }\r\n            if (url) {\r\n                const audio = audioRefs.current[id];\r\n                if (audio) {\r\n                    audio.play().catch(console.error);\r\n                    setPlayingId(id);\r\n                }\r\n            }\r\n        }\r\n    }, [playingId]);\r\n\r\n    const handleGenerateAudio = useCallback(async (scene: Scene, silent: boolean = false) => {\r\n        if (!scene.text.trim()) {\r\n            toast.error('텍스트를 입력해주세요.');\r\n            return;\r\n        }\r\n\r\n        setGeneratingId(scene.id);\r\n        try {\r\n            const response = await fetch('/api/audio/generate', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({\r\n                    text: scene.text,\r\n                    voiceId: selectedVoice.id,\r\n                    speed,\r\n                    pitch,\r\n                    provider: 'google'\r\n                })\r\n            });\r\n\r\n            const data = await response.json();\r\n            if (data.audioUrl) {\r\n                updateScene(scene.id, { audioUrl: data.audioUrl });\r\n\r\n                // Play immediately only if not silent\r\n                if (!silent) {\r\n                    const audio = new Audio(data.audioUrl);\r\n                    audio.play();\r\n                }\r\n\r\n                // Background save\r\n                saveAudioToLibrary(data.audioUrl, scene.text);\r\n            }\r\n        } catch (error) {\r\n            console.error('Generation error:', error);\r\n            toast.error('오디오 생성 실패');\r\n        } finally {\r\n            setGeneratingId(null);\r\n        }\r\n    }, [selectedVoice.id, speed, pitch, updateScene, saveAudioToLibrary]);\r\n\r\n    const handleDownload = useCallback((scene: Scene) => {\r\n        if (!scene.audioUrl) return;\r\n        const a = document.createElement('a');\r\n        a.href = scene.audioUrl;\r\n        a.download = `scene-${scene.id}.mp3`;\r\n        document.body.appendChild(a);\r\n        a.click();\r\n        document.body.removeChild(a);\r\n    }, []);\r\n\r\n    const handleVoicePreview = useCallback(async (voice: TTSVoice) => {\r\n        try {\r\n            const response = await fetch('/api/audio/generate', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({\r\n                    text: \"안녕하세요\",\r\n                    voiceId: voice.id,\r\n                    speed: 1.0,\r\n                    pitch: 0,\r\n                    provider: 'google'\r\n                })\r\n            });\r\n            const data = await response.json();\r\n            if (data.audioUrl) {\r\n                new Audio(data.audioUrl).play();\r\n            }\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }, []);\r\n\r\n    const handleGenerateAll = useCallback(async () => {\r\n        setIsGeneratingAll(true);\r\n        const promises = scenes\r\n            .filter(scene => scene.text.trim() && !scene.audioUrl)\r\n            .map(scene => handleGenerateAudio(scene, true));\r\n\r\n        await Promise.all(promises);\r\n        setIsGeneratingAll(false);\r\n        toast.success('전체 오디오 생성이 완료되었습니다.');\r\n    }, [scenes, handleGenerateAudio]);\r\n\r\n    return (\r\n        <div className=\"flex flex-col h-full gap-4\">\r\n            <div className=\"bg-(--bg-card) p-3 rounded-xl border border-(--border-color)\">\r\n                <div className=\"flex justify-between items-center mb-3\">\r\n                    <h3 className=\"text-[0.85rem] font-semibold text-white flex items-center gap-2\">\r\n                        <Settings2 className=\"w-4 h-4\" />\r\n                        오디오 설정\r\n                    </h3>\r\n                    <button\r\n                        onClick={handleSaveToLibrary}\r\n                        className=\"flex items-center gap-2 px-3 py-1.5 rounded-lg bg-[#2b2b36] hover:bg-[#3b3b46] text-white text-xs font-medium transition-colors\"\r\n                    >\r\n                        <Save className=\"w-3.5 h-3.5\" />\r\n                        라이브러리에 저장\r\n                    </button>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-4 gap-4\">\r\n                    {/* Voice Selection */}\r\n                    <div className=\"flex flex-col gap-1.5 col-span-1\">\r\n                        <label className=\"text-[0.7rem] text-(--text-gray) font-medium\">음성 선택</label>\r\n                        <VoiceSelector\r\n                            selectedVoice={selectedVoice}\r\n                            onVoiceChange={setSelectedVoice}\r\n                            onPreview={handleVoicePreview}\r\n                        />\r\n                    </div>\r\n\r\n                    {/* Speed Control */}\r\n                    <div className=\"flex flex-col gap-1.5 col-span-1\">\r\n                        <label className=\"text-[0.7rem] text-(--text-gray) font-medium\">\r\n                            속도: {speed.toFixed(1)}x\r\n                        </label>\r\n                        <div className=\"bg-[#15151e] border border-(--border-color) rounded-lg p-2 flex items-center gap-2 h-[38px]\">\r\n                            <input\r\n                                type=\"range\"\r\n                                min=\"0.5\"\r\n                                max=\"2.0\"\r\n                                step=\"0.1\"\r\n                                value={speed}\r\n                                onChange={(e) => setSpeed(parseFloat(e.target.value))}\r\n                                className=\"flex-1 accent-(--primary-color) h-1\"\r\n                            />\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Pitch Control */}\r\n                    <div className=\"flex flex-col gap-1.5 col-span-1\">\r\n                        <label className=\"text-[0.7rem] text-(--text-gray) font-medium\">\r\n                            피치: {pitch > 0 ? '+' : ''}{pitch.toFixed(1)}\r\n                        </label>\r\n                        <div className=\"bg-[#15151e] border border-(--border-color) rounded-lg p-2 flex items-center gap-2 h-[38px]\">\r\n                            <input\r\n                                type=\"range\"\r\n                                min=\"-20.0\"\r\n                                max=\"20.0\"\r\n                                step=\"1.0\"\r\n                                value={pitch}\r\n                                onChange={(e) => setPitch(parseFloat(e.target.value))}\r\n                                className=\"flex-1 accent-(--primary-color) h-1\"\r\n                            />\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Generate All Button */}\r\n                    <div className=\"flex flex-col gap-1.5 col-span-1\">\r\n                        <label className=\"text-[0.7rem] text-(--text-gray) font-medium\">일괄 작업</label>\r\n                        <button\r\n                            onClick={handleGenerateAll}\r\n                            disabled={isGeneratingAll || generatingId !== null}\r\n                            className=\"h-[38px] bg-(--primary-color) text-white rounded-lg hover:bg-[#4a4ddb] transition-colors flex items-center justify-center gap-2 font-medium disabled:opacity-50 disabled:cursor-not-allowed text-xs w-full\"\r\n                        >\r\n                            <Wand2 className={`w-3.5 h-3.5 ${isGeneratingAll ? 'animate-spin' : ''}`} />\r\n                            {isGeneratingAll ? '생성 중...' : '전체 생성'}\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div >\r\n\r\n            {/* Scene List */}\r\n            < div className=\"flex-1 overflow-y-auto custom-scrollbar pr-2\" >\r\n                <DndContext\r\n                    sensors={sensors}\r\n                    collisionDetection={closestCenter}\r\n                    onDragEnd={handleDragEnd}\r\n                >\r\n                    <SortableContext\r\n                        items={scenes.map(s => s.id)}\r\n                        strategy={verticalListSortingStrategy}\r\n                    >\r\n                        <div className=\"flex flex-col gap-2\">\r\n                            {scenes.map((scene) => (\r\n                                <SortableSceneItem\r\n                                    key={scene.id}\r\n                                    scene={scene}\r\n                                    playingId={playingId}\r\n                                    generatingId={generatingId}\r\n                                    isGeneratingAll={isGeneratingAll}\r\n                                    togglePlay={togglePlay}\r\n                                    handleGenerateAudio={handleGenerateAudio}\r\n                                    handleDownload={handleDownload}\r\n                                    handleTextChange={handleTextChange}\r\n                                    handleDelete={handleDelete}\r\n                                    handleDuplicate={handleDuplicate}\r\n                                    isSelected={selectedSceneId === scene.id}\r\n                                    onSelect={setSelectedSceneId}\r\n                                    setAudioRef={setAudioRef}\r\n                                />\r\n                            ))}\r\n                        </div>\r\n                    </SortableContext>\r\n                </DndContext>\r\n            </div >\r\n        </div >\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\components\\audio\\AudioSplitModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\components\\audio\\VoiceSelector.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\components\\common\\MagicPromptButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\components\\editor\\PropertyPanel.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\components\\editor\\Timeline\\Timeline.tsx","messages":[{"ruleId":"react-hooks/refs","severity":2,"message":"Error: Cannot access refs during render\n\nReact refs are values that are not needed for rendering. Refs should only be accessed outside of render, such as in event handlers or effects. Accessing a ref value (the `current` property) during render can cause your component not to update as expected (https://react.dev/reference/react/useRef).\n\nC:\\Users\\user\\Desktop\\studioAI\\src\\components\\editor\\Timeline\\Timeline.tsx:58:61\n  56 |                 <div\n  57 |                     className=\"min-h-full relative\"\n> 58 |                     style={{ width: `${Math.max(totalWidth, containerRef.current?.clientWidth || 0)}px` }}\n     |                                                             ^^^^^^^^^^^^^^^^^^^^ Cannot access ref value during render\n  59 |                 >\n  60 |                     {/* Time Ruler Background (Optional Grid) */}\n  61 |                     <div className=\"absolute inset-0 pointer-events-none opacity-10\"","line":58,"column":61,"nodeType":null,"endLine":58,"endColumn":81},{"ruleId":"react-hooks/refs","severity":2,"message":"Error: Cannot access refs during render\n\nReact refs are values that are not needed for rendering. Refs should only be accessed outside of render, such as in event handlers or effects. Accessing a ref value (the `current` property) during render can cause your component not to update as expected (https://react.dev/reference/react/useRef).\n\nC:\\Users\\user\\Desktop\\studioAI\\src\\components\\editor\\Timeline\\Timeline.tsx:58:61\n  56 |                 <div\n  57 |                     className=\"min-h-full relative\"\n> 58 |                     style={{ width: `${Math.max(totalWidth, containerRef.current?.clientWidth || 0)}px` }}\n     |                                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ Cannot access ref value during render\n  59 |                 >\n  60 |                     {/* Time Ruler Background (Optional Grid) */}\n  61 |                     <div className=\"absolute inset-0 pointer-events-none opacity-10\"","line":58,"column":61,"nodeType":null,"endLine":58,"endColumn":94},{"ruleId":"react-hooks/refs","severity":2,"message":"Error: Cannot access refs during render\n\nReact refs are values that are not needed for rendering. Refs should only be accessed outside of render, such as in event handlers or effects. Accessing a ref value (the `current` property) during render can cause your component not to update as expected (https://react.dev/reference/react/useRef).\n\nC:\\Users\\user\\Desktop\\studioAI\\src\\components\\editor\\Timeline\\Timeline.tsx:58:61\n  56 |                 <div\n  57 |                     className=\"min-h-full relative\"\n> 58 |                     style={{ width: `${Math.max(totalWidth, containerRef.current?.clientWidth || 0)}px` }}\n     |                                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ Passing a ref to a function may read its value during render\n  59 |                 >\n  60 |                     {/* Time Ruler Background (Optional Grid) */}\n  61 |                     <div className=\"absolute inset-0 pointer-events-none opacity-10\"","line":58,"column":61,"nodeType":null,"endLine":58,"endColumn":99}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useRef } from \"react\";\r\nimport { useTimelineStore } from \"@/store/useTimelineStore\";\r\nimport { TrackRow } from \"./TrackRow\";\r\nimport { TimelineRuler } from \"./TimelineRuler\";\r\nimport { useShallow } from \"zustand/react/shallow\";\r\nimport { Plus } from \"lucide-react\";\r\n\r\nexport function Timeline() {\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n\r\n    const {\r\n        tracks,\r\n        durationMs,\r\n        zoomLevel,\r\n        addTrack\r\n    } = useTimelineStore(useShallow(state => ({\r\n        tracks: state.timeline.tracks,\r\n        durationMs: state.timeline.durationMs,\r\n        zoomLevel: state.zoomLevel,\r\n        addTrack: state.addTrack\r\n    })));\r\n\r\n    const pixelsPerMs = 0.1 * zoomLevel; // Base scale * zoom\r\n    const totalWidth = durationMs * pixelsPerMs;\r\n\r\n    return (\r\n        <div className=\"flex flex-col h-full bg-zinc-950 text-white select-none\">\r\n            {/* Toolbar / Header */}\r\n            <div className=\"h-10 border-b border-zinc-800 flex items-center px-4 bg-zinc-900\">\r\n                <span className=\"text-sm font-medium text-zinc-400\">Timeline</span>\r\n                <div className=\"ml-auto flex items-center gap-2\">\r\n                    <button\r\n                        onClick={() => addTrack('video')}\r\n                        className=\"p-1 hover:bg-zinc-800 rounded text-xs flex items-center gap-1\"\r\n                    >\r\n                        <Plus className=\"w-3 h-3\" /> Video Track\r\n                    </button>\r\n                    <button\r\n                        onClick={() => addTrack('audio')}\r\n                        className=\"p-1 hover:bg-zinc-800 rounded text-xs flex items-center gap-1\"\r\n                    >\r\n                        <Plus className=\"w-3 h-3\" /> Audio Track\r\n                    </button>\r\n                </div>\r\n            </div>\r\n\r\n            <TimelineRuler />\r\n\r\n            {/* Tracks Container */}\r\n            <div\r\n                ref={containerRef}\r\n                className=\"flex-1 overflow-y-auto overflow-x-hidden relative\"\r\n            >\r\n                <div\r\n                    className=\"min-h-full relative\"\r\n                    style={{ width: `${Math.max(totalWidth, containerRef.current?.clientWidth || 0)}px` }}\r\n                >\r\n                    {/* Time Ruler Background (Optional Grid) */}\r\n                    <div className=\"absolute inset-0 pointer-events-none opacity-10\"\r\n                        style={{\r\n                            backgroundImage: 'linear-gradient(90deg, #333 1px, transparent 1px)',\r\n                            backgroundSize: `${1000 * pixelsPerMs}px 100%`\r\n                        }}\r\n                    />\r\n\r\n                    {tracks.map((track) => (\r\n                        <TrackRow\r\n                            key={track.id}\r\n                            trackId={track.id}\r\n                            type={track.type}\r\n                            pixelsPerMs={pixelsPerMs}\r\n                            timelineDurationMs={durationMs}\r\n                        />\r\n                    ))}\r\n\r\n                    {/* Drop Zone for new tracks */}\r\n                    <div\r\n                        className=\"h-32 flex items-center justify-center text-zinc-600 border-t border-zinc-800/50 hover:bg-zinc-900/30 transition-colors cursor-pointer\"\r\n                        onClick={() => addTrack('video')}\r\n                    >\r\n                        <span className=\"text-sm\">Click or Drag here to add track</span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\components\\editor\\Timeline\\TimelineRuler.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'startMs' is assigned a value but never used.","line":37,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":37,"endColumn":22},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'pixelsPerMs'. Either include it or remove the dependency array.","line":54,"column":8,"nodeType":"ArrayExpression","endLine":54,"endColumn":47,"suggestions":[{"desc":"Update the dependencies array to be: [durationMs, zoomLevel, scrollPosition, pixelsPerMs]","fix":{"range":[1854,1893],"text":"[durationMs, zoomLevel, scrollPosition, pixelsPerMs]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useRef, useEffect } from \"react\";\r\nimport { useTimelineStore } from \"@/store/useTimelineStore\";\r\nimport { useShallow } from \"zustand/react/shallow\";\r\n\r\nexport function TimelineRuler() {\r\n    const canvasRef = useRef<HTMLCanvasElement>(null);\r\n    const { durationMs, zoomLevel, scrollPosition, setPlaybackTime, currentTime } = useTimelineStore(useShallow(state => ({\r\n        durationMs: state.timeline.durationMs,\r\n        zoomLevel: state.zoomLevel,\r\n        scrollPosition: state.scrollPosition,\r\n        setPlaybackTime: state.setPlaybackTime,\r\n        currentTime: state.playback.currentTime\r\n    })));\r\n\r\n    const pixelsPerMs = 0.1 * zoomLevel;\r\n\r\n    useEffect(() => {\r\n        const canvas = canvasRef.current;\r\n        if (!canvas) return;\r\n\r\n        const ctx = canvas.getContext('2d');\r\n        if (!ctx) return;\r\n\r\n        const width = canvas.width;\r\n        const height = canvas.height;\r\n\r\n        ctx.clearRect(0, 0, width, height);\r\n        ctx.fillStyle = '#71717a'; // zinc-500\r\n        ctx.font = '10px sans-serif';\r\n\r\n        // Draw ticks\r\n        const majorTickInterval = 1000; // 1 second\r\n        const minorTickInterval = 100;  // 0.1 second\r\n\r\n        const startMs = scrollPosition / pixelsPerMs; // Approximate visible start\r\n        // Ideally we should virtualize this, but for now draw all or visible range\r\n\r\n        // Simple drawing for now\r\n        for (let t = 0; t <= durationMs; t += minorTickInterval) {\r\n            const x = t * pixelsPerMs;\r\n\r\n            if (t % majorTickInterval === 0) {\r\n                // Major tick\r\n                ctx.fillRect(x, height - 12, 1, 12);\r\n                ctx.fillText(`${t / 1000}s`, x + 4, height - 4);\r\n            } else {\r\n                // Minor tick\r\n                ctx.fillRect(x, height - 6, 1, 6);\r\n            }\r\n        }\r\n\r\n    }, [durationMs, zoomLevel, scrollPosition]);\r\n\r\n    const handleMouseDown = (e: React.MouseEvent) => {\r\n        const rect = e.currentTarget.getBoundingClientRect();\r\n        const x = e.clientX - rect.left;\r\n        const time = x / pixelsPerMs;\r\n        setPlaybackTime(Math.max(0, Math.min(time, durationMs)));\r\n    };\r\n\r\n    return (\r\n        <div className=\"h-8 bg-zinc-900 border-b border-zinc-800 relative overflow-hidden\">\r\n            <canvas\r\n                ref={canvasRef}\r\n                width={durationMs * pixelsPerMs}\r\n                height={32}\r\n                className=\"absolute top-0 left-0 cursor-pointer\"\r\n                onMouseDown={handleMouseDown}\r\n            />\r\n            {/* Playhead Indicator */}\r\n            <div\r\n                className=\"absolute top-0 bottom-0 w-px bg-red-500 pointer-events-none z-50\"\r\n                style={{ left: `${currentTime * pixelsPerMs}px` }}\r\n            >\r\n                <div className=\"absolute -top-1 -left-1.5 w-3 h-3 bg-red-500 transform rotate-45\" />\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\components\\editor\\Timeline\\TrackRow.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'type' is defined but never used.","line":17,"column":37,"nodeType":null,"messageId":"unusedVar","endLine":17,"endColumn":41},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'timelineDurationMs' is defined but never used.","line":60,"column":49,"nodeType":null,"messageId":"unusedVar","endLine":60,"endColumn":67},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'onMove' is defined but never used.","line":60,"column":89,"nodeType":null,"messageId":"unusedVar","endLine":60,"endColumn":95}],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":78,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":78,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3297,3300],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3297,3300],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":203,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":203,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8633,8636],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8633,8636],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":265,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":265,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11267,11270],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11267,11270],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useRef, useState } from \"react\";\r\nimport { useTimelineStore, TimelineClip, KeyframeData } from \"@/store/useTimelineStore\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { Trash2 } from \"lucide-react\";\r\nimport { useShallow } from \"zustand/react/shallow\";\r\nimport { v4 as uuidv4 } from 'uuid'; // Added for generating new track IDs\r\n\r\ninterface TrackRowProps {\r\n    trackId: string;\r\n    type: 'video' | 'audio' | 'text' | 'image' | 'shape';\r\n    pixelsPerMs: number;\r\n    timelineDurationMs: number;\r\n}\r\n\r\nexport function TrackRow({ trackId, type, pixelsPerMs, timelineDurationMs }: TrackRowProps) {\r\n    // Select only the specific track to avoid re-renders when other tracks change\r\n    const track = useTimelineStore(useShallow(state => state.timeline.tracks.find(t => t.id === trackId)));\r\n\r\n    // Select actions (stable references)\r\n    const { deleteClip, updateClip, moveClip } = useTimelineStore(useShallow(state => ({\r\n        deleteClip: state.deleteClip,\r\n        updateClip: state.updateClip,\r\n        moveClip: state.moveClip\r\n    })));\r\n\r\n    const clips = track?.clips || [];\r\n\r\n    return (\r\n        <div className=\"relative w-full h-16 bg-zinc-900/50 border-b border-zinc-800 flex flex-col select-none group\">\r\n            <div className=\"flex-1 relative overflow-hidden\">\r\n                {clips.map(clip => (\r\n                    <ClipView\r\n                        key={clip.id}\r\n                        clip={clip}\r\n                        trackId={trackId}\r\n                        pixelsPerMs={pixelsPerMs}\r\n                        timelineDurationMs={timelineDurationMs}\r\n                        onUpdate={(id, updates) => updateClip(id, updates)}\r\n                        onRemove={(id) => deleteClip(id)}\r\n                        onMove={(id, newTrackId, newStartMs) => moveClip(id, newTrackId, newStartMs)}\r\n                    />\r\n                ))}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\ninterface ClipViewProps {\r\n    clip: TimelineClip;\r\n    trackId: string;\r\n    pixelsPerMs: number;\r\n    timelineDurationMs: number;\r\n    onUpdate: (id: string, updates: Partial<TimelineClip>) => void;\r\n    onRemove: (id: string) => void;\r\n    onMove: (id: string, newTrackId: string, newStartMs: number) => void;\r\n}\r\n\r\nfunction ClipView({ clip, trackId, pixelsPerMs, timelineDurationMs, onUpdate, onRemove, onMove }: ClipViewProps) {\r\n    const ref = useRef<HTMLDivElement>(null);\r\n    const [isDragging, setIsDragging] = useState(false);\r\n    const [isResizing, setIsResizing] = useState(false);\r\n\r\n    // Granular selectors\r\n    const isSelected = useTimelineStore(state => state.selectedClipIds.includes(clip.id));\r\n    const snappingEnabled = useTimelineStore(state => state.snappingEnabled);\r\n    const setSelectedClipIds = useTimelineStore(state => state.setSelectedClipIds);\r\n    const setPlaybackTime = useTimelineStore(state => state.setPlaybackTime);\r\n\r\n    const left = clip.startMs * pixelsPerMs;\r\n    const width = (clip.endMs - clip.startMs) * pixelsPerMs;\r\n\r\n    // Collect keyframes\r\n    const keyframes: { timeMs: number, property: string, id: string }[] = [];\r\n    ['opacity', 'scale', 'rotation', 'volume'].forEach(prop => {\r\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n        const val = (clip as any)[prop];\r\n        if (Array.isArray(val)) {\r\n            val.forEach((k: KeyframeData) => {\r\n                if (!keyframes.some(existing => Math.abs(existing.timeMs - k.timeMs) < 1)) {\r\n                    keyframes.push({ timeMs: k.timeMs, property: prop, id: k.id });\r\n                }\r\n            });\r\n        }\r\n    });\r\n\r\n    // Helper to find snap time - Uses getState() to avoid subscribing to playback/timeline updates\r\n    const getSnapTime = (targetMs: number) => {\r\n        if (!snappingEnabled) return targetMs;\r\n\r\n        const state = useTimelineStore.getState();\r\n        const thresholdMs = 20 / pixelsPerMs; // 20px threshold\r\n        let closestMs = targetMs;\r\n        let minDiff = Infinity;\r\n\r\n        // Snap points: 0, Playhead\r\n        const snapPoints = [0, state.playback.currentTime];\r\n\r\n        // Add other clips' start/end as snap points\r\n        state.timeline.tracks.forEach(t => {\r\n            t.clips.forEach(c => {\r\n                if (c.id === clip.id) return; // Skip self\r\n                snapPoints.push(c.startMs);\r\n                snapPoints.push(c.endMs);\r\n            });\r\n        });\r\n\r\n        for (const point of snapPoints) {\r\n            const diff = Math.abs(targetMs - point);\r\n            if (diff < thresholdMs && diff < minDiff) {\r\n                minDiff = diff;\r\n                closestMs = point;\r\n            }\r\n        }\r\n\r\n        return closestMs;\r\n    };\r\n\r\n    const handleMouseDown = (e: React.MouseEvent) => {\r\n        e.stopPropagation();\r\n        if (e.button !== 0) return; // Only left click\r\n\r\n        setSelectedClipIds([clip.id]); // Select on click\r\n\r\n        const startX = e.clientX;\r\n        const startY = e.clientY;\r\n        const startMs = clip.startMs;\r\n\r\n        setIsDragging(true);\r\n\r\n        const handleMouseMove = (moveEvent: MouseEvent) => {\r\n            const deltaX = moveEvent.clientX - startX;\r\n            const deltaMs = deltaX / pixelsPerMs;\r\n            let newStartMs = Math.max(0, startMs + deltaMs);\r\n\r\n            // Apply snapping\r\n            newStartMs = getSnapTime(newStartMs);\r\n\r\n            // Snap to 0 if close\r\n            if (newStartMs < 100) newStartMs = 0;\r\n\r\n            onUpdate(clip.id, { startMs: newStartMs, endMs: newStartMs + (clip.endMs - clip.startMs) });\r\n        };\r\n\r\n        const handleMouseUpWithEvent = (upEvent: MouseEvent) => {\r\n            setIsDragging(false);\r\n            document.removeEventListener('mousemove', handleMouseMove);\r\n            document.removeEventListener('mouseup', handleMouseUpWithEvent);\r\n\r\n            const deltaX = upEvent.clientX - startX;\r\n            const deltaY = upEvent.clientY - startY;\r\n\r\n            const deltaMs = deltaX / pixelsPerMs;\r\n            let newStartMs = Math.max(0, startMs + deltaMs);\r\n            newStartMs = getSnapTime(newStartMs);\r\n            if (newStartMs < 100) newStartMs = 0;\r\n\r\n            // Vertical Logic\r\n            const TRACK_HEIGHT = 64; // h-16\r\n            const trackOffset = Math.round(deltaY / TRACK_HEIGHT);\r\n\r\n            if (trackOffset !== 0) {\r\n                const state = useTimelineStore.getState();\r\n                const currentTrackIndex = state.timeline.tracks.findIndex(t => t.id === trackId);\r\n                const targetTrackIndex = currentTrackIndex + trackOffset;\r\n\r\n                if (targetTrackIndex >= 0 && targetTrackIndex < state.timeline.tracks.length) {\r\n                    // Move to existing track\r\n                    const targetTrack = state.timeline.tracks[targetTrackIndex];\r\n                    // Check compatibility\r\n                    if (targetTrack.type === clip.type || (['video', 'image', 'text', 'shape'].includes(clip.type) && ['video', 'image', 'text', 'shape'].includes(targetTrack.type))) {\r\n                        state.moveClip(clip.id, targetTrack.id, newStartMs);\r\n                    } else {\r\n                        // Revert to original track but new time\r\n                        onUpdate(clip.id, { startMs: newStartMs, endMs: newStartMs + (clip.endMs - clip.startMs) });\r\n                    }\r\n                } else if (targetTrackIndex >= state.timeline.tracks.length) {\r\n                    // Create new track at bottom\r\n                    const newTrackId = uuidv4();\r\n                    state.addTrack(clip.type === 'audio' ? 'audio' : 'video', newTrackId);\r\n                    state.moveClip(clip.id, newTrackId, newStartMs);\r\n                } else {\r\n                    // Top boundary - just update time\r\n                    onUpdate(clip.id, { startMs: newStartMs, endMs: newStartMs + (clip.endMs - clip.startMs) });\r\n                }\r\n            } else {\r\n                // Same track, just time update\r\n                onUpdate(clip.id, { startMs: newStartMs, endMs: newStartMs + (clip.endMs - clip.startMs) });\r\n            }\r\n        };\r\n\r\n        document.addEventListener('mousemove', handleMouseMove);\r\n        document.addEventListener('mouseup', handleMouseUpWithEvent);\r\n    };\r\n\r\n    const handleResize = (e: React.MouseEvent, direction: 'left' | 'right') => {\r\n        e.stopPropagation();\r\n        const startX = e.clientX;\r\n        const startMs = clip.startMs;\r\n        const duration = clip.endMs - clip.startMs;\r\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n        const startSourceMs = (clip as any).sourceStartMs || 0;\r\n\r\n        setIsResizing(true);\r\n\r\n        const handleMouseMove = (moveEvent: MouseEvent) => {\r\n            const deltaX = moveEvent.clientX - startX;\r\n            const deltaMs = deltaX / pixelsPerMs;\r\n\r\n            if (direction === 'right') {\r\n                let newEndMs = startMs + duration + deltaMs;\r\n                // Snap end time\r\n                newEndMs = getSnapTime(newEndMs);\r\n\r\n                const newDuration = Math.max(500, newEndMs - startMs); // Min 500ms\r\n                onUpdate(clip.id, { endMs: startMs + newDuration });\r\n            } else {\r\n                // Left resize logic (trim start)\r\n                let newStartMs = startMs + deltaMs;\r\n                // Snap start time\r\n                newStartMs = getSnapTime(newStartMs);\r\n\r\n                newStartMs = Math.min(newStartMs, startMs + duration - 500);\r\n                const change = newStartMs - startMs;\r\n                onUpdate(clip.id, {\r\n                    startMs: newStartMs,\r\n                    sourceStartMs: Math.max(0, startSourceMs + change)\r\n                });\r\n            }\r\n        };\r\n\r\n        const handleMouseUp = () => {\r\n            setIsResizing(false);\r\n            document.removeEventListener('mousemove', handleMouseMove);\r\n            document.removeEventListener('mouseup', handleMouseUp);\r\n        };\r\n\r\n        document.addEventListener('mousemove', handleMouseMove);\r\n        document.addEventListener('mouseup', handleMouseUp);\r\n    };\r\n\r\n    return (\r\n        <div\r\n            ref={ref}\r\n            className={cn(\r\n                \"absolute top-1 bottom-1 rounded-md overflow-hidden cursor-move border border-white/10 group/clip\",\r\n                clip.type === 'video' && \"bg-blue-600/80\",\r\n                clip.type === 'image' && \"bg-purple-600/80\",\r\n                clip.type === 'audio' && \"bg-green-600/80\",\r\n                clip.type === 'text' && \"bg-orange-600/80\",\r\n                clip.type === 'shape' && \"bg-red-600/80\",\r\n                isDragging && \"opacity-80 z-50 ring-2 ring-white\",\r\n                isResizing && \"z-50\",\r\n                isSelected && \"ring-2 ring-yellow-400 z-40\" // Highlight selection\r\n            )}\r\n            style={{\r\n                left: `${left}px`,\r\n                width: `${width}px`,\r\n            }}\r\n            onMouseDown={handleMouseDown}\r\n        >\r\n            <div className=\"px-2 py-1 text-xs text-white font-medium truncate flex items-center justify-between h-full relative\">\r\n                {/* eslint-disable-next-line @typescript-eslint/no-explicit-any */}\r\n                <span className=\"z-10\">{(clip as any).title || clip.type}</span>\r\n\r\n                {/* Transition Indicator */}\r\n                {clip.transitionIn && clip.transitionIn.type !== 'none' && (\r\n                    <div\r\n                        className=\"absolute left-0 top-0 bottom-0 bg-white/20 z-0 pointer-events-none border-r border-white/30\"\r\n                        style={{ width: `${clip.transitionIn.durationMs * pixelsPerMs}px` }}\r\n                        title={`Transition: ${clip.transitionIn.type}`}\r\n                    >\r\n                        <div className=\"absolute inset-0 bg-gradient-to-r from-white/10 to-transparent\" />\r\n                    </div>\r\n                )}\r\n\r\n                {/* Keyframe Markers */}\r\n                {keyframes.map(k => (\r\n                    <div\r\n                        key={k.id}\r\n                        className=\"absolute w-2 h-2 bg-white rotate-45 transform -translate-x-1/2 -translate-y-1/2 z-20 cursor-pointer hover:bg-yellow-400 shadow-sm\"\r\n                        style={{ left: `${k.timeMs * pixelsPerMs}px`, top: '80%' }}\r\n                        onClick={(e) => {\r\n                            e.stopPropagation();\r\n                            setPlaybackTime(clip.startMs + k.timeMs);\r\n                        }}\r\n                        title={`Keyframe: ${k.property}`}\r\n                    />\r\n                ))}\r\n\r\n                <button\r\n                    onClick={(e) => { e.stopPropagation(); onRemove(clip.id); }}\r\n                    className=\"opacity-0 group-hover/clip:opacity-100 hover:text-red-400 transition-opacity z-10\"\r\n                >\r\n                    <Trash2 className=\"w-3 h-3\" />\r\n                </button>\r\n            </div>\r\n\r\n            {/* Resize Handles */}\r\n            <div\r\n                className=\"absolute left-0 top-0 bottom-0 w-2 cursor-ew-resize hover:bg-white/20 z-10\"\r\n                onMouseDown={(e) => handleResize(e, 'left')}\r\n            />\r\n            <div\r\n                className=\"absolute right-0 top-0 bottom-0 w-2 cursor-ew-resize hover:bg-white/20 z-10\"\r\n                onMouseDown={(e) => handleResize(e, 'right')}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\components\\image\\ImagePreviewModal.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":58,"column":21,"nodeType":"JSXOpeningElement","endLine":62,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { X, Download } from 'lucide-react';\r\nimport { useEffect } from 'react';\r\n\r\ninterface ImagePreviewModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    imageUrl: string;\r\n    prompt: string;\r\n}\r\n\r\nexport function ImagePreviewModal({ isOpen, onClose, imageUrl, prompt }: ImagePreviewModalProps) {\r\n    useEffect(() => {\r\n        const handleEsc = (e: KeyboardEvent) => {\r\n            if (e.key === 'Escape') onClose();\r\n        };\r\n        window.addEventListener('keydown', handleEsc);\r\n        return () => window.removeEventListener('keydown', handleEsc);\r\n    }, [onClose]);\r\n\r\n    if (!isOpen) return null;\r\n\r\n    const handleDownload = () => {\r\n        const link = document.createElement('a');\r\n        link.href = imageUrl;\r\n        link.download = `generated-image-${Date.now()}.png`;\r\n        document.body.appendChild(link);\r\n        link.click();\r\n        document.body.removeChild(link);\r\n    };\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm\" onClick={onClose}>\r\n            <div className=\"relative max-w-[90vw] max-h-[90vh] bg-[#15151e] rounded-xl overflow-hidden border border-[var(--border-color)] shadow-2xl flex flex-col\" onClick={e => e.stopPropagation()}>\r\n                {/* Header */}\r\n                <div className=\"flex justify-between items-center p-4 border-b border-[var(--border-color)] bg-[#1e1e2d]\">\r\n                    <h3 className=\"text-white font-medium text-sm\">Image Preview</h3>\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <button\r\n                            onClick={handleDownload}\r\n                            className=\"p-2 hover:bg-white/10 rounded-lg text-white transition-colors flex items-center gap-2 text-xs\"\r\n                        >\r\n                            <Download className=\"w-4 h-4\" />\r\n                            Download\r\n                        </button>\r\n                        <button\r\n                            onClick={onClose}\r\n                            className=\"p-2 hover:bg-white/10 rounded-lg text-[var(--text-gray)] hover:text-white transition-colors\"\r\n                        >\r\n                            <X className=\"w-4 h-4\" />\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Image Area */}\r\n                <div className=\"flex-1 overflow-auto p-4 flex items-center justify-center bg-[#0f0f16]\">\r\n                    <img\r\n                        src={imageUrl}\r\n                        alt={prompt}\r\n                        className=\"max-w-full max-h-[70vh] object-contain rounded-lg shadow-lg\"\r\n                    />\r\n                </div>\r\n\r\n                {/* Footer (Prompt) */}\r\n                <div className=\"p-4 border-t border-[var(--border-color)] bg-[#1e1e2d]\">\r\n                    <p className=\"text-xs text-[var(--text-gray)] line-clamp-3 font-mono\">\r\n                        {prompt}\r\n                    </p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\components\\image\\ImageResultModal.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":17,"column":21,"nodeType":"JSXOpeningElement","endLine":17,"endColumn":110}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { Modal } from '@/components/ui/Modal';\r\nimport { Download, Share2 } from 'lucide-react';\r\n\r\ninterface ImageResultModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    imageUrl: string;\r\n}\r\n\r\nexport function ImageResultModal({ isOpen, onClose, imageUrl }: ImageResultModalProps) {\r\n    return (\r\n        <Modal isOpen={isOpen} onClose={onClose} title=\"이미지 상세\" className=\"w-[800px]\">\r\n            <div className=\"flex flex-col gap-5\">\r\n                <div className=\"aspect-video bg-black rounded-lg overflow-hidden flex items-center justify-center border border-[#2a2a35]\">\r\n                    <img src={imageUrl} alt=\"Generated\" className=\"max-w-full max-h-[60vh] object-contain\" />\r\n                </div>\r\n\r\n                <div className=\"flex justify-between items-center pt-2\">\r\n                    <div className=\"flex flex-col gap-1\">\r\n                        <span className=\"text-sm text-[#a0a0b0]\">Generated by Fal.ai FLUX.1</span>\r\n                    </div>\r\n                    <div className=\"flex gap-3\">\r\n                        <button className=\"px-4 py-2 rounded-md border border-[#383845] text-[#a0a0b0] hover:text-white hover:border-white transition-colors text-sm flex items-center gap-2\">\r\n                            <Share2 className=\"w-4 h-4\" />\r\n                            공유\r\n                        </button>\r\n                        <button className=\"px-4 py-2 rounded-md bg-(--primary-color) text-white hover:bg-[#4a4ddb] transition-colors text-sm flex items-center gap-2 font-medium\">\r\n                            <Download className=\"w-4 h-4\" />\r\n                            다운로드\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </Modal>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\components\\layout\\GlobalDragHandler.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\components\\layout\\LibraryPanel.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Filter' is defined but never used.","line":3,"column":41,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":47},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Search' is defined but never used.","line":3,"column":49,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":55},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setSearchQuery' is assigned a value but never used.","line":18,"column":25,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":39},{"ruleId":"react-hooks/rules-of-hooks","severity":2,"message":"React Hook \"useEffect\" is called conditionally. React Hooks must be called in the exact same order in every component render.","line":28,"column":5,"nodeType":"Identifier","endLine":28,"endColumn":14},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadProjects'. Either include it or remove the dependency array.","line":30,"column":8,"nodeType":"ArrayExpression","endLine":30,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [loadProjects]","fix":{"range":[1443,1445],"text":"[loadProjects]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":131,"column":74,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":131,"endColumn":77,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5492,5495],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5492,5495],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { Settings, ChevronDown, Upload, Filter, Search } from 'lucide-react';\r\nimport { useState, useEffect, useRef } from 'react';\r\nimport { useProjectStore, AssetType, Asset } from '@/store/useProjectStore';\r\nimport { AssetCard } from '@/components/library/AssetCard';\r\nimport dynamic from 'next/dynamic';\r\n\r\nconst AssetDetailModal = dynamic(() => import('@/components/library/AssetDetailModal').then(mod => mod.AssetDetailModal), { ssr: false });\r\nconst ProjectManager = dynamic(() => import('@/components/library/ProjectManager').then(mod => mod.ProjectManager), { ssr: false });\r\nimport { Button } from '@/components/ui/Button';\r\nimport { usePathname } from 'next/navigation';\r\nimport { createClient } from '@/lib/supabase/client';\r\nimport toast from 'react-hot-toast';\r\n\r\nexport function LibraryPanel() {\r\n    const { currentProject, loadProjects, addAsset, deleteAsset } = useProjectStore();\r\n    const [searchQuery, setSearchQuery] = useState('');\r\n    const [filterType, setFilterType] = useState<AssetType | 'all'>('all');\r\n    const [selectedAsset, setSelectedAsset] = useState<Asset | null>(null);\r\n    const [isProjectManagerOpen, setIsProjectManagerOpen] = useState(false);\r\n    const pathname = usePathname();\r\n    const fileInputRef = useRef<HTMLInputElement>(null);\r\n    const supabase = createClient();\r\n\r\n    if (pathname === '/login') return null;\r\n\r\n    useEffect(() => {\r\n        loadProjects();\r\n    }, []);\r\n\r\n    const assets = currentProject?.assets || [];\r\n\r\n    const filteredAssets = assets.filter(asset => {\r\n        const matchesSearch = asset.title.toLowerCase().includes(searchQuery.toLowerCase());\r\n        const matchesFilter = filterType === 'all' || asset.type === filterType;\r\n        return matchesSearch && matchesFilter;\r\n    });\r\n\r\n    const handleUploadClick = () => {\r\n        fileInputRef.current?.click();\r\n    };\r\n\r\n    const handleFileChange = async (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const file = e.target.files?.[0];\r\n        if (!file || !currentProject) return;\r\n\r\n        const toastId = toast.loading('파일 업로드 중...');\r\n\r\n        try {\r\n            // 1. Upload to Supabase Storage\r\n            const fileExt = file.name.split('.').pop();\r\n            const fileName = `${Math.random()}.${fileExt}`;\r\n            const filePath = `${currentProject.id}/${fileName}`;\r\n\r\n            const { error: uploadError } = await supabase.storage\r\n                .from('assets')\r\n                .upload(filePath, file);\r\n\r\n            if (uploadError) throw uploadError;\r\n\r\n            const { data: { publicUrl } } = supabase.storage\r\n                .from('assets')\r\n                .getPublicUrl(filePath);\r\n\r\n            // 2. Determine Asset Type\r\n            let type: AssetType = 'image';\r\n            if (file.type.startsWith('audio')) type = 'audio';\r\n            else if (file.type.startsWith('video')) type = 'video';\r\n            else if (file.type.startsWith('text')) type = 'script';\r\n\r\n            // 3. Add to DB via Store\r\n            await addAsset({\r\n                type,\r\n                title: file.name,\r\n                url: publicUrl,\r\n                storagePath: filePath,\r\n                tag: 'Uploaded'\r\n            });\r\n\r\n            toast.success('업로드 완료!', { id: toastId });\r\n        } catch (error) {\r\n            console.error('Upload error:', error);\r\n            toast.error('업로드 실패', { id: toastId });\r\n        } finally {\r\n            if (fileInputRef.current) fileInputRef.current.value = '';\r\n        }\r\n    };\r\n\r\n    const handleDeleteAsset = async (id: string) => {\r\n        try {\r\n            await deleteAsset(id);\r\n            toast.success('에셋이 삭제되었습니다.');\r\n            setSelectedAsset(null);\r\n        } catch (error) {\r\n            console.error('Delete error:', error);\r\n            toast.error('삭제 실패');\r\n        }\r\n    };\r\n\r\n    return (\r\n        <aside className=\"w-[320px] bg-(--bg-sidebar) border-l border-[#2a2a35] flex flex-col h-full shrink-0\">\r\n            {/* Header */}\r\n            <div className=\"p-5 border-b border-[#2a2a35]\">\r\n                <div className=\"flex justify-between items-center mb-4\">\r\n                    <h3 className=\"text-[1.1rem] font-semibold text-white\">Library</h3>\r\n                    <div className=\"flex gap-2\">\r\n                        <button\r\n                            onClick={() => setIsProjectManagerOpen(true)}\r\n                            className=\"text-(--text-gray) hover:text-white transition-colors p-1 rounded hover:bg-white/5\"\r\n                            title=\"Manage Projects\"\r\n                        >\r\n                            <Settings className=\"w-4 h-4\" />\r\n                        </button>\r\n                        <input\r\n                            type=\"file\"\r\n                            ref={fileInputRef}\r\n                            onChange={handleFileChange}\r\n                            className=\"hidden\"\r\n                        />\r\n                        <Button size=\"icon\" variant=\"outline\" className=\"h-8 w-8\" onClick={handleUploadClick} title=\"Upload Asset\" disabled={!currentProject}>\r\n                            <Upload className=\"w-3.5 h-3.5\" />\r\n                        </Button>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Filter Dropdown */}\r\n                <div className=\"relative\">\r\n                    <select\r\n                        value={filterType}\r\n                        onChange={(e) => setFilterType(e.target.value as any)}\r\n                        className=\"w-full appearance-none bg-transparent border border-[#2a2a35] rounded-lg px-3 py-1.5 text-xs text-(--text-gray) outline-none focus:border-(--primary-color) focus:text-white cursor-pointer\"\r\n                    >\r\n                        <option value=\"all\" className=\"bg-[#15151e]\">All Assets</option>\r\n                        <option value=\"script\" className=\"bg-[#15151e]\">Scripts</option>\r\n                        <option value=\"audio\" className=\"bg-[#15151e]\">Audio</option>\r\n                        <option value=\"image\" className=\"bg-[#15151e]\">Images</option>\r\n                        <option value=\"video\" className=\"bg-[#15151e]\">Videos</option>\r\n                        <option value=\"sfx\" className=\"bg-[#15151e]\">SFX</option>\r\n                        <option value=\"bgm\" className=\"bg-[#15151e]\">BGM</option>\r\n                    </select>\r\n                    <ChevronDown className=\"absolute right-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-(--text-gray) pointer-events-none\" />\r\n                </div>\r\n            </div>\r\n\r\n            {/* Asset List */}\r\n            <div className=\"flex-1 overflow-y-auto p-4 custom-scrollbar\">\r\n                {!currentProject ? (\r\n                    <div className=\"flex flex-col items-center justify-center h-full text-(--text-gray) text-center gap-2\">\r\n                        <p className=\"text-sm\">프로젝트를 선택하거나 생성해주세요.</p>\r\n                        <Button variant=\"outline\" size=\"sm\" onClick={() => setIsProjectManagerOpen(true)}>\r\n                            프로젝트 관리\r\n                        </Button>\r\n                    </div>\r\n                ) : filteredAssets.length === 0 ? (\r\n                    <div className=\"flex flex-col items-center justify-center h-full text-(--text-gray) text-center\">\r\n                        <p className=\"text-sm\">에셋이 없습니다.</p>\r\n                        <p className=\"text-xs mt-1\">새 에셋을 업로드하거나 생성해보세요.</p>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"grid grid-cols-2 gap-3\">\r\n                        {filteredAssets.map((asset) => (\r\n                            <AssetCard\r\n                                key={asset.id}\r\n                                asset={asset}\r\n                                onClick={setSelectedAsset}\r\n                            />\r\n                        ))}\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            <ProjectManager\r\n                isOpen={isProjectManagerOpen}\r\n                onClose={() => setIsProjectManagerOpen(false)}\r\n            />\r\n\r\n            <AssetDetailModal\r\n                isOpen={!!selectedAsset}\r\n                onClose={() => setSelectedAsset(null)}\r\n                asset={selectedAsset}\r\n                onDelete={handleDeleteAsset}\r\n            />\r\n        </aside>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\components\\layout\\Sidebar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\components\\library\\AssetCard.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Play' is defined but never used.","line":2,"column":70,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":74},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'cn' is defined but never used.","line":3,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":12},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":60,"column":21,"nodeType":"JSXOpeningElement","endLine":64,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { FileText, Music, Image as ImageIcon, Video, Speaker, Radio, Play, Clock } from 'lucide-react';\r\nimport { cn } from '@/lib/utils';\r\nimport { Asset, AssetType } from '@/store/useProjectStore';\r\n\r\ninterface AssetCardProps {\r\n    asset: Asset;\r\n    onClick: (asset: Asset) => void;\r\n}\r\n\r\n\r\n\r\nexport const AssetCard = React.memo(function AssetCard({ asset, onClick }: AssetCardProps) {\r\n    const getIcon = (type: AssetType) => {\r\n        switch (type) {\r\n            case 'script': return <FileText className=\"w-3 h-3\" />;\r\n            case 'audio': return <Music className=\"w-3 h-3\" />;\r\n            case 'image': return <ImageIcon className=\"w-3 h-3\" />;\r\n            case 'video': return <Video className=\"w-3 h-3\" />;\r\n            case 'sfx': return <Speaker className=\"w-3 h-3\" />;\r\n            case 'bgm': return <Radio className=\"w-3 h-3\" />;\r\n            default: return <FileText className=\"w-3 h-3\" />;\r\n        }\r\n    };\r\n\r\n    const formatDuration = (seconds?: number) => {\r\n        if (!seconds) return '';\r\n        const m = Math.floor(seconds / 60);\r\n        const s = Math.floor(seconds % 60);\r\n        return `${m}:${s.toString().padStart(2, '0')}`;\r\n    };\r\n\r\n    return (\r\n        <div\r\n            onClick={() => onClick(asset)}\r\n            draggable={asset.type === 'image'} // 이미지만 드래그 가능\r\n            onDragStart={(e) => {\r\n                if (asset.type === 'image') {\r\n                    e.dataTransfer.setData('imageUrl', asset.url);\r\n                    if (asset.sceneNumber) {\r\n                        e.dataTransfer.setData('sceneId', asset.sceneNumber.toString());\r\n                    }\r\n                }\r\n            }}\r\n            className=\"group relative bg-[#262633] rounded-lg overflow-hidden border border-[#2a2a35] hover:border-[var(--primary-color)] transition-all cursor-pointer\"\r\n        >\r\n            {/* Thumbnail Area */}\r\n            <div className=\"aspect-square bg-[#323242] relative overflow-hidden\">\r\n                {asset.type === 'video' && !asset.thumbnail ? (\r\n                    <video\r\n                        src={asset.url}\r\n                        className=\"w-full h-full object-cover transition-transform group-hover:scale-105\"\r\n                        muted\r\n                        loop\r\n                        playsInline\r\n                        onMouseOver={e => e.currentTarget.play()}\r\n                        onMouseOut={e => e.currentTarget.pause()}\r\n                    />\r\n                ) : (asset.thumbnail || asset.type === 'image') ? (\r\n                    <img\r\n                        src={asset.thumbnail || asset.url}\r\n                        alt={asset.title}\r\n                        className=\"w-full h-full object-cover transition-transform group-hover:scale-105\"\r\n                    />\r\n                ) : (\r\n                    <div className=\"w-full h-full flex items-center justify-center text-[var(--text-gray)]\">\r\n                        {getIcon(asset.type)}\r\n                    </div>\r\n                )}\r\n\r\n                {/* Type Badge */}\r\n                <div className=\"absolute top-1.5 left-1.5 bg-black/60 backdrop-blur-sm px-1.5 py-0.5 rounded text-[10px] text-white flex items-center gap-1\">\r\n                    {getIcon(asset.type)}\r\n                    {asset.sceneNumber && <span>#{asset.sceneNumber}</span>}\r\n                </div>\r\n\r\n                {/* Duration Badge (Audio/Video) */}\r\n                {asset.duration && (\r\n                    <div className=\"absolute bottom-1.5 right-1.5 bg-black/60 backdrop-blur-sm px-1.5 py-0.5 rounded text-[10px] text-white flex items-center gap-1\">\r\n                        <Clock className=\"w-3 h-3\" />\r\n                        {formatDuration(asset.duration)}\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Info Area */}\r\n            <div className=\"p-2.5\">\r\n                <h4 className=\"text-xs font-medium text-white truncate mb-1\">{asset.title}</h4>\r\n                <div className=\"flex items-center justify-between text-[10px] text-[var(--text-gray)]\">\r\n                    <span className=\"truncate max-w-[60%]\">{asset.tag}</span>\r\n                    <span>{new Date(asset.createdAt).toLocaleDateString()}</span>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n});\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\components\\library\\AssetDetailModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ExternalLink' is defined but never used.","line":6,"column":38,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":50},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":64,"column":29,"nodeType":"JSXOpeningElement","endLine":64,"endColumn":119}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Dialog imports removed as we are using a custom implementation for now\r\n// Since I haven't created a generic Dialog component yet, I'll implement a simple modal here or use the one from SettingsModal pattern.\r\n// Actually, I should probably create a reusable Dialog component first if I want to be clean, but for speed, I'll adapt the pattern.\r\n\r\nimport * as React from 'react';\r\nimport { X, Trash2, Video, Download, ExternalLink, FileText } from 'lucide-react';\r\nimport { Asset } from '@/store/useProjectStore';\r\nimport { Button } from '@/components/ui/Button';\r\nimport { useRouter } from 'next/navigation';\r\n\r\ninterface AssetDetailModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    asset: Asset | null;\r\n    onDelete: (id: string) => void;\r\n}\r\n\r\nexport const AssetDetailModal = React.memo(function AssetDetailModal({ isOpen, onClose, asset, onDelete }: AssetDetailModalProps) {\r\n    const router = useRouter();\r\n\r\n    if (!isOpen || !asset) return null;\r\n\r\n    const handleGenerateVideo = () => {\r\n        router.push(`/video?sourceImage=${encodeURIComponent(asset.url)}`);\r\n        onClose();\r\n    };\r\n\r\n    const handleDownload = async () => {\r\n        try {\r\n            const response = await fetch(asset.url);\r\n            const blob = await response.blob();\r\n            const url = window.URL.createObjectURL(blob);\r\n            const link = document.createElement('a');\r\n            link.href = url;\r\n            // Extract filename from URL or use title\r\n            const extension = asset.type === 'image' ? 'png' : asset.type === 'video' ? 'mp4' : asset.type === 'audio' ? 'mp3' : 'txt';\r\n            link.download = `${asset.title || 'download'}.${extension}`;\r\n            document.body.appendChild(link);\r\n            link.click();\r\n            document.body.removeChild(link);\r\n            window.URL.revokeObjectURL(url);\r\n        } catch (error) {\r\n            console.error('Download failed:', error);\r\n            window.open(asset.url, '_blank'); // Fallback\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm\">\r\n            <div className=\"w-full max-w-2xl bg-[#18181b] border border-[#27272a] rounded-xl shadow-2xl overflow-hidden\">\r\n                {/* Header */}\r\n                <div className=\"flex items-center justify-between p-4 border-b border-[#27272a]\">\r\n                    <h3 className=\"text-lg font-semibold text-white\">{asset.title}</h3>\r\n                    <button onClick={onClose} className=\"text-gray-400 hover:text-white transition-colors\">\r\n                        <X className=\"w-5 h-5\" />\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Content */}\r\n                <div className=\"flex flex-col md:flex-row h-[500px]\">\r\n                    {/* Preview Section */}\r\n                    <div className=\"flex-1 bg-black flex items-center justify-center p-4 relative\">\r\n                        {asset.type === 'image' && (\r\n                            <img src={asset.url} alt={asset.title} className=\"max-w-full max-h-full object-contain\" />\r\n                        )}\r\n                        {asset.type === 'video' && (\r\n                            <video src={asset.url} controls className=\"max-w-full max-h-full\" />\r\n                        )}\r\n                        {(asset.type === 'audio' || asset.type === 'sfx' || asset.type === 'bgm') && (\r\n                            <div className=\"w-full max-w-md\">\r\n                                <div className=\"bg-[#27272a] p-6 rounded-lg flex flex-col items-center gap-4\">\r\n                                    <div className=\"w-16 h-16 bg-primary/20 rounded-full flex items-center justify-center text-primary\">\r\n                                        <Video className=\"w-8 h-8\" /> {/* Placeholder icon */}\r\n                                    </div>\r\n                                    <audio src={asset.url} controls className=\"w-full\" />\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n                        {asset.type === 'script' && (\r\n                            <div className=\"flex flex-col items-center gap-4 text-gray-400\">\r\n                                <FileText className=\"w-24 h-24\" />\r\n                                <p className=\"text-sm\">스크립트 파일 미리보기는 지원하지 않습니다.</p>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n\r\n                    {/* Info Section */}\r\n                    <div className=\"w-full md:w-80 border-l border-[#27272a] bg-[#18181b] p-6 flex flex-col overflow-y-auto\">\r\n                        <div className=\"space-y-6 flex-1\">\r\n                            <div>\r\n                                <label className=\"text-xs font-medium text-gray-500 uppercase tracking-wider\">Type</label>\r\n                                <p className=\"text-sm text-white mt-1 capitalize\">{asset.type}</p>\r\n                            </div>\r\n\r\n                            {asset.sceneNumber && (\r\n                                <div>\r\n                                    <label className=\"text-xs font-medium text-gray-500 uppercase tracking-wider\">Source Scene</label>\r\n                                    <p className=\"text-sm text-white mt-1\">Scene #{asset.sceneNumber}</p>\r\n                                </div>\r\n                            )}\r\n\r\n                            <div>\r\n                                <label className=\"text-xs font-medium text-gray-500 uppercase tracking-wider\">Created At</label>\r\n                                <p className=\"text-sm text-white mt-1\">{new Date(asset.createdAt).toLocaleString()}</p>\r\n                            </div>\r\n\r\n                            {asset.tag && (\r\n                                <div>\r\n                                    <label className=\"text-xs font-medium text-gray-500 uppercase tracking-wider\">Generation Tag</label>\r\n                                    <div className=\"mt-1\">\r\n                                        <span className=\"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-primary/10 text-primary ring-1 ring-inset ring-primary/20\">\r\n                                            {asset.tag}\r\n                                        </span>\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n\r\n                        {/* Actions */}\r\n                        <div className=\"mt-6 space-y-3 pt-6 border-t border-[#27272a]\">\r\n                            {asset.type === 'image' && (\r\n                                <Button className=\"w-full justify-center\" variant=\"primary\" onClick={handleGenerateVideo}>\r\n                                    <Video className=\"w-4 h-4 mr-2\" />\r\n                                    비디오로 생성\r\n                                </Button>\r\n                            )}\r\n\r\n                            <Button className=\"w-full justify-center\" variant=\"outline\" onClick={handleDownload}>\r\n                                <Download className=\"w-4 h-4 mr-2\" />\r\n                                다운로드\r\n                            </Button>\r\n\r\n                            <Button\r\n                                className=\"w-full justify-center text-red-400 hover:text-red-300 hover:bg-red-400/10 border-red-400/20\"\r\n                                variant=\"outline\"\r\n                                onClick={() => {\r\n                                    if (confirm('정말 삭제하시겠습니까?')) {\r\n                                        onDelete(asset.id);\r\n                                        onClose();\r\n                                    }\r\n                                }}\r\n                            >\r\n                                <Trash2 className=\"w-4 h-4 mr-2\" />\r\n                                삭제\r\n                            </Button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n});\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\components\\library\\ProjectManager.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Check' is defined but never used.","line":2,"column":53,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":58},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Date.now` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Users\\user\\Desktop\\studioAI\\src\\components\\library\\ProjectManager.tsx:110:95\n  108 |                                             </div>\n  109 |                                             <p className=\"text-xs text-gray-400\">\n> 110 |                                                 Last modified: {new Date(project.updatedAt || Date.now()).toLocaleDateString()}\n      |                                                                                               ^^^^^^^^^^ Cannot call impure function\n  111 |                                             </p>\n  112 |                                         </div>\n  113 |","line":110,"column":95,"nodeType":null,"endLine":110,"endColumn":105}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\r\nimport { X, FolderPlus, FolderOpen, Search, Trash2, Check } from 'lucide-react';\r\nimport { Button } from '@/components/ui/Button';\r\nimport { Input } from '@/components/ui/Input';\r\nimport { useProjectStore } from '@/store/useProjectStore'; // Assuming this store exists\r\n\r\ninterface ProjectManagerProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n}\r\n\r\nexport function ProjectManager({ isOpen, onClose }: ProjectManagerProps) {\r\n    const { projects, currentProject, loadProject, createProject, deleteProject } = useProjectStore();\r\n    const [activeTab, setActiveTab] = useState<'open' | 'new'>('open');\r\n    const [searchQuery, setSearchQuery] = useState('');\r\n    const [newProjectTitle, setNewProjectTitle] = useState('');\r\n\r\n    if (!isOpen) return null;\r\n\r\n    const filteredProjects = projects.filter(p =>\r\n        p.title.toLowerCase().includes(searchQuery.toLowerCase())\r\n    );\r\n\r\n    const handleCreate = async () => {\r\n        if (!newProjectTitle.trim()) return;\r\n        await createProject({\r\n            title: newProjectTitle,\r\n            description: '',\r\n            type: 'script', // Default type\r\n        });\r\n        setNewProjectTitle('');\r\n        setActiveTab('open');\r\n    };\r\n\r\n    const handleOpen = (projectId: string) => {\r\n        loadProject(projectId);\r\n        onClose();\r\n    };\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm\">\r\n            <div className=\"w-full max-w-3xl bg-[#18181b] border border-[#27272a] rounded-xl shadow-2xl overflow-hidden flex flex-col h-[600px]\">\r\n                {/* Header */}\r\n                <div className=\"flex items-center justify-between p-6 border-b border-[#27272a]\">\r\n                    <h2 className=\"text-xl font-bold text-white\">Project Manager</h2>\r\n                    <button onClick={onClose} className=\"text-gray-400 hover:text-white transition-colors\">\r\n                        <X className=\"w-6 h-6\" />\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Tabs */}\r\n                <div className=\"flex border-b border-[#27272a]\">\r\n                    <button\r\n                        onClick={() => setActiveTab('open')}\r\n                        className={`flex-1 py-4 text-sm font-medium transition-colors border-b-2 ${activeTab === 'open'\r\n                                ? 'border-primary text-primary bg-primary/5'\r\n                                : 'border-transparent text-gray-400 hover:text-white hover:bg-white/5'\r\n                            }`}\r\n                    >\r\n                        <div className=\"flex items-center justify-center gap-2\">\r\n                            <FolderOpen className=\"w-4 h-4\" />\r\n                            Open Existing Project\r\n                        </div>\r\n                    </button>\r\n                    <button\r\n                        onClick={() => setActiveTab('new')}\r\n                        className={`flex-1 py-4 text-sm font-medium transition-colors border-b-2 ${activeTab === 'new'\r\n                                ? 'border-primary text-primary bg-primary/5'\r\n                                : 'border-transparent text-gray-400 hover:text-white hover:bg-white/5'\r\n                            }`}\r\n                    >\r\n                        <div className=\"flex items-center justify-center gap-2\">\r\n                            <FolderPlus className=\"w-4 h-4\" />\r\n                            Create New Project\r\n                        </div>\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Content */}\r\n                <div className=\"flex-1 overflow-hidden p-6\">\r\n                    {activeTab === 'open' ? (\r\n                        <div className=\"flex flex-col h-full\">\r\n                            <div className=\"relative mb-4\">\r\n                                <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500\" />\r\n                                <Input\r\n                                    placeholder=\"Search projects...\"\r\n                                    className=\"pl-9\"\r\n                                    value={searchQuery}\r\n                                    onChange={(e) => setSearchQuery(e.target.value)}\r\n                                />\r\n                            </div>\r\n\r\n                            <div className=\"flex-1 overflow-y-auto space-y-2 pr-2 custom-scrollbar\">\r\n                                {filteredProjects.map(project => (\r\n                                    <div\r\n                                        key={project.id}\r\n                                        className={`flex items-center justify-between p-4 rounded-lg border transition-all ${currentProject?.id === project.id\r\n                                                ? 'bg-primary/10 border-primary/50'\r\n                                                : 'bg-[#27272a] border-transparent hover:border-gray-600'\r\n                                            }`}\r\n                                    >\r\n                                        <div className=\"flex-1 min-w-0 mr-4\">\r\n                                            <div className=\"flex items-center gap-2 mb-1\">\r\n                                                <h4 className=\"font-medium text-white truncate\">{project.title}</h4>\r\n                                                {currentProject?.id === project.id && (\r\n                                                    <span className=\"text-[10px] bg-primary text-white px-1.5 py-0.5 rounded-full\">Active</span>\r\n                                                )}\r\n                                            </div>\r\n                                            <p className=\"text-xs text-gray-400\">\r\n                                                Last modified: {new Date(project.updatedAt || Date.now()).toLocaleDateString()}\r\n                                            </p>\r\n                                        </div>\r\n\r\n                                        <div className=\"flex items-center gap-2\">\r\n                                            <Button\r\n                                                size=\"sm\"\r\n                                                variant={currentProject?.id === project.id ? \"secondary\" : \"primary\"}\r\n                                                onClick={() => handleOpen(project.id)}\r\n                                            >\r\n                                                {currentProject?.id === project.id ? 'Current' : 'Open'}\r\n                                            </Button>\r\n                                            <Button\r\n                                                size=\"icon\"\r\n                                                variant=\"ghost\"\r\n                                                className=\"text-gray-400 hover:text-red-400\"\r\n                                                onClick={() => {\r\n                                                    if (confirm('Delete this project?')) deleteProject(project.id);\r\n                                                }}\r\n                                            >\r\n                                                <Trash2 className=\"w-4 h-4\" />\r\n                                            </Button>\r\n                                        </div>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"flex flex-col h-full max-w-md mx-auto justify-center\">\r\n                            <div className=\"text-center mb-8\">\r\n                                <div className=\"w-16 h-16 bg-primary/20 rounded-full flex items-center justify-center mx-auto mb-4 text-primary\">\r\n                                    <FolderPlus className=\"w-8 h-8\" />\r\n                                </div>\r\n                                <h3 className=\"text-xl font-bold text-white mb-2\">Start a New Project</h3>\r\n                                <p className=\"text-gray-400 text-sm\">Create a new workspace for your creative assets.</p>\r\n                            </div>\r\n\r\n                            <div className=\"space-y-4\">\r\n                                <div className=\"space-y-2\">\r\n                                    <label className=\"text-sm font-medium text-gray-300\">Project Name</label>\r\n                                    <Input\r\n                                        placeholder=\"e.g., My Awesome Video\"\r\n                                        value={newProjectTitle}\r\n                                        onChange={(e) => setNewProjectTitle(e.target.value)}\r\n                                        autoFocus\r\n                                    />\r\n                                </div>\r\n\r\n                                <Button\r\n                                    className=\"w-full h-12 text-lg\"\r\n                                    onClick={handleCreate}\r\n                                    disabled={!newProjectTitle.trim()}\r\n                                >\r\n                                    Create Project\r\n                                </Button>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\components\\script\\ScriptResultModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\components\\settings\\SettingsModal.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\user\\Desktop\\studioAI\\src\\components\\settings\\SettingsModal.tsx:32:13\n  30 |     useEffect(() => {\n  31 |         if (isOpen) {\n> 32 |             setLocalOpenAi(openaiKey);\n     |             ^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  33 |             setLocalFal(falKey);\n  34 |             setLocalGoogle(googleCredentials);\n  35 |             setLocalKie(kieKey);","line":32,"column":13,"nodeType":null,"endLine":32,"endColumn":27},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'err' is defined but never used.","line":131,"column":58,"nodeType":null,"messageId":"unusedVar","endLine":131,"endColumn":61}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { X, Key, Save } from 'lucide-react';\r\nimport { useSettingsStore } from '@/store/useSettingsStore';\r\nimport toast from 'react-hot-toast';\r\n\r\ninterface SettingsModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n}\r\n\r\nexport default function SettingsModal({ isOpen, onClose }: SettingsModalProps) {\r\n    const {\r\n        openaiKey,\r\n        falKey,\r\n        googleCredentials,\r\n        kieKey,\r\n        setOpenAiKey,\r\n        setFalKey,\r\n        setGoogleCredentials,\r\n        setKieKey,\r\n    } = useSettingsStore();\r\n\r\n    const [localOpenAi, setLocalOpenAi] = useState('');\r\n    const [localFal, setLocalFal] = useState('');\r\n    const [localGoogle, setLocalGoogle] = useState('');\r\n    const [localKie, setLocalKie] = useState('');\r\n\r\n    useEffect(() => {\r\n        if (isOpen) {\r\n            setLocalOpenAi(openaiKey);\r\n            setLocalFal(falKey);\r\n            setLocalGoogle(googleCredentials);\r\n            setLocalKie(kieKey);\r\n        }\r\n    }, [isOpen, openaiKey, falKey, googleCredentials, kieKey]);\r\n\r\n    const handleSave = () => {\r\n        setOpenAiKey(localOpenAi);\r\n        setFalKey(localFal);\r\n        setGoogleCredentials(localGoogle);\r\n        setKieKey(localKie);\r\n        toast.success('API 키가 저장되었습니다!');\r\n        onClose();\r\n    };\r\n\r\n    if (!isOpen) return null;\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\r\n            <div className=\"bg-[#1a1a1a] rounded-xl border border-white/10 w-full max-w-2xl max-h-[90vh] overflow-y-auto\">\r\n                {/* Header */}\r\n                <div className=\"sticky top-0 bg-[#1a1a1a] border-b border-white/10 p-6 flex items-center justify-between\">\r\n                    <div className=\"flex items-center gap-3\">\r\n                        <Key className=\"w-6 h-6 text-blue-400\" />\r\n                        <h2 className=\"text-xl font-semibold text-white\">API 키 설정</h2>\r\n                    </div>\r\n                    <button\r\n                        onClick={onClose}\r\n                        className=\"p-2 hover:bg-white/5 rounded-lg transition-colors\"\r\n                    >\r\n                        <X className=\"w-5 h-5 text-white/60\" />\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Content */}\r\n                <div className=\"p-6 space-y-6\">\r\n                    <div className=\"bg-blue-500/10 border border-blue-500/20 rounded-lg p-4\">\r\n                        <p className=\"text-sm text-blue-300\">\r\n                            💡 <strong>중요:</strong> 이 서비스는 사용자의 API 키를 사용합니다.\r\n                            아래 키들을 입력하면 브라우저에 안전하게 저장되며, 이후 매번 입력할 필요가 없습니다.\r\n                        </p>\r\n                    </div>\r\n\r\n                    {/* OpenAI Key */}\r\n                    <div className=\"space-y-2\">\r\n                        <label className=\"block text-sm font-medium text-white/80\">\r\n                            OpenAI API Key\r\n                        </label>\r\n                        <input\r\n                            type=\"password\"\r\n                            value={localOpenAi}\r\n                            onChange={(e) => setLocalOpenAi(e.target.value)}\r\n                            placeholder=\"sk-...\"\r\n                            className=\"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder:text-white/30 focus:outline-none focus:border-blue-500/50\"\r\n                        />\r\n                        <p className=\"text-xs text-white/40\">\r\n                            스크립트 생성에 사용됩니다. <a href=\"https://platform.openai.com/api-keys\" target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-blue-400 hover:underline\">키 발급받기</a>\r\n                        </p>\r\n                    </div>\r\n\r\n                    {/* FAL Key */}\r\n                    <div className=\"space-y-2\">\r\n                        <label className=\"block text-sm font-medium text-white/80\">\r\n                            FAL.ai API Key\r\n                        </label>\r\n                        <input\r\n                            type=\"password\"\r\n                            value={localFal}\r\n                            onChange={(e) => setLocalFal(e.target.value)}\r\n                            placeholder=\"...\"\r\n                            className=\"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder:text-white/30 focus:outline-none focus:border-blue-500/50\"\r\n                        />\r\n                        <p className=\"text-xs text-white/40\">\r\n                            이미지 생성에 사용됩니다. <a href=\"https://fal.ai/dashboard/keys\" target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-blue-400 hover:underline\">키 발급받기</a>\r\n                        </p>\r\n                    </div>\r\n\r\n                    {/* Google Credentials */}\r\n                    <div className=\"space-y-2\">\r\n                        <label className=\"block text-sm font-medium text-white/80\">\r\n                            Google Cloud Credentials (JSON)\r\n                        </label>\r\n                        <div className=\"flex flex-col gap-2\">\r\n                            <div className=\"relative\">\r\n                                <input\r\n                                    type=\"file\"\r\n                                    accept=\".json\"\r\n                                    onChange={(e) => {\r\n                                        const file = e.target.files?.[0];\r\n                                        if (file) {\r\n                                            const reader = new FileReader();\r\n                                            reader.onload = (event) => {\r\n                                                const content = event.target?.result as string;\r\n                                                try {\r\n                                                    // Validate JSON immediately\r\n                                                    JSON.parse(content);\r\n                                                    setLocalGoogle(content);\r\n                                                    toast.success('Google Credentials 파일이 로드되었습니다.');\r\n                                                } catch (err) {\r\n                                                    toast.error('올바르지 않은 JSON 파일입니다.');\r\n                                                }\r\n                                            };\r\n                                            reader.readAsText(file);\r\n                                        }\r\n                                    }}\r\n                                    className=\"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-600 file:text-white hover:file:bg-blue-700 cursor-pointer\"\r\n                                />\r\n                            </div>\r\n\r\n                            {/* Hidden textarea for manual edit if needed, or just status display */}\r\n                            {localGoogle && (\r\n                                <div className=\"p-3 bg-green-500/10 border border-green-500/20 rounded-lg flex items-center gap-2\">\r\n                                    <div className=\"w-2 h-2 rounded-full bg-green-500 animate-pulse\" />\r\n                                    <span className=\"text-xs text-green-400 font-medium\">\r\n                                        인증 키가 로드되었습니다 ({localGoogle.length} bytes)\r\n                                    </span>\r\n                                    <button\r\n                                        onClick={() => setLocalGoogle('')}\r\n                                        className=\"ml-auto text-xs text-white/40 hover:text-white\"\r\n                                    >\r\n                                        삭제\r\n                                    </button>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                        <p className=\"text-xs text-white/40\">\r\n                            다운로드 받은 JSON 키 파일을 직접 업로드하세요. (내용이 자동으로 저장됩니다)\r\n                        </p>\r\n                    </div>\r\n\r\n                    {/* KIE Key */}\r\n                    <div className=\"space-y-2\">\r\n                        <label className=\"block text-sm font-medium text-white/80\">\r\n                            KIE.ai API Key\r\n                        </label>\r\n                        <input\r\n                            type=\"password\"\r\n                            value={localKie}\r\n                            onChange={(e) => setLocalKie(e.target.value)}\r\n                            placeholder=\"...\"\r\n                            className=\"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder:text-white/30 focus:outline-none focus:border-blue-500/50\"\r\n                        />\r\n                        <p className=\"text-xs text-white/40\">\r\n                            비디오 생성에 사용됩니다.\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Footer */}\r\n                <div className=\"sticky bottom-0 bg-[#1a1a1a] border-t border-white/10 p-6 flex justify-end gap-3\">\r\n                    <button\r\n                        onClick={onClose}\r\n                        className=\"px-6 py-2.5 bg-white/5 hover:bg-white/10 text-white rounded-lg transition-colors\"\r\n                    >\r\n                        취소\r\n                    </button>\r\n                    <button\r\n                        onClick={handleSave}\r\n                        className=\"px-6 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors flex items-center gap-2\"\r\n                    >\r\n                        <Save className=\"w-4 h-4\" />\r\n                        저장\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\components\\ui\\Button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\components\\ui\\Card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\components\\ui\\Input.tsx","messages":[{"ruleId":"@typescript-eslint/no-empty-object-type","severity":2,"message":"An interface declaring no members is equivalent to its supertype.","line":9,"column":18,"nodeType":"Identifier","messageId":"noEmptyInterfaceWithSuper","endLine":9,"endColumn":28,"suggestions":[{"messageId":"replaceEmptyInterfaceWithSuper","fix":{"range":[208,289],"text":"type InputProps = React.InputHTMLAttributes<HTMLInputElement>"},"desc":"Replace empty interface with a type alias."}]},{"ruleId":"@typescript-eslint/no-empty-object-type","severity":2,"message":"An interface declaring no members is equivalent to its supertype.","line":29,"column":18,"nodeType":"Identifier","messageId":"noEmptyInterfaceWithSuper","endLine":29,"endColumn":31,"suggestions":[{"messageId":"replaceEmptyInterfaceWithSuper","fix":{"range":[1070,1160],"text":"type TextareaProps = React.TextareaHTMLAttributes<HTMLTextAreaElement>"},"desc":"Replace empty interface with a type alias."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\r\nimport { clsx, type ClassValue } from \"clsx\"\r\nimport { twMerge } from \"tailwind-merge\"\r\n\r\nfunction cn(...inputs: ClassValue[]) {\r\n    return twMerge(clsx(inputs))\r\n}\r\n\r\nexport interface InputProps\r\n    extends React.InputHTMLAttributes<HTMLInputElement> { }\r\n\r\nconst Input = React.forwardRef<HTMLInputElement, InputProps>(\r\n    ({ className, type, ...props }, ref) => {\r\n        return (\r\n            <input\r\n                type={type}\r\n                className={cn(\r\n                    \"flex h-10 w-full rounded-lg border border-border bg-input px-3 py-2 text-sm text-white ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-0 disabled:cursor-not-allowed disabled:opacity-50 transition-all\",\r\n                    className\r\n                )}\r\n                ref={ref}\r\n                {...props}\r\n            />\r\n        )\r\n    }\r\n)\r\nInput.displayName = \"Input\"\r\n\r\nexport interface TextareaProps\r\n    extends React.TextareaHTMLAttributes<HTMLTextAreaElement> { }\r\n\r\nconst Textarea = React.forwardRef<HTMLTextAreaElement, TextareaProps>(\r\n    ({ className, ...props }, ref) => {\r\n        return (\r\n            <textarea\r\n                className={cn(\r\n                    \"flex min-h-[80px] w-full rounded-lg border border-border bg-input px-3 py-2 text-sm text-white ring-offset-background placeholder:text-muted focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-0 disabled:cursor-not-allowed disabled:opacity-50 transition-all resize-none\",\r\n                    className\r\n                )}\r\n                ref={ref}\r\n                {...props}\r\n            />\r\n        )\r\n    }\r\n)\r\nTextarea.displayName = \"Textarea\"\r\n\r\nexport { Input, Textarea }\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\components\\ui\\Modal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\components\\ui\\Tabs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\components\\video\\VideoResultModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\components\\video\\VideoSettings.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\hooks\\useTaskPolling.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\lib\\supabase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\lib\\supabase\\client.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\lib\\supabase\\server.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CookieOptions' is defined but never used.","line":1,"column":35,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":48}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createServerClient, type CookieOptions } from '@supabase/ssr';\r\nimport { cookies } from 'next/headers';\r\n\r\nexport const createClient = (cookieStore: Awaited<ReturnType<typeof cookies>>) => {\r\n    return createServerClient(\r\n        process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n        process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\r\n        {\r\n            cookies: {\r\n                getAll() {\r\n                    return cookieStore.getAll();\r\n                },\r\n                setAll(cookiesToSet) {\r\n                    try {\r\n                        cookiesToSet.forEach(({ name, value, options }) =>\r\n                            cookieStore.set(name, value, options)\r\n                        );\r\n                    } catch {\r\n                        // The `setAll` method was called from a Server Component.\r\n                        // This can be ignored if you have middleware refreshing\r\n                        // user sessions.\r\n                    }\r\n                },\r\n            },\r\n        }\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\lib\\supabase\\storage.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'data' is assigned a value but never used.","line":34,"column":17,"nodeType":null,"messageId":"unusedVar","endLine":34,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createClient } from '@/lib/supabase/server';\r\nimport { cookies } from 'next/headers';\r\nimport { v4 as uuidv4 } from 'uuid';\r\n\r\nexport async function uploadAssetFromUrl(\r\n    url: string,\r\n    folder: 'images' | 'videos' | 'audio'\r\n): Promise<string> {\r\n    try {\r\n        // 1. Download the file from the external URL\r\n        const response = await fetch(url);\r\n        if (!response.ok) throw new Error(`Failed to fetch asset: ${response.statusText}`);\r\n\r\n        const arrayBuffer = await response.arrayBuffer();\r\n        const buffer = Buffer.from(arrayBuffer);\r\n\r\n        // 2. Determine content type and extension\r\n        const contentType = response.headers.get('content-type') || 'application/octet-stream';\r\n        const extension = contentType.split('/')[1] || 'bin';\r\n        const filename = `${uuidv4()}.${extension}`;\r\n\r\n        // 3. Initialize Supabase Client\r\n        const cookieStore = await cookies();\r\n        const supabase = createClient(cookieStore);\r\n\r\n        // 4. Get current user\r\n        const { data: { user } } = await supabase.auth.getUser();\r\n        if (!user) throw new Error('User not authenticated');\r\n\r\n        // 5. Upload to Supabase Storage\r\n        // Path: userId/folder/filename\r\n        const path = `${user.id}/${folder}/${filename}`;\r\n\r\n        const { data, error } = await supabase\r\n            .storage\r\n            .from('assets')\r\n            .upload(path, buffer, {\r\n                contentType,\r\n                upsert: false\r\n            });\r\n\r\n        if (error) throw error;\r\n\r\n        // 6. Get Public URL\r\n        const { data: { publicUrl } } = supabase\r\n            .storage\r\n            .from('assets')\r\n            .getPublicUrl(path);\r\n\r\n        return publicUrl;\r\n\r\n    } catch (error) {\r\n        console.error('Asset upload failed:', error);\r\n        // Fallback: return the original URL if upload fails, \r\n        // so the app doesn't break immediately (though it won't be permanent)\r\n        return url;\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\lib\\tts-voices.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\lib\\utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\middleware.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CookieOptions' is defined but never used.","line":1,"column":35,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":48},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'options' is defined but never used.","line":20,"column":58,"nodeType":null,"messageId":"unusedVar","endLine":20,"endColumn":65}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createServerClient, type CookieOptions } from '@supabase/ssr';\r\nimport { NextResponse, type NextRequest } from 'next/server';\r\n\r\nexport async function middleware(request: NextRequest) {\r\n    let response = NextResponse.next({\r\n        request: {\r\n            headers: request.headers,\r\n        },\r\n    });\r\n\r\n    const supabase = createServerClient(\r\n        process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n        process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\r\n        {\r\n            cookies: {\r\n                getAll() {\r\n                    return request.cookies.getAll();\r\n                },\r\n                setAll(cookiesToSet) {\r\n                    cookiesToSet.forEach(({ name, value, options }) =>\r\n                        request.cookies.set(name, value)\r\n                    );\r\n                    response = NextResponse.next({\r\n                        request: {\r\n                            headers: request.headers,\r\n                        },\r\n                    });\r\n                    cookiesToSet.forEach(({ name, value, options }) =>\r\n                        response.cookies.set(name, value, options)\r\n                    );\r\n                },\r\n            },\r\n        }\r\n    );\r\n\r\n    const {\r\n        data: { user },\r\n    } = await supabase.auth.getUser();\r\n\r\n    // If user is not signed in and the current path is not /login, redirect the user to /login\r\n    if (!user && !request.nextUrl.pathname.startsWith('/login') && !request.nextUrl.pathname.startsWith('/auth')) {\r\n        return NextResponse.redirect(new URL('/login', request.url));\r\n    }\r\n\r\n    // If user is signed in and the current path is /login, redirect the user to /library\r\n    if (user && request.nextUrl.pathname.startsWith('/login')) {\r\n        return NextResponse.redirect(new URL('/library', request.url));\r\n    }\r\n\r\n    return response;\r\n}\r\n\r\nexport const config = {\r\n    matcher: [\r\n        /*\r\n         * Match all request paths except for the ones starting with:\r\n         * - _next/static (static files)\r\n         * - _next/image (image optimization files)\r\n         * - favicon.ico (favicon file)\r\n         * - api (API routes)\r\n         * Feel free to modify this pattern to include more paths.\r\n         */\r\n        '/((?!_next/static|_next/image|favicon.ico|api).*)',\r\n    ],\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\store\\useProjectStore.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\store\\useSettingsStore.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\user\\Desktop\\studioAI\\src\\store\\useTimelineStore.ts","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":301,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":301,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10586,10589],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10586,10589],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":323,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":323,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11519,11522],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11519,11522],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":334,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":334,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12050,12053],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12050,12053],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":345,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":345,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12566,12569],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12566,12569],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":348,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":348,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12772,12775],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12772,12775],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":360,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":360,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13357,13360],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13357,13360],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]